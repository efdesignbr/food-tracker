(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[790,398],{77372:function(e,t,o){Promise.resolve().then(o.bind(o,97581))},97581:function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return u}});var n=o(57437),i=o(2265),r=o(86394),a=o(95682),d=o(46285),s=o(45591),l=o(45224);function c(){try{let e=new Intl.DateTimeFormat("sv-SE",{timeZone:"America/Sao_Paulo",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!1}).formatToParts(new Date),t=t=>{var o;return(null===(o=e.find(e=>e.type===t))||void 0===o?void 0:o.value)||""};return"".concat(t("year"),"-").concat(t("month"),"-").concat(t("day"),"T").concat(t("hour"),":").concat(t("minute"))}catch(o){let e=new Date,t=e=>String(e).padStart(2,"0");return"".concat(e.getFullYear(),"-").concat(t(e.getMonth()+1),"-").concat(t(e.getDate()),"T").concat(t(e.getHours()),":").concat(t(e.getMinutes()))}}function u(){var e,t;let{plan:o,quota:u,isLoading:p}=(0,r.R)(),{hasQuota:g}=(0,a.f)(o,u),[h,f]=(0,i.useState)(!1),[b,m]=(0,i.useState)(null),[x,y]=(0,i.useState)(null),[v,j]=(0,i.useState)(!1),[w,S]=(0,i.useState)(""),[_,k]=(0,i.useState)(null),[R,z]=(0,i.useState)(()=>c()),[C,B]=(0,i.useState)(""),[A,E]=(0,i.useState)(null),[I,W]=(0,i.useState)(!1),[N,M]=(0,i.useState)("home"),[P,T]=(0,i.useState)(""),[D,O]=(0,i.useState)([]),[F,q]=(0,i.useState)(!1),[L,U]=(0,i.useState)(null),[V,J]=(0,i.useState)([]),[H,Q]=(0,i.useState)(!1),[X,Y]=(0,i.useState)(!1),[G,K]=(0,i.useState)(""),[Z,$]=(0,i.useState)([]),[ee,et]=(0,i.useState)(!1),[eo,en]=(0,i.useState)("");async function ei(e){return new Promise((t,o)=>{let n=new FileReader;n.readAsDataURL(e),n.onload=n=>{var i;let r=new Image;r.src=null===(i=n.target)||void 0===i?void 0:i.result,r.onload=()=>{let n=document.createElement("canvas"),i=r.width,a=r.height;i>a&&i>1024?(a=1024*a/i,i=1024):a>1024&&(i=1024*i/a,a=1024),n.width=i,n.height=a;let d=n.getContext("2d");null==d||d.drawImage(r,0,0,i,a);let s=.8,l=()=>{n.toBlob(n=>{if(!n){o(Error("Erro ao comprimir imagem"));return}n.size<512e3||s<.3?t(new File([n],e.name,{type:"image/jpeg",lastModified:Date.now()})):(s-=.1,l())},"image/jpeg",s)};l()},r.onerror=()=>o(Error("Erro ao carregar imagem"))},n.onerror=()=>o(Error("Erro ao ler arquivo"))})}async function er(e){var t;let o=null===(t=e.target.files)||void 0===t?void 0:t[0];if(o){j(!0),E(null);try{let e=await ei(o);m(e),y(URL.createObjectURL(e))}catch(e){E("Erro ao processar imagem. Tente outra foto.")}finally{j(!1)}}}async function ea(e){if(e.trim().length<2){$([]);return}try{et(!0);let t=await s.h.get("/api/food-bank?q=".concat(encodeURIComponent(e))),o=await t.json();t.ok&&$(o.items||[])}catch(e){console.error("Erro ao buscar alimentos:",e)}finally{et(!1)}}async function ed(e){var t,o,n,i,r,a,d;let l=prompt('Quantas unidades de "'.concat(e.name,'"?'),"1");if(!l)return;let c=Number(l);if(isNaN(c)||c<=0){alert("Quantidade inv\xe1lida! Digite um n\xfamero maior que zero.");return}try{await s.h.post("/api/food-bank/increment-usage",{id:e.id})}catch(e){console.error("Erro ao incrementar uso:",e)}let u=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=Math.pow(10,t);return Math.round(e*o)/o};J([...V,{name:e.name,quantity:c,unit:e.serving_size||"por\xe7\xe3o",calories:Math.round((null!==(t=e.calories)&&void 0!==t?t:0)*c),protein_g:u((null!==(o=e.protein)&&void 0!==o?o:0)*c),carbs_g:u((null!==(n=e.carbs)&&void 0!==n?n:0)*c),fat_g:u((null!==(i=e.fat)&&void 0!==i?i:0)*c),fiber_g:u((null!==(r=e.fiber)&&void 0!==r?r:0)*c),sodium_mg:Math.round((null!==(a=e.sodium)&&void 0!==a?a:0)*c),sugar_g:u((null!==(d=e.sugar)&&void 0!==d?d:0)*c),source:"bank"}]),K(""),$([]),Q(!1)}function es(){if(!eo.trim()){alert("Digite o nome do alimento!");return}J([...V,{name:eo.trim(),quantity:1,unit:"por\xe7\xe3o",source:"new"}]),en(""),Y(!1)}async function el(){if(!b){E("Selecione uma foto para analisar!");return}j(!0),E(null);try{let e=new FormData;e.append("image",b),e.append("context",JSON.stringify({location_type:N,restaurant_name:"out"===N?null==L?void 0:L.name:void 0}));let t=await (0,l.q)(t=>(0,s.x)("/api/meals/analyze-image",{method:"POST",body:e,headers:t}),{feature:"photo_analysis"}),o=await t.json();if(!t.ok){if(403===t.status){f(!0);return}throw Error(o.error||"Erro ao analisar foto")}k(o.result)}catch(e){E(e instanceof Error?e.message:"Erro ao analisar foto")}finally{j(!1)}}async function ec(){if(0===V.length){E("Adicione pelo menos um alimento para analisar!");return}j(!0),E(null);try{let e;let t={foods:V.map(e=>({name:e.name,quantity:e.quantity,unit:e.unit,calories:e.calories,protein_g:e.protein_g,carbs_g:e.carbs_g,fat_g:e.fat_g,fiber_g:e.fiber_g,sodium_mg:e.sodium_mg,sugar_g:e.sugar_g})),location_type:N,restaurant_name:"out"===N?null==L?void 0:L.name:void 0};if(b){let o=new FormData;o.append("image",b),o.append("data",JSON.stringify(t)),e=await (0,l.q)(e=>(0,s.x)("/api/meals/analyze-meal",{method:"POST",body:o,headers:e}),{feature:"photo_analysis"})}else e=await (0,l.q)(e=>(0,s.x)("/api/meals/analyze-meal",{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json",...e||{}}}),{feature:"text_analysis"});let o=await e.json();if(!e.ok)throw Error(o.error||"Erro ao analisar");k(o.result)}catch(e){E(e.message)}finally{j(!1)}}async function eu(){if(_){if(!w){E("Por favor, selecione o tipo de refei\xe7\xe3o");return}j(!0),E(null),W(!1);try{let e;let t={meal_type:w,consumed_at:R+":00-03:00",notes:C||_.notes||"",foods:(_.foods||[]).map(e=>({name:e.name,quantity:Number(e.quantity)||1,unit:e.unit||"un",calories:e.calories,protein_g:e.protein_g,carbs_g:e.carbs_g,fat_g:e.fat_g,fiber_g:e.fiber_g,sodium_mg:e.sodium_mg,sugar_g:e.sugar_g}))};if(t.location_type=N,"out"===N){if(!(null==L?void 0:L.id))throw Error("Selecione um restaurante para refei\xe7\xf5es fora de casa");t.restaurant_id=L.id}else t.restaurant_id=null;if(b){let o=new FormData;o.append("image",b),o.append("payload",JSON.stringify(t)),e=await (0,s.x)("/api/meals/approve",{method:"POST",body:o})}else e=await s.h.post("/api/meals/approve",t);let o=await e.json();if(!e.ok)throw Error(o.error||"Erro ao salvar");W(!0),m(null),y(null),J([]),k(null),B(""),z(c()),M("home"),U(null),T(""),O([])}catch(e){E(e.message)}finally{j(!1)}}}let ep=(null==_?void 0:null===(e=_.foods)||void 0===e?void 0:e.reduce((e,t)=>e+(t.calories||0),0))||0;return(0,n.jsxs)("div",{style:{maxWidth:800,margin:"0 auto",padding:24},children:[(0,n.jsx)("h1",{style:{fontSize:28,fontWeight:700,marginBottom:24},children:"Capturar Refei\xe7\xe3o"}),(0,n.jsx)(d.x5,{isOpen:h,onClose:()=>f(!1),feature:"photo_analysis",currentPlan:o}),g&&u&&(0,n.jsx)(d.Lw,{quotaType:"photo",used:u.photo_analyses.used,limit:u.photo_analyses.limit,percentage:u.photo_analyses.percentage,remaining:u.photo_analyses.remaining,resetDate:u.resetDate}),(0,n.jsx)("div",{style:{border:"2px dashed #d1d5db",borderRadius:16,padding:24,textAlign:"center",background:"#f9fafb",marginBottom:24,position:"relative"},children:x?(0,n.jsxs)("div",{children:[(0,n.jsx)("img",{src:x,alt:"Preview",style:{maxWidth:"100%",maxHeight:200,borderRadius:12,marginBottom:12}}),(0,n.jsxs)("div",{style:{display:"flex",gap:8,justifyContent:"center",flexWrap:"wrap"},children:[(0,n.jsx)("button",{onClick:()=>{m(null),y(null)},style:{padding:"8px 16px",background:"#ef4444",color:"white",border:"none",borderRadius:8,cursor:"pointer"},children:"Remover Foto"}),!_&&(0,n.jsx)("button",{onClick:el,disabled:v,style:{padding:"8px 16px",background:v?"#9ca3af":"#8b5cf6",color:"white",border:"none",borderRadius:8,cursor:v?"not-allowed":"pointer",fontWeight:600},children:v?"Analisando...":"Analisar Foto com IA"})]})]}):(0,n.jsxs)("label",{style:{cursor:"pointer"},children:[(0,n.jsx)("div",{style:{fontSize:40,marginBottom:8,color:"#2196F3"},children:"Foto"}),(0,n.jsx)("div",{style:{fontSize:14,color:"#666",marginBottom:12},children:"Adicionar foto da refei\xe7\xe3o (opcional)"}),(0,n.jsx)("input",{type:"file",accept:"image/*",onChange:er,style:{display:"none"}}),(0,n.jsx)("div",{style:{display:"inline-block",padding:"10px 20px",background:"#2196F3",color:"white",borderRadius:8,fontWeight:600,fontSize:14},children:"Selecionar Foto"})]})}),!_&&(0,n.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginBottom:24},children:[(0,n.jsx)("button",{onClick:()=>Q(!0),style:{padding:16,background:"#10b981",color:"white",border:"none",borderRadius:12,fontSize:16,fontWeight:600,cursor:"pointer"},children:"Meus Alimentos"}),(0,n.jsx)("button",{onClick:()=>Y(!0),style:{padding:16,background:"#3b82f6",color:"white",border:"none",borderRadius:12,fontSize:16,fontWeight:600,cursor:"pointer"},children:"Adicionar Novo"})]}),!_&&V.length>0&&(0,n.jsxs)("div",{style:{background:"#f0fdf4",border:"2px solid #10b981",borderRadius:16,padding:24,marginBottom:24},children:[(0,n.jsxs)("h3",{style:{fontSize:18,fontWeight:600,marginBottom:16,color:"#065f46"},children:["Alimentos Adicionados (",V.length,")"]}),(0,n.jsx)("div",{style:{display:"grid",gap:12,marginBottom:16},children:V.map((e,t)=>(0,n.jsxs)("div",{style:{padding:12,background:"white",borderRadius:8,border:"1px solid #e5e7eb",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{style:{fontWeight:600},children:e.name}),(0,n.jsxs)("div",{style:{fontSize:12,color:"#6b7280"},children:[e.quantity," ",e.unit,"bank"===e.source&&(0,n.jsx)("span",{children:" • Do banco"}),"new"===e.source&&(0,n.jsx)("span",{children:" • Novo"})]})]}),(0,n.jsx)("button",{onClick:()=>(function(e){let t=[...V];t.splice(e,1),J(t)})(t),style:{padding:"6px",background:"#fee2e2",color:"#dc2626",border:"none",borderRadius:6,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},title:"Remover",children:(0,n.jsx)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:(0,n.jsx)("path",{d:"M3 6h18M8 6V4a2 2 0 012-2h4a2 2 0 012 2v2m3 0v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6h14M10 11v6M14 11v6"})})})]},t))}),(0,n.jsx)("button",{onClick:ec,disabled:v,style:{width:"100%",padding:16,background:v?"#9ca3af":"#8b5cf6",color:"white",border:"none",borderRadius:12,fontSize:16,fontWeight:600,cursor:v?"not-allowed":"pointer"},children:v?"Analisando com IA...":"Analisar com IA"})]}),A&&(0,n.jsx)("div",{style:{padding:16,background:"#fee2e2",border:"2px solid #ef4444",borderRadius:12,color:"#991b1b",marginBottom:24},children:A}),I&&(0,n.jsx)("div",{style:{padding:16,background:"#d1fae5",border:"2px solid #10b981",borderRadius:12,color:"#065f46",marginBottom:24},children:"Refei\xe7\xe3o salva com sucesso!"}),_&&(0,n.jsxs)("div",{style:{marginBottom:32},children:[(0,n.jsxs)("div",{style:{background:"white",border:"2px solid #e5e7eb",borderRadius:16,padding:24,marginBottom:24},children:[(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[(0,n.jsx)("h2",{style:{fontSize:20,fontWeight:700},children:"An\xe1lise da Refei\xe7\xe3o"}),(0,n.jsxs)("div",{style:{padding:"8px 16px",background:"#dbeafe",color:"#1e40af",borderRadius:20,fontWeight:600},children:[ep," kcal"]})]}),_.notes&&(0,n.jsx)("p",{style:{color:"#666",fontSize:14,marginBottom:16,fontStyle:"italic"},children:_.notes}),(0,n.jsx)("div",{style:{display:"grid",gap:12},children:null===(t=_.foods)||void 0===t?void 0:t.map((e,t)=>(0,n.jsxs)("div",{style:{padding:16,background:"#f9fafb",borderRadius:12,border:"1px solid #e5e7eb"},children:[(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:12,alignItems:"center"},children:[(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,n.jsx)("span",{style:{fontWeight:600,fontSize:16},children:e.name}),"taco"===e.source&&(0,n.jsx)("span",{style:{fontSize:10,padding:"2px 6px",background:"#10b981",color:"white",borderRadius:4,fontWeight:600},children:"TACO"}),"bank"===e.source&&(0,n.jsx)("span",{style:{fontSize:10,padding:"2px 6px",background:"#3b82f6",color:"white",borderRadius:4,fontWeight:600},children:"MEUS ALIMENTOS"}),!e.source&&(0,n.jsx)("span",{style:{fontSize:10,padding:"2px 6px",background:"#f59e0b",color:"white",borderRadius:4,fontWeight:600},children:"IA"})]}),(0,n.jsxs)("span",{style:{color:"#666"},children:[e.quantity," ",e.unit]})]}),(0,n.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(120px, 1fr))",gap:8},children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{style:{fontSize:12,color:"#666",display:"block",marginBottom:4},children:"Calorias (kcal)"}),(0,n.jsx)("input",{type:"number",value:e.calories||"",onChange:e=>{let o=[..._.foods];o[t].calories=Number(e.target.value)||void 0,k({..._,foods:o})},style:{width:"100%",padding:"6px 8px",fontSize:14,border:"1px solid #d1d5db",borderRadius:6,outline:"none",boxSizing:"border-box"},placeholder:"0"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{style:{fontSize:12,color:"#666",display:"block",marginBottom:4},children:"Prote\xedna (g)"}),(0,n.jsx)("input",{type:"number",step:"0.1",value:e.protein_g||"",onChange:e=>{let o=[..._.foods];o[t].protein_g=Number(e.target.value)||void 0,k({..._,foods:o})},style:{width:"100%",padding:"6px 8px",fontSize:14,border:"1px solid #d1d5db",borderRadius:6,outline:"none",boxSizing:"border-box"},placeholder:"0"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{style:{fontSize:12,color:"#666",display:"block",marginBottom:4},children:"Carboidrato (g)"}),(0,n.jsx)("input",{type:"number",step:"0.1",value:e.carbs_g||"",onChange:e=>{let o=[..._.foods];o[t].carbs_g=Number(e.target.value)||void 0,k({..._,foods:o})},style:{width:"100%",padding:"6px 8px",fontSize:14,border:"1px solid #d1d5db",borderRadius:6,outline:"none",boxSizing:"border-box"},placeholder:"0"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{style:{fontSize:12,color:"#666",display:"block",marginBottom:4},children:"Gordura (g)"}),(0,n.jsx)("input",{type:"number",step:"0.1",value:e.fat_g||"",onChange:e=>{let o=[..._.foods];o[t].fat_g=Number(e.target.value)||void 0,k({..._,foods:o})},style:{width:"100%",padding:"6px 8px",fontSize:14,border:"1px solid #d1d5db",borderRadius:6,outline:"none",boxSizing:"border-box"},placeholder:"0"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{style:{fontSize:12,color:"#666",display:"block",marginBottom:4},children:"Fibras (g)"}),(0,n.jsx)("input",{type:"number",step:"0.1",value:e.fiber_g||"",onChange:e=>{let o=[..._.foods];o[t].fiber_g=Number(e.target.value)||void 0,k({..._,foods:o})},style:{width:"100%",padding:"6px 8px",fontSize:14,border:"1px solid #d1d5db",borderRadius:6,outline:"none",boxSizing:"border-box"},placeholder:"0"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{style:{fontSize:12,color:"#666",display:"block",marginBottom:4},children:"S\xf3dio (mg)"}),(0,n.jsx)("input",{type:"number",step:"1",value:e.sodium_mg||"",onChange:e=>{let o=[..._.foods];o[t].sodium_mg=Number(e.target.value)||void 0,k({..._,foods:o})},style:{width:"100%",padding:"6px 8px",fontSize:14,border:"1px solid #d1d5db",borderRadius:6,outline:"none",boxSizing:"border-box"},placeholder:"0"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{style:{fontSize:12,color:"#666",display:"block",marginBottom:4},children:"A\xe7\xfacar (g)"}),(0,n.jsx)("input",{type:"number",step:"0.1",value:e.sugar_g||"",onChange:e=>{let o=[..._.foods];o[t].sugar_g=Number(e.target.value)||void 0,k({..._,foods:o})},style:{width:"100%",padding:"6px 8px",fontSize:14,border:"1px solid #d1d5db",borderRadius:6,outline:"none",boxSizing:"border-box"},placeholder:"0"})]})]})]},t))})]}),(0,n.jsxs)("div",{style:{display:"grid",gap:16},children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{style:{display:"block",marginBottom:8,fontWeight:600},children:"Tipo de Refei\xe7\xe3o *"}),(0,n.jsxs)("select",{value:w,onChange:e=>S(e.target.value),style:{width:"100%",padding:12,fontSize:16,border:w?"2px solid #e5e7eb":"2px solid #ef4444",borderRadius:8,backgroundColor:"white",boxSizing:"border-box"},children:[(0,n.jsx)("option",{value:"",children:"Selecione o tipo..."}),(0,n.jsx)("option",{value:"breakfast",children:"Caf\xe9 da Manh\xe3"}),(0,n.jsx)("option",{value:"lunch",children:"Almo\xe7o"}),(0,n.jsx)("option",{value:"dinner",children:"Jantar"}),(0,n.jsx)("option",{value:"snack",children:"Lanche"})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{style:{display:"block",marginBottom:8,fontWeight:600},children:"Quando foi consumido?"}),(0,n.jsx)("input",{type:"datetime-local",value:R,onChange:e=>z(e.target.value),style:{width:"100%",padding:12,fontSize:16,border:"2px solid #e5e7eb",borderRadius:8,boxSizing:"border-box"}})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{style:{display:"block",marginBottom:8,fontWeight:600},children:"Observa\xe7\xf5es (opcional)"}),(0,n.jsx)("input",{type:"text",value:C,onChange:e=>B(e.target.value),placeholder:"Ex: Comi tudo, estava delicioso!",style:{width:"100%",padding:12,fontSize:16,border:"2px solid #e5e7eb",borderRadius:8,boxSizing:"border-box"}})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{style:{display:"block",marginBottom:8,fontWeight:600},children:"Local da Refei\xe7\xe3o"}),(0,n.jsxs)("div",{style:{display:"flex",gap:8,marginBottom:8},children:[(0,n.jsx)("button",{type:"button",onClick:()=>{M("home"),U(null)},style:{flex:1,padding:10,borderRadius:8,border:"home"===N?"2px solid #10b981":"2px solid #e5e7eb",background:"home"===N?"#ecfdf5":"white",fontWeight:600,color:"home"===N?"#065f46":"#374151"},children:"Casa"}),(0,n.jsx)("button",{type:"button",onClick:()=>M("out"),style:{flex:1,padding:10,borderRadius:8,border:"out"===N?"2px solid #f59e0b":"2px solid #e5e7eb",background:"out"===N?"#fffbeb":"white",fontWeight:600,color:"out"===N?"#92400e":"#374151"},children:"Fora"})]}),"out"===N&&(0,n.jsxs)("div",{style:{position:"relative"},children:[(0,n.jsx)("label",{style:{display:"block",marginBottom:6,fontWeight:500,color:"#92400e"},children:"Restaurante (obrigat\xf3rio)"}),(0,n.jsx)("input",{type:"text",value:P,onChange:async e=>{let t=e.target.value;if(T(t),L&&U(null),t.trim().length<2){O([]);return}try{q(!0);let e=await s.h.get("/api/restaurants/search?q=".concat(encodeURIComponent(t))),o=await e.json();e.ok&&O(o.restaurants||[])}finally{q(!1)}},placeholder:"Digite o nome do restaurante...",style:{width:"100%",padding:12,fontSize:16,border:"2px solid #fbbf24",borderRadius:L?"8px":"8px 8px 0 0",outline:"none",boxSizing:"border-box"}}),!L&&(F||D.length>0||P.trim().length>=2&&0===D.length)&&(0,n.jsxs)("div",{style:{position:"absolute",top:"100%",left:0,right:0,background:"white",border:"1px solid #e5e7eb",borderTop:"none",borderRadius:"0 0 8px 8px",maxHeight:200,overflowY:"auto",zIndex:10},children:[F&&(0,n.jsx)("div",{style:{padding:10,fontSize:14,color:"#6b7280"},children:"Carregando..."}),!F&&D.map(e=>(0,n.jsxs)("button",{type:"button",onClick:()=>{U({id:e.id,name:e.name}),T(e.name),O([])},style:{width:"100%",textAlign:"left",padding:"10px 12px",border:"none",background:"white",cursor:"pointer",borderBottom:"1px solid #f3f4f6"},children:[(0,n.jsx)("div",{style:{fontWeight:600},children:e.name}),e.address&&(0,n.jsx)("div",{style:{fontSize:12,color:"#6b7280"},children:e.address})]},e.id)),!F&&0===D.length&&P.trim().length>=2&&(0,n.jsxs)("div",{style:{padding:10},children:[(0,n.jsx)("div",{style:{fontSize:14,color:"#6b7280",marginBottom:8},children:"Nenhum restaurante encontrado."}),(0,n.jsxs)("button",{type:"button",onClick:async()=>{if(P.trim()&&confirm('Cadastrar o restaurante "'.concat(P.trim(),'"?')))try{q(!0);let e=await s.h.post("/api/restaurants",{name:P.trim()}),t=await e.json();if(e.ok){let e=t.restaurant.name;U({id:t.restaurant.id,name:e}),T(e),O([])}else alert(t.error||"Erro ao cadastrar restaurante")}catch(e){alert("Erro ao cadastrar restaurante: "+e.message)}finally{q(!1)}},style:{width:"100%",padding:"10px 12px",background:"#10b981",color:"white",border:"none",borderRadius:6,fontWeight:700,cursor:"pointer"},children:['Cadastrar "',P.trim(),'"']})]})]}),L&&(0,n.jsxs)("div",{style:{marginTop:8,fontSize:13,color:"#92400e"},children:["Selecionado: ",(0,n.jsx)("strong",{children:L.name})]})]})]}),(0,n.jsx)("button",{onClick:eu,disabled:v,style:{width:"100%",padding:16,background:"#2196F3",color:"white",border:"none",borderRadius:12,fontSize:16,fontWeight:600,cursor:v?"not-allowed":"pointer",opacity:v?.6:1},children:v?"Salvando...":"Salvar Refei\xe7\xe3o"})]})]}),H&&(0,n.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:50,padding:20},children:(0,n.jsxs)("div",{style:{background:"white",borderRadius:16,padding:24,maxWidth:500,width:"100%",maxHeight:"80vh",overflowY:"auto"},children:[(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[(0,n.jsx)("h2",{style:{fontSize:20,fontWeight:700},children:"Meus Alimentos"}),(0,n.jsx)("button",{onClick:()=>{Q(!1),K(""),$([])},style:{padding:8,background:"#f3f4f6",border:"none",borderRadius:8,cursor:"pointer",color:"#6b7280",display:"flex",alignItems:"center",justifyContent:"center"},title:"Fechar",children:(0,n.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:(0,n.jsx)("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),(0,n.jsx)("input",{type:"text",value:G,onChange:e=>{K(e.target.value),ea(e.target.value)},placeholder:"Buscar alimento...",style:{width:"100%",padding:12,fontSize:16,border:"2px solid #10b981",borderRadius:8,outline:"none",marginBottom:16,boxSizing:"border-box"}}),ee&&(0,n.jsx)("div",{style:{textAlign:"center",color:"#6b7280"},children:"Buscando..."}),!ee&&Z.length>0&&(0,n.jsx)("div",{style:{display:"grid",gap:8},children:Z.map(e=>(0,n.jsxs)("button",{onClick:()=>ed(e),style:{width:"100%",textAlign:"left",padding:12,background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:8,cursor:"pointer"},children:[(0,n.jsxs)("div",{style:{fontWeight:600,marginBottom:4},children:[e.name,e.brand&&(0,n.jsxs)("span",{style:{color:"#6b7280",fontWeight:400},children:[" - ",e.brand]})]}),(0,n.jsxs)("div",{style:{fontSize:12,color:"#6b7280"},children:[e.serving_size&&(0,n.jsxs)("span",{children:["Por\xe7\xe3o: ",e.serving_size," | "]}),e.calories&&(0,n.jsxs)("span",{children:[e.calories," kcal"]})]})]},e.id))}),!ee&&G.length>=2&&0===Z.length&&(0,n.jsxs)("div",{style:{textAlign:"center",color:"#dc2626",padding:16},children:["Nenhum alimento encontrado. ",(0,n.jsx)("a",{href:"/meus-alimentos",style:{color:"#2196F3",textDecoration:"underline"},children:"Cadastre aqui"})]})]})}),X&&(0,n.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:50,padding:20},children:(0,n.jsxs)("div",{style:{background:"white",borderRadius:16,padding:24,maxWidth:400,width:"100%"},children:[(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[(0,n.jsx)("h2",{style:{fontSize:20,fontWeight:700},children:"Adicionar Novo Alimento"}),(0,n.jsx)("button",{onClick:()=>{Y(!1),en("")},style:{padding:8,background:"#f3f4f6",border:"none",borderRadius:8,cursor:"pointer",color:"#6b7280",display:"flex",alignItems:"center",justifyContent:"center"},title:"Fechar",children:(0,n.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:(0,n.jsx)("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),(0,n.jsx)("input",{type:"text",value:eo,onChange:e=>en(e.target.value),placeholder:"Ex: Bife de frango grelhado",style:{width:"100%",padding:12,fontSize:16,border:"2px solid #3b82f6",borderRadius:8,outline:"none",marginBottom:16,boxSizing:"border-box"},onKeyDown:e=>{"Enter"===e.key&&es()},autoFocus:!0}),(0,n.jsx)("button",{onClick:es,style:{width:"100%",padding:12,background:"#3b82f6",color:"white",border:"none",borderRadius:8,fontSize:16,fontWeight:600,cursor:"pointer"},children:"Adicionar"})]})})]})}},95682:function(e,t,o){"use strict";function n(e,t){return{canUseFeature:o=>"free"!==e&&("unlimited"===e||!!t&&("photo"===o?t.photo_analyses:"ocr"===o?t.ocr_analyses:"text"===o?t.text_analyses:t.report_analyses||{used:0,limit:0,percentage:0,remaining:0}).remaining>0),getQuotaInfo:o=>{if("free"===e)return{used:0,limit:0,remaining:0,percentage:0,canUse:!1};if("unlimited"===e){var n;return{used:t?"photo"===o?t.photo_analyses.used:"ocr"===o?t.ocr_analyses.used:"text"===o?t.text_analyses.used:(null===(n=t.report_analyses)||void 0===n?void 0:n.used)||0:0,limit:999999,remaining:999999,percentage:0,canUse:!0}}if(!t)return{used:0,limit:0,remaining:0,percentage:0,canUse:!1};let i="photo"===o?t.photo_analyses:"ocr"===o?t.ocr_analyses:"text"===o?t.text_analyses:t.report_analyses||{used:0,limit:0,percentage:0,remaining:0};return{used:i.used,limit:i.limit,remaining:i.remaining,percentage:i.percentage,canUse:i.remaining>0}},hasQuota:"premium"===e&&null!==t}}o.d(t,{f:function(){return n}})},68398:function(e,t,o){"use strict";o.d(t,{Ob:function(){return u},showRewardedAd:function(){return p},tJ:function(){return c}});var n=o(87185);function i(e,t){var o;return(null===(o=process.env)||void 0===o?void 0:o[e])||t}i("NEXT_PUBLIC_ADMOB_APP_ID_IOS","ca-app-pub-1018925088575422~2172895788");let r=i("NEXT_PUBLIC_ADMOB_BANNER_ID_IOS","ca-app-pub-1018925088575422/1014553329"),a=i("NEXT_PUBLIC_ADMOB_REWARDED_ID_IOS","ca-app-pub-1018925088575422/2438303871"),d=null,s=!1;async function l(){if(!d)try{d=(await o.e(124).then(o.bind(o,97124))).AdMob}catch(e){console.warn("[AdMob] Community plugin not available:",e),d=null}}async function c(){if(n.dV.isNativePlatform()&&!s){if(await l(),!d){s=!0;return}try{await d.initialize({requestTrackingAuthorization:!0})}catch(e){console.warn("[AdMob] init error (non-fatal):",e)}finally{s=!0}}}async function u(){if(n.dV.isNativePlatform()&&(await c(),d))try{"function"==typeof d.showBannerAd?await d.showBannerAd({adId:r,position:"TOP_CENTER"}):"function"==typeof d.showBanner&&await d.showBanner({adId:r,position:"TOP_CENTER"})}catch(e){console.warn("[AdMob] showTopBanner failed:",e)}}async function p(e){if(!n.dV.isNativePlatform())return console.log("[AdMob] Not native, simulating rewarded ad for dev"),!0;if(await c(),!d)return!0;try{if("function"==typeof d.showRewardedAd)return await d.showRewardedAd({adId:a}),!0;if("function"==typeof d.showRewardVideoAd)return await d.showRewardVideoAd({adId:a}),!0;return console.warn("[AdMob] No rewarded method available"),!1}catch(e){return console.warn("[AdMob] showRewardedAd failed:",e),!1}}},45224:function(e,t,o){"use strict";o.d(t,{q:function(){return i}});var n=o(68398);async function i(e,t){let o=await e();if(403!==o.status)return o;try{let i=await o.clone().json().catch(()=>({}));if((null==i?void 0:i.error)==="watch_ad_required"){if(!await (0,n.showRewardedAd)(null==t?void 0:t.feature))return o;return await e({"x-ad-completed":"1"})}}catch(e){}return o}},16463:function(e,t,o){"use strict";var n=o(71169);o.o(n,"usePathname")&&o.d(t,{usePathname:function(){return n.usePathname}}),o.o(n,"useRouter")&&o.d(t,{useRouter:function(){return n.useRouter}}),o.o(n,"useSearchParams")&&o.d(t,{useSearchParams:function(){return n.useSearchParams}})}},function(e){e.O(0,[325,78,971,23,744],function(){return e(e.s=77372)}),_N_E=e.O()}]);