(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{5695:function(e,t,n){Promise.resolve().then(n.bind(n,7847)),Promise.resolve().then(n.t.bind(n,6830,23)),Promise.resolve().then(n.t.bind(n,8877,23))},7847:function(e,t,n){"use strict";n.d(t,{default:function(){return m}});var i=n(7437),r=n(2265),s=n(6463),o=n(8059),a=n.n(o),l=n(8174),c=n(7138),u=n(4799),d=n(6394);let f=[{href:"/",label:"In\xedcio",icon:""},{href:"/capture",label:"Capturar",icon:""},{href:"/history",label:"Hist\xf3rico",icon:""},{href:"/peso",label:"Peso",icon:""},{href:"/lista-compras",label:"Lista de Compras",icon:""},{href:"/coach",label:"Coach IA",icon:""},{href:"/reports",label:"Relat\xf3rios",icon:""},{href:"/restaurants",label:"Restaurantes",icon:""},{href:"/meus-alimentos",label:"Meus Alimentos",icon:""},{href:"/account",label:"Minha Conta",icon:""}];function h(e){let{children:t,tenantName:n,userName:o}=e,h=(0,s.useRouter)(),p=(0,s.usePathname)(),[m,_]=(0,r.useState)(!1),{plan:y,isLoading:g}=(0,d.R)();async function b(){if(localStorage.getItem("auth_token")){localStorage.removeItem("auth_token"),window.location.href="/login";return}try{await (0,l.w7)({redirect:!1})}catch(e){console.error("SignOut error:",e)}h.push("/login")}return(0,i.jsxs)("div",{style:{minHeight:"100vh",backgroundColor:"#f5f5f5"},className:"jsx-b7583fed3aa9f422",children:[(0,i.jsxs)("header",{style:{backgroundColor:"#fff",borderBottom:"1px solid #e0e0e0",position:"sticky",top:0,zIndex:100,paddingTop:"env(safe-area-inset-top)"},className:"jsx-b7583fed3aa9f422",children:[(0,i.jsxs)("div",{style:{padding:"0 16px",display:"flex",justifyContent:"space-between",alignItems:"center",height:56},className:"jsx-b7583fed3aa9f422",children:[(0,i.jsx)(c.default,{href:"/",style:{textDecoration:"none"},children:(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},className:"jsx-b7583fed3aa9f422",children:[(0,i.jsxs)("div",{className:"jsx-b7583fed3aa9f422",children:[(0,i.jsx)("h1",{style:{fontSize:18,fontWeight:700,margin:0,color:"#2196F3",cursor:"pointer"},className:"jsx-b7583fed3aa9f422",children:"Food Tracker"}),n&&(0,i.jsx)("p",{style:{fontSize:10,color:"#666",margin:0},className:"jsx-b7583fed3aa9f422",children:n})]}),!g&&(0,i.jsx)(u.Z,{plan:y,size:"sm"})]})}),(0,i.jsxs)("nav",{style:{display:"flex",gap:8,alignItems:"center"},className:"jsx-b7583fed3aa9f422",children:[(0,i.jsxs)("div",{style:{display:"none"},className:"jsx-b7583fed3aa9f422 desktop-nav-items",children:[f.map(e=>(0,i.jsx)(c.default,{href:e.href,style:{padding:"8px 16px",borderRadius:8,textDecoration:"none",color:p===e.href?"#2196F3":"#333",backgroundColor:p===e.href?"#E3F2FD":"transparent",fontWeight:p===e.href?600:400,fontSize:14},children:e.label},e.href)),(0,i.jsx)("button",{onClick:b,style:{marginLeft:16,padding:"8px 16px",borderRadius:8,border:"1px solid #e0e0e0",backgroundColor:"#fff",cursor:"pointer",fontSize:14,color:"#c62828"},className:"jsx-b7583fed3aa9f422",children:"Sair"})]}),(0,i.jsx)("button",{onClick:()=>_(!m),style:{display:"block",padding:8,border:"none",background:"none",fontSize:24,cursor:"pointer",lineHeight:1},"aria-label":m?"Fechar menu":"Abrir menu",className:"jsx-b7583fed3aa9f422 mobile-menu-btn",children:m?"✕":"☰"})]})]}),m&&(0,i.jsxs)("div",{style:{borderTop:"1px solid #e0e0e0",backgroundColor:"#fff",padding:"8px 0"},className:"jsx-b7583fed3aa9f422",children:[f.map(e=>(0,i.jsxs)(c.default,{href:e.href,onClick:()=>_(!1),style:{display:"flex",alignItems:"center",gap:12,padding:"12px 16px",textDecoration:"none",color:p===e.href?"#2196F3":"#333",backgroundColor:p===e.href?"#E3F2FD":"transparent",fontWeight:p===e.href?600:400,fontSize:16},children:[(0,i.jsx)("span",{style:{fontSize:20},className:"jsx-b7583fed3aa9f422",children:e.icon}),e.label]},e.href)),(0,i.jsx)("div",{style:{borderTop:"1px solid #e0e0e0",margin:"8px 0"},className:"jsx-b7583fed3aa9f422"}),(0,i.jsxs)("button",{onClick:b,style:{width:"100%",display:"flex",alignItems:"center",gap:12,padding:"12px 16px",border:"none",backgroundColor:"transparent",textAlign:"left",cursor:"pointer",fontSize:16,color:"#c62828"},className:"jsx-b7583fed3aa9f422",children:[(0,i.jsx)("span",{style:{fontSize:20},className:"jsx-b7583fed3aa9f422"}),"Sair"]})]})]}),(0,i.jsx)("main",{className:"jsx-b7583fed3aa9f422",children:t}),(0,i.jsx)(a(),{id:"b7583fed3aa9f422",children:"@media(min-width:768px){.desktop-nav-items{display:-webkit-box!important;display:-webkit-flex!important;display:-moz-box!important;display:-ms-flexbox!important;display:flex!important}.mobile-menu-btn{display:none!important}}"})]})}async function p(e){try{let t="appl_OiPDVxuiDMQziBsdvPSKUEnoquI";if(!t){console.warn("[RevenueCat] API key not configured");return}let{Purchases:i}=await n.e(938).then(n.bind(n,1938));await i.configure({apiKey:t,appUserID:e}),console.log("[RevenueCat] Initialized with userId:",e)}catch(e){console.error("[RevenueCat] Init error:",e)}}function m(e){let{children:t}=e,n=(0,s.useRouter)(),o=(0,s.usePathname)(),[a,l]=(0,r.useState)(!1),c=(0,r.useRef)(!1);return((0,r.useEffect)(()=>{if(["/login","/signup"].some(e=>null==o?void 0:o.startsWith(e))){l(!0);return}let e=localStorage.getItem("auth_token");if(e){if(l(!0),!c.current){c.current=!0;let t=function(e){try{let t=e.split(".");if(3!==t.length)return null;let n=t[1],i=atob(n.replace(/-/g,"+").replace(/_/g,"/"));return JSON.parse(i)}catch(e){return null}}(e),n=null==t?void 0:t.userId;n&&p(n)}}else n.push("/login")},[n,o]),a)?["/login","/signup"].some(e=>null==o?void 0:o.startsWith(e))?(0,i.jsx)("div",{style:{paddingTop:"env(safe-area-inset-top)"},children:t}):(0,i.jsx)(h,{tenantName:"Food Tracker",userName:"Voc\xea",children:t}):(0,i.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",paddingTop:"env(safe-area-inset-top)"},children:"Carregando..."})}},4799:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var i=n(7437);let r={free:{label:"FREE",emoji:"",bg:"linear-gradient(135deg, #f3f4f6 0%, #e5e7eb 100%)",text:"#6b7280",border:"#d1d5db"},premium:{label:"PRO",emoji:"",bg:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",text:"#ffffff",border:"#667eea"},unlimited:{label:"ADMIN",emoji:"⭐",bg:"linear-gradient(135deg, #f093fb 0%, #f5576c 100%)",text:"#ffffff",border:"#f093fb"}},s={sm:{fontSize:10,padding:"2px 6px",gap:3},md:{fontSize:12,padding:"4px 8px",gap:4},lg:{fontSize:14,padding:"6px 12px",gap:6}};function o(e){let{plan:t,size:n="md"}=e,o=r[t],a=s[n];return(0,i.jsxs)("span",{style:{display:"inline-flex",alignItems:"center",gap:a.gap,padding:a.padding,borderRadius:6,background:o.bg,color:o.text,fontSize:a.fontSize,fontWeight:700,letterSpacing:"0.5px",border:"1px solid ".concat(o.border),textTransform:"uppercase",lineHeight:1,whiteSpace:"nowrap"},children:[o.emoji&&(0,i.jsx)("span",{children:o.emoji}),o.label]})}},6394:function(e,t,n){"use strict";n.d(t,{R:function(){return c}});var i=n(2265),r=n(7185),s=n(5591);async function o(){let e=await s.h.get("/api/user/profile");if(!e.ok)throw Error("Failed to fetch user plan: ".concat(e.status));let t=(await e.json()).user;return{plan:t.plan||"free",subscription_status:t.subscription_status||"active",subscription_started_at:t.subscription_started_at,subscription_expires_at:t.subscription_expires_at}}async function a(){let e=await s.h.get("/api/subscription/quota");if(!e.ok)throw Error("Failed to fetch quota usage: ".concat(e.status));return e.json()}async function l(){try{let{Purchases:e}=await n.e(938).then(n.bind(n,1938)),{customerInfo:t}=await e.getCustomerInfo();await s.h.post("/api/subscription/sync",{customerInfo:t}),console.log("[useUserPlan] Sync success")}catch(e){console.warn("[useUserPlan] Sync error:",e)}}function c(){let[e,t]=(0,i.useState)("free"),[n,s]=(0,i.useState)("active"),[c,u]=(0,i.useState)(null),[d,f]=(0,i.useState)(!0),[h,p]=(0,i.useState)(null),m=(0,i.useRef)(!1),_=async()=>{try{f(!0),p(null),r.dV.isNativePlatform()&&!m.current&&(m.current=!0,await l());let e=await o();if(t(e.plan),s(e.subscription_status),"premium"===e.plan){let e=await a(),t=function(e){let t=e.photo_analyses/e.limits.photo_analyses_per_month*100,n=e.ocr_analyses/e.limits.ocr_analyses_per_month*100,i=new Date,r=new Date(i.getFullYear(),i.getMonth()+1,1);return{photo_analyses:{used:e.photo_analyses,limit:e.limits.photo_analyses_per_month,percentage:Math.round(t),remaining:e.limits.photo_analyses_per_month-e.photo_analyses},ocr_analyses:{used:e.ocr_analyses,limit:e.limits.ocr_analyses_per_month,percentage:Math.round(n),remaining:e.limits.ocr_analyses_per_month-e.ocr_analyses},resetDate:r}}(e);u(t)}else u(null)}catch(e){console.error("Error fetching user plan:",e),p(e instanceof Error?e:Error("Unknown error")),t("free"),u(null)}finally{f(!1)}};return(0,i.useEffect)(()=>{_()},[]),{plan:e,subscription_status:n,quota:c,isLoading:d,error:h,refetch:_}}},5591:function(e,t,n){"use strict";n.d(t,{h:function(){return s},x:function(){return r}});let i=n(357).env.NEXT_PUBLIC_API_URL||"https://app.foodtracker.com.br";async function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{token:n,...r}=t,s={...r.headers};if(n)s.Authorization="Bearer ".concat(n);else{let e=localStorage.getItem("auth_token");console.log("[API Client] localStorage auth_token:",e?"exists":"null"),e&&(s.Authorization="Bearer ".concat(e))}r.body&&"string"==typeof r.body&&!s["Content-Type"]&&(s["Content-Type"]="application/json");let o=e.startsWith("http")?e:"".concat(i).concat(e);console.log("[API Client]",{isMobile:!0,baseUrl:i,endpoint:e,finalUrl:o,hasAuthToken:!!s.Authorization});try{let t=await fetch(o,{...r,headers:s,credentials:"include"});return console.log("[API Client] Response ".concat(e,":"),{status:t.status}),401!==t.status||window.location.pathname.includes("/login")||(console.warn("401 Unauthorized - Redirecting to login"),localStorage.removeItem("auth_token"),window.location.href="/login"),t}catch(e){throw console.error("[API Client Error]",e),e}}let s={get:(e,t)=>r(e,{method:"GET",token:t}),post:(e,t,n)=>r(e,{method:"POST",body:JSON.stringify(t),token:n}),put:(e,t,n)=>r(e,{method:"PUT",body:JSON.stringify(t),token:n}),patch:(e,t,n)=>r(e,{method:"PATCH",body:JSON.stringify(t),token:n}),delete:(e,t)=>r(e,{method:"DELETE",token:t})}},5718:function(){},3398:function(e,t,n){"use strict";var i=n(357);n(5718);var r=n(2265),s=r&&"object"==typeof r&&"default"in r?r:{default:r},o=void 0!==i&&i.env&&!0,a=function(e){return"[object String]"===Object.prototype.toString.call(e)},l=function(){function e(e){var t=void 0===e?{}:e,n=t.name,i=void 0===n?"stylesheet":n,r=t.optimizeForSpeed,s=void 0===r?o:r;c(a(i),"`name` must be a string"),this._name=i,this._deletedRulePlaceholder="#"+i+"-deleted-rule____{}",c("boolean"==typeof s,"`optimizeForSpeed` must be a boolean"),this._optimizeForSpeed=s,this._serverSheet=void 0,this._tags=[],this._injected=!1,this._rulesCount=0;var l="undefined"!=typeof window&&document.querySelector('meta[property="csp-nonce"]');this._nonce=l?l.getAttribute("content"):null}var t=e.prototype;return t.setOptimizeForSpeed=function(e){c("boolean"==typeof e,"`setOptimizeForSpeed` accepts a boolean"),c(0===this._rulesCount,"optimizeForSpeed cannot be when rules have already been inserted"),this.flush(),this._optimizeForSpeed=e,this.inject()},t.isOptimizeForSpeed=function(){return this._optimizeForSpeed},t.inject=function(){var e=this;if(c(!this._injected,"sheet already injected"),this._injected=!0,"undefined"!=typeof window&&this._optimizeForSpeed){this._tags[0]=this.makeStyleTag(this._name),this._optimizeForSpeed="insertRule"in this.getSheet(),this._optimizeForSpeed||(o||console.warn("StyleSheet: optimizeForSpeed mode not supported falling back to standard mode."),this.flush(),this._injected=!0);return}this._serverSheet={cssRules:[],insertRule:function(t,n){return"number"==typeof n?e._serverSheet.cssRules[n]={cssText:t}:e._serverSheet.cssRules.push({cssText:t}),n},deleteRule:function(t){e._serverSheet.cssRules[t]=null}}},t.getSheetForTag=function(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]},t.getSheet=function(){return this.getSheetForTag(this._tags[this._tags.length-1])},t.insertRule=function(e,t){if(c(a(e),"`insertRule` accepts only strings"),"undefined"==typeof window)return"number"!=typeof t&&(t=this._serverSheet.cssRules.length),this._serverSheet.insertRule(e,t),this._rulesCount++;if(this._optimizeForSpeed){var n=this.getSheet();"number"!=typeof t&&(t=n.cssRules.length);try{n.insertRule(e,t)}catch(t){return o||console.warn("StyleSheet: illegal rule: \n\n"+e+"\n\nSee https://stackoverflow.com/q/20007992 for more info"),-1}}else{var i=this._tags[t];this._tags.push(this.makeStyleTag(this._name,e,i))}return this._rulesCount++},t.replaceRule=function(e,t){if(this._optimizeForSpeed||"undefined"==typeof window){var n="undefined"!=typeof window?this.getSheet():this._serverSheet;if(t.trim()||(t=this._deletedRulePlaceholder),!n.cssRules[e])return e;n.deleteRule(e);try{n.insertRule(t,e)}catch(i){o||console.warn("StyleSheet: illegal rule: \n\n"+t+"\n\nSee https://stackoverflow.com/q/20007992 for more info"),n.insertRule(this._deletedRulePlaceholder,e)}}else{var i=this._tags[e];c(i,"old rule at index `"+e+"` not found"),i.textContent=t}return e},t.deleteRule=function(e){if("undefined"==typeof window){this._serverSheet.deleteRule(e);return}if(this._optimizeForSpeed)this.replaceRule(e,"");else{var t=this._tags[e];c(t,"rule at index `"+e+"` not found"),t.parentNode.removeChild(t),this._tags[e]=null}},t.flush=function(){this._injected=!1,this._rulesCount=0,"undefined"!=typeof window?(this._tags.forEach(function(e){return e&&e.parentNode.removeChild(e)}),this._tags=[]):this._serverSheet.cssRules=[]},t.cssRules=function(){var e=this;return"undefined"==typeof window?this._serverSheet.cssRules:this._tags.reduce(function(t,n){return n?t=t.concat(Array.prototype.map.call(e.getSheetForTag(n).cssRules,function(t){return t.cssText===e._deletedRulePlaceholder?null:t})):t.push(null),t},[])},t.makeStyleTag=function(e,t,n){t&&c(a(t),"makeStyleTag accepts only strings as second parameter");var i=document.createElement("style");this._nonce&&i.setAttribute("nonce",this._nonce),i.type="text/css",i.setAttribute("data-"+e,""),t&&i.appendChild(document.createTextNode(t));var r=document.head||document.getElementsByTagName("head")[0];return n?r.insertBefore(i,n):r.appendChild(i),i},function(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}(e.prototype,[{key:"length",get:function(){return this._rulesCount}}]),e}();function c(e,t){if(!e)throw Error("StyleSheet: "+t+".")}var u=function(e){for(var t=5381,n=e.length;n;)t=33*t^e.charCodeAt(--n);return t>>>0},d={};function f(e,t){if(!t)return"jsx-"+e;var n=String(t),i=e+n;return d[i]||(d[i]="jsx-"+u(e+"-"+n)),d[i]}function h(e,t){"undefined"==typeof window&&(t=t.replace(/\/style/gi,"\\/style"));var n=e+t;return d[n]||(d[n]=t.replace(/__jsx-style-dynamic-selector/g,e)),d[n]}var p=function(){function e(e){var t=void 0===e?{}:e,n=t.styleSheet,i=void 0===n?null:n,r=t.optimizeForSpeed,s=void 0!==r&&r;this._sheet=i||new l({name:"styled-jsx",optimizeForSpeed:s}),this._sheet.inject(),i&&"boolean"==typeof s&&(this._sheet.setOptimizeForSpeed(s),this._optimizeForSpeed=this._sheet.isOptimizeForSpeed()),this._fromServer=void 0,this._indices={},this._instancesCounts={}}var t=e.prototype;return t.add=function(e){var t=this;void 0===this._optimizeForSpeed&&(this._optimizeForSpeed=Array.isArray(e.children),this._sheet.setOptimizeForSpeed(this._optimizeForSpeed),this._optimizeForSpeed=this._sheet.isOptimizeForSpeed()),"undefined"==typeof window||this._fromServer||(this._fromServer=this.selectFromServer(),this._instancesCounts=Object.keys(this._fromServer).reduce(function(e,t){return e[t]=0,e},{}));var n=this.getIdAndRules(e),i=n.styleId,r=n.rules;if(i in this._instancesCounts){this._instancesCounts[i]+=1;return}var s=r.map(function(e){return t._sheet.insertRule(e)}).filter(function(e){return -1!==e});this._indices[i]=s,this._instancesCounts[i]=1},t.remove=function(e){var t=this,n=this.getIdAndRules(e).styleId;if(function(e,t){if(!e)throw Error("StyleSheetRegistry: "+t+".")}(n in this._instancesCounts,"styleId: `"+n+"` not found"),this._instancesCounts[n]-=1,this._instancesCounts[n]<1){var i=this._fromServer&&this._fromServer[n];i?(i.parentNode.removeChild(i),delete this._fromServer[n]):(this._indices[n].forEach(function(e){return t._sheet.deleteRule(e)}),delete this._indices[n]),delete this._instancesCounts[n]}},t.update=function(e,t){this.add(t),this.remove(e)},t.flush=function(){this._sheet.flush(),this._sheet.inject(),this._fromServer=void 0,this._indices={},this._instancesCounts={}},t.cssRules=function(){var e=this,t=this._fromServer?Object.keys(this._fromServer).map(function(t){return[t,e._fromServer[t]]}):[],n=this._sheet.cssRules();return t.concat(Object.keys(this._indices).map(function(t){return[t,e._indices[t].map(function(e){return n[e].cssText}).join(e._optimizeForSpeed?"":"\n")]}).filter(function(e){return!!e[1]}))},t.styles=function(e){var t,n;return t=this.cssRules(),void 0===(n=e)&&(n={}),t.map(function(e){var t=e[0],i=e[1];return s.default.createElement("style",{id:"__"+t,key:"__"+t,nonce:n.nonce?n.nonce:void 0,dangerouslySetInnerHTML:{__html:i}})})},t.getIdAndRules=function(e){var t=e.children,n=e.dynamic,i=e.id;if(n){var r=f(i,n);return{styleId:r,rules:Array.isArray(t)?t.map(function(e){return h(r,e)}):[h(r,t)]}}return{styleId:f(i),rules:Array.isArray(t)?t:[t]}},t.selectFromServer=function(){return Array.prototype.slice.call(document.querySelectorAll('[id^="__jsx-"]')).reduce(function(e,t){return e[t.id.slice(2)]=t,e},{})},e}(),m=r.createContext(null);m.displayName="StyleSheetContext";var _=s.default.useInsertionEffect||s.default.useLayoutEffect,y="undefined"!=typeof window?new p:void 0;function g(e){var t=y||r.useContext(m);return t&&("undefined"==typeof window?t.add(e):_(function(){return t.add(e),function(){t.remove(e)}},[e.id,String(e.dynamic)])),null}g.dynamic=function(e){return e.map(function(e){return f(e[0],e[1])}).join(" ")},t.style=g},8059:function(e,t,n){"use strict";e.exports=n(3398).style},8877:function(){},6830:function(e){e.exports={style:{fontFamily:"'__Poppins_51684b', '__Poppins_Fallback_51684b'",fontStyle:"normal"},className:"__className_51684b"}}},function(e){e.O(0,[5,187,174,138,971,23,744],function(){return e(e.s=5695)}),_N_E=e.O()}]);