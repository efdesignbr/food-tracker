(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[790],{7372:function(e,o,t){Promise.resolve().then(t.bind(t,7581))},7581:function(e,o,t){"use strict";t.r(o),t.d(o,{default:function(){return c}});var i=t(7437),n=t(2265),r=t(6394),a=t(5682),d=t(6285),l=t(5591);function s(){try{let e=new Intl.DateTimeFormat("sv-SE",{timeZone:"America/Sao_Paulo",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!1}).formatToParts(new Date),o=o=>{var t;return(null===(t=e.find(e=>e.type===o))||void 0===t?void 0:t.value)||""};return"".concat(o("year"),"-").concat(o("month"),"-").concat(o("day"),"T").concat(o("hour"),":").concat(o("minute"))}catch(t){let e=new Date,o=e=>String(e).padStart(2,"0");return"".concat(e.getFullYear(),"-").concat(o(e.getMonth()+1),"-").concat(o(e.getDate()),"T").concat(o(e.getHours()),":").concat(o(e.getMinutes()))}}function c(){var e,o;let{plan:t,quota:c,isLoading:u}=(0,r.R)(),{hasQuota:g}=(0,a.f)(t,c),[p,h]=(0,n.useState)(!1),[b,f]=(0,n.useState)(null),[m,x]=(0,n.useState)(null),[y,v]=(0,n.useState)(!1),[j,w]=(0,n.useState)(""),[S,k]=(0,n.useState)(null),[_,z]=(0,n.useState)(()=>s()),[C,R]=(0,n.useState)(""),[B,W]=(0,n.useState)(null),[A,E]=(0,n.useState)(!1),[I,N]=(0,n.useState)("home"),[F,M]=(0,n.useState)(""),[D,L]=(0,n.useState)([]),[T,q]=(0,n.useState)(!1),[O,P]=(0,n.useState)(null),[U,H]=(0,n.useState)([]),[Q,J]=(0,n.useState)(!1),[Y,V]=(0,n.useState)(!1),[G,K]=(0,n.useState)(""),[Z,X]=(0,n.useState)([]),[$,ee]=(0,n.useState)(!1),[eo,et]=(0,n.useState)("");async function ei(e){return new Promise((o,t)=>{let i=new FileReader;i.readAsDataURL(e),i.onload=i=>{var n;let r=new Image;r.src=null===(n=i.target)||void 0===n?void 0:n.result,r.onload=()=>{let i=document.createElement("canvas"),n=r.width,a=r.height;n>a&&n>1024?(a=1024*a/n,n=1024):a>1024&&(n=1024*n/a,a=1024),i.width=n,i.height=a;let d=i.getContext("2d");null==d||d.drawImage(r,0,0,n,a);let l=.8,s=()=>{i.toBlob(i=>{if(!i){t(Error("Erro ao comprimir imagem"));return}i.size<512e3||l<.3?o(new File([i],e.name,{type:"image/jpeg",lastModified:Date.now()})):(l-=.1,s())},"image/jpeg",l)};s()},r.onerror=()=>t(Error("Erro ao carregar imagem"))},i.onerror=()=>t(Error("Erro ao ler arquivo"))})}async function en(e){var o;let t=null===(o=e.target.files)||void 0===o?void 0:o[0];if(t){v(!0),W(null);try{let e=await ei(t);f(e),x(URL.createObjectURL(e))}catch(e){W("Erro ao processar imagem. Tente outra foto.")}finally{v(!1)}}}async function er(e){if(e.trim().length<2){X([]);return}try{ee(!0);let o=await l.h.get("/api/food-bank?q=".concat(encodeURIComponent(e))),t=await o.json();o.ok&&X(t.items||[])}catch(e){console.error("Erro ao buscar alimentos:",e)}finally{ee(!1)}}async function ea(e){var o,t,i,n,r,a,d;let s=prompt('Quantas unidades de "'.concat(e.name,'"?'),"1");if(!s)return;let c=Number(s);if(isNaN(c)||c<=0){alert("Quantidade inv\xe1lida! Digite um n\xfamero maior que zero.");return}try{await l.h.post("/api/food-bank/increment-usage",{id:e.id})}catch(e){console.error("Erro ao incrementar uso:",e)}let u=function(e){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,t=Math.pow(10,o);return Math.round(e*t)/t};H([...U,{name:e.name,quantity:c,unit:e.serving_size||"por\xe7\xe3o",calories:Math.round((null!==(o=e.calories)&&void 0!==o?o:0)*c),protein_g:u((null!==(t=e.protein)&&void 0!==t?t:0)*c),carbs_g:u((null!==(i=e.carbs)&&void 0!==i?i:0)*c),fat_g:u((null!==(n=e.fat)&&void 0!==n?n:0)*c),fiber_g:u((null!==(r=e.fiber)&&void 0!==r?r:0)*c),sodium_mg:Math.round((null!==(a=e.sodium)&&void 0!==a?a:0)*c),sugar_g:u((null!==(d=e.sugar)&&void 0!==d?d:0)*c),source:"bank"}]),K(""),X([]),J(!1)}function ed(){if(!eo.trim()){alert("Digite o nome do alimento!");return}H([...U,{name:eo.trim(),quantity:1,unit:"por\xe7\xe3o",source:"new"}]),et(""),V(!1)}async function el(){if(!b){W("Selecione uma foto para analisar!");return}v(!0),W(null);try{let e=new FormData;e.append("image",b),e.append("context",JSON.stringify({location_type:I,restaurant_name:"out"===I?null==O?void 0:O.name:void 0}));let o=await (0,l.x)("/api/meals/analyze-image",{method:"POST",body:e}),t=await o.json();if(!o.ok){if(403===o.status){h(!0);return}throw Error(t.error||"Erro ao analisar foto")}k(t.result)}catch(e){W(e instanceof Error?e.message:"Erro ao analisar foto")}finally{v(!1)}}async function es(){if(0===U.length){W("Adicione pelo menos um alimento para analisar!");return}v(!0),W(null);try{let e;let o={foods:U.map(e=>({name:e.name,quantity:e.quantity,unit:e.unit,calories:e.calories,protein_g:e.protein_g,carbs_g:e.carbs_g,fat_g:e.fat_g,fiber_g:e.fiber_g,sodium_mg:e.sodium_mg,sugar_g:e.sugar_g})),location_type:I,restaurant_name:"out"===I?null==O?void 0:O.name:void 0};if(b){let t=new FormData;t.append("image",b),t.append("data",JSON.stringify(o)),e=await (0,l.x)("/api/meals/analyze-meal",{method:"POST",body:t})}else e=await l.h.post("/api/meals/analyze-meal",o);let t=await e.json();if(!e.ok){if(403===e.status){h(!0);return}throw Error(t.error||"Erro ao analisar")}k(t.result)}catch(e){W(e.message)}finally{v(!1)}}async function ec(){if(S){if(!j){W("Por favor, selecione o tipo de refei\xe7\xe3o");return}v(!0),W(null),E(!1);try{let e;let o={meal_type:j,consumed_at:_+":00-03:00",notes:C||S.notes||"",foods:(S.foods||[]).map(e=>({name:e.name,quantity:Number(e.quantity)||1,unit:e.unit||"un",calories:e.calories,protein_g:e.protein_g,carbs_g:e.carbs_g,fat_g:e.fat_g,fiber_g:e.fiber_g,sodium_mg:e.sodium_mg,sugar_g:e.sugar_g}))};if(o.location_type=I,"out"===I){if(!(null==O?void 0:O.id))throw Error("Selecione um restaurante para refei\xe7\xf5es fora de casa");o.restaurant_id=O.id}else o.restaurant_id=null;if(b){let t=new FormData;t.append("image",b),t.append("payload",JSON.stringify(o)),e=await (0,l.x)("/api/meals/approve",{method:"POST",body:t})}else e=await l.h.post("/api/meals/approve",o);let t=await e.json();if(!e.ok)throw Error(t.error||"Erro ao salvar");E(!0),f(null),x(null),H([]),k(null),R(""),z(s()),N("home"),P(null),M(""),L([])}catch(e){W(e.message)}finally{v(!1)}}}let eu=(null==S?void 0:null===(e=S.foods)||void 0===e?void 0:e.reduce((e,o)=>e+(o.calories||0),0))||0;return(0,i.jsxs)("div",{style:{maxWidth:800,margin:"0 auto",padding:24},children:[(0,i.jsx)("h1",{style:{fontSize:28,fontWeight:700,marginBottom:24},children:"Capturar Refei\xe7\xe3o"}),(0,i.jsx)(d.x5,{isOpen:p,onClose:()=>h(!1),feature:"photo_analysis",currentPlan:t}),g&&c&&(0,i.jsx)(d.Lw,{quotaType:"photo",used:c.photo_analyses.used,limit:c.photo_analyses.limit,percentage:c.photo_analyses.percentage,remaining:c.photo_analyses.remaining,resetDate:c.resetDate}),(0,i.jsx)("div",{style:{border:"2px dashed #d1d5db",borderRadius:16,padding:24,textAlign:"center",background:"#f9fafb",marginBottom:24,position:"relative"},children:m?(0,i.jsxs)("div",{children:[(0,i.jsx)("img",{src:m,alt:"Preview",style:{maxWidth:"100%",maxHeight:200,borderRadius:12,marginBottom:12}}),(0,i.jsxs)("div",{style:{display:"flex",gap:8,justifyContent:"center",flexWrap:"wrap"},children:[(0,i.jsx)("button",{onClick:()=>{f(null),x(null)},style:{padding:"8px 16px",background:"#ef4444",color:"white",border:"none",borderRadius:8,cursor:"pointer"},children:"Remover Foto"}),!S&&(0,i.jsx)("button",{onClick:el,disabled:y,style:{padding:"8px 16px",background:y?"#9ca3af":"#8b5cf6",color:"white",border:"none",borderRadius:8,cursor:y?"not-allowed":"pointer",fontWeight:600},children:y?"Analisando...":"Analisar Foto com IA"})]})]}):(0,i.jsxs)("label",{style:{cursor:"pointer"},children:[(0,i.jsx)("div",{style:{fontSize:40,marginBottom:8,color:"#2196F3"},children:"Foto"}),(0,i.jsx)("div",{style:{fontSize:14,color:"#666",marginBottom:12},children:"Adicionar foto da refei\xe7\xe3o (opcional)"}),(0,i.jsx)("input",{type:"file",accept:"image/*",onChange:en,style:{display:"none"}}),(0,i.jsx)("div",{style:{display:"inline-block",padding:"10px 20px",background:"#2196F3",color:"white",borderRadius:8,fontWeight:600,fontSize:14},children:"Selecionar Foto"})]})}),!S&&(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginBottom:24},children:[(0,i.jsx)("button",{onClick:()=>J(!0),style:{padding:16,background:"#10b981",color:"white",border:"none",borderRadius:12,fontSize:16,fontWeight:600,cursor:"pointer"},children:"Meus Alimentos"}),(0,i.jsx)("button",{onClick:()=>V(!0),style:{padding:16,background:"#3b82f6",color:"white",border:"none",borderRadius:12,fontSize:16,fontWeight:600,cursor:"pointer"},children:"Adicionar Novo"})]}),!S&&U.length>0&&(0,i.jsxs)("div",{style:{background:"#f0fdf4",border:"2px solid #10b981",borderRadius:16,padding:24,marginBottom:24},children:[(0,i.jsxs)("h3",{style:{fontSize:18,fontWeight:600,marginBottom:16,color:"#065f46"},children:["Alimentos Adicionados (",U.length,")"]}),(0,i.jsx)("div",{style:{display:"grid",gap:12,marginBottom:16},children:U.map((e,o)=>(0,i.jsxs)("div",{style:{padding:12,background:"white",borderRadius:8,border:"1px solid #e5e7eb",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{style:{fontWeight:600},children:e.name}),(0,i.jsxs)("div",{style:{fontSize:12,color:"#6b7280"},children:[e.quantity," ",e.unit,"bank"===e.source&&(0,i.jsx)("span",{children:" • Do banco"}),"new"===e.source&&(0,i.jsx)("span",{children:" • Novo"})]})]}),(0,i.jsx)("button",{onClick:()=>(function(e){let o=[...U];o.splice(e,1),H(o)})(o),style:{padding:"6px",background:"#fee2e2",color:"#dc2626",border:"none",borderRadius:6,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},title:"Remover",children:(0,i.jsx)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:(0,i.jsx)("path",{d:"M3 6h18M8 6V4a2 2 0 012-2h4a2 2 0 012 2v2m3 0v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6h14M10 11v6M14 11v6"})})})]},o))}),(0,i.jsx)("button",{onClick:es,disabled:y,style:{width:"100%",padding:16,background:y?"#9ca3af":"#8b5cf6",color:"white",border:"none",borderRadius:12,fontSize:16,fontWeight:600,cursor:y?"not-allowed":"pointer"},children:y?"Analisando com IA...":"Analisar com IA"})]}),B&&(0,i.jsx)("div",{style:{padding:16,background:"#fee2e2",border:"2px solid #ef4444",borderRadius:12,color:"#991b1b",marginBottom:24},children:B}),A&&(0,i.jsx)("div",{style:{padding:16,background:"#d1fae5",border:"2px solid #10b981",borderRadius:12,color:"#065f46",marginBottom:24},children:"Refei\xe7\xe3o salva com sucesso!"}),S&&(0,i.jsxs)("div",{style:{marginBottom:32},children:[(0,i.jsxs)("div",{style:{background:"white",border:"2px solid #e5e7eb",borderRadius:16,padding:24,marginBottom:24},children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[(0,i.jsx)("h2",{style:{fontSize:20,fontWeight:700},children:"An\xe1lise da Refei\xe7\xe3o"}),(0,i.jsxs)("div",{style:{padding:"8px 16px",background:"#dbeafe",color:"#1e40af",borderRadius:20,fontWeight:600},children:[eu," kcal"]})]}),S.notes&&(0,i.jsx)("p",{style:{color:"#666",fontSize:14,marginBottom:16,fontStyle:"italic"},children:S.notes}),(0,i.jsx)("div",{style:{display:"grid",gap:12},children:null===(o=S.foods)||void 0===o?void 0:o.map((e,o)=>(0,i.jsxs)("div",{style:{padding:16,background:"#f9fafb",borderRadius:12,border:"1px solid #e5e7eb"},children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:12,alignItems:"center"},children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,i.jsx)("span",{style:{fontWeight:600,fontSize:16},children:e.name}),"taco"===e.source&&(0,i.jsx)("span",{style:{fontSize:10,padding:"2px 6px",background:"#10b981",color:"white",borderRadius:4,fontWeight:600},children:"TACO"}),"bank"===e.source&&(0,i.jsx)("span",{style:{fontSize:10,padding:"2px 6px",background:"#3b82f6",color:"white",borderRadius:4,fontWeight:600},children:"MEUS ALIMENTOS"}),!e.source&&(0,i.jsx)("span",{style:{fontSize:10,padding:"2px 6px",background:"#f59e0b",color:"white",borderRadius:4,fontWeight:600},children:"IA"})]}),(0,i.jsxs)("span",{style:{color:"#666"},children:[e.quantity," ",e.unit]})]}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(120px, 1fr))",gap:8},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{fontSize:12,color:"#666",display:"block",marginBottom:4},children:"Calorias (kcal)"}),(0,i.jsx)("input",{type:"number",value:e.calories||"",onChange:e=>{let t=[...S.foods];t[o].calories=Number(e.target.value)||void 0,k({...S,foods:t})},style:{width:"100%",padding:"6px 8px",fontSize:14,border:"1px solid #d1d5db",borderRadius:6,outline:"none",boxSizing:"border-box"},placeholder:"0"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{fontSize:12,color:"#666",display:"block",marginBottom:4},children:"Prote\xedna (g)"}),(0,i.jsx)("input",{type:"number",step:"0.1",value:e.protein_g||"",onChange:e=>{let t=[...S.foods];t[o].protein_g=Number(e.target.value)||void 0,k({...S,foods:t})},style:{width:"100%",padding:"6px 8px",fontSize:14,border:"1px solid #d1d5db",borderRadius:6,outline:"none",boxSizing:"border-box"},placeholder:"0"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{fontSize:12,color:"#666",display:"block",marginBottom:4},children:"Carboidrato (g)"}),(0,i.jsx)("input",{type:"number",step:"0.1",value:e.carbs_g||"",onChange:e=>{let t=[...S.foods];t[o].carbs_g=Number(e.target.value)||void 0,k({...S,foods:t})},style:{width:"100%",padding:"6px 8px",fontSize:14,border:"1px solid #d1d5db",borderRadius:6,outline:"none",boxSizing:"border-box"},placeholder:"0"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{fontSize:12,color:"#666",display:"block",marginBottom:4},children:"Gordura (g)"}),(0,i.jsx)("input",{type:"number",step:"0.1",value:e.fat_g||"",onChange:e=>{let t=[...S.foods];t[o].fat_g=Number(e.target.value)||void 0,k({...S,foods:t})},style:{width:"100%",padding:"6px 8px",fontSize:14,border:"1px solid #d1d5db",borderRadius:6,outline:"none",boxSizing:"border-box"},placeholder:"0"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{fontSize:12,color:"#666",display:"block",marginBottom:4},children:"Fibras (g)"}),(0,i.jsx)("input",{type:"number",step:"0.1",value:e.fiber_g||"",onChange:e=>{let t=[...S.foods];t[o].fiber_g=Number(e.target.value)||void 0,k({...S,foods:t})},style:{width:"100%",padding:"6px 8px",fontSize:14,border:"1px solid #d1d5db",borderRadius:6,outline:"none",boxSizing:"border-box"},placeholder:"0"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{fontSize:12,color:"#666",display:"block",marginBottom:4},children:"S\xf3dio (mg)"}),(0,i.jsx)("input",{type:"number",step:"1",value:e.sodium_mg||"",onChange:e=>{let t=[...S.foods];t[o].sodium_mg=Number(e.target.value)||void 0,k({...S,foods:t})},style:{width:"100%",padding:"6px 8px",fontSize:14,border:"1px solid #d1d5db",borderRadius:6,outline:"none",boxSizing:"border-box"},placeholder:"0"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{fontSize:12,color:"#666",display:"block",marginBottom:4},children:"A\xe7\xfacar (g)"}),(0,i.jsx)("input",{type:"number",step:"0.1",value:e.sugar_g||"",onChange:e=>{let t=[...S.foods];t[o].sugar_g=Number(e.target.value)||void 0,k({...S,foods:t})},style:{width:"100%",padding:"6px 8px",fontSize:14,border:"1px solid #d1d5db",borderRadius:6,outline:"none",boxSizing:"border-box"},placeholder:"0"})]})]})]},o))})]}),(0,i.jsxs)("div",{style:{display:"grid",gap:16},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:8,fontWeight:600},children:"Tipo de Refei\xe7\xe3o *"}),(0,i.jsxs)("select",{value:j,onChange:e=>w(e.target.value),style:{width:"100%",padding:12,fontSize:16,border:j?"2px solid #e5e7eb":"2px solid #ef4444",borderRadius:8,backgroundColor:"white",boxSizing:"border-box"},children:[(0,i.jsx)("option",{value:"",children:"Selecione o tipo..."}),(0,i.jsx)("option",{value:"breakfast",children:"Caf\xe9 da Manh\xe3"}),(0,i.jsx)("option",{value:"lunch",children:"Almo\xe7o"}),(0,i.jsx)("option",{value:"dinner",children:"Jantar"}),(0,i.jsx)("option",{value:"snack",children:"Lanche"})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:8,fontWeight:600},children:"Quando foi consumido?"}),(0,i.jsx)("input",{type:"datetime-local",value:_,onChange:e=>z(e.target.value),style:{width:"100%",padding:12,fontSize:16,border:"2px solid #e5e7eb",borderRadius:8,boxSizing:"border-box"}})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:8,fontWeight:600},children:"Observa\xe7\xf5es (opcional)"}),(0,i.jsx)("input",{type:"text",value:C,onChange:e=>R(e.target.value),placeholder:"Ex: Comi tudo, estava delicioso!",style:{width:"100%",padding:12,fontSize:16,border:"2px solid #e5e7eb",borderRadius:8,boxSizing:"border-box"}})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:8,fontWeight:600},children:"Local da Refei\xe7\xe3o"}),(0,i.jsxs)("div",{style:{display:"flex",gap:8,marginBottom:8},children:[(0,i.jsx)("button",{type:"button",onClick:()=>{N("home"),P(null)},style:{flex:1,padding:10,borderRadius:8,border:"home"===I?"2px solid #10b981":"2px solid #e5e7eb",background:"home"===I?"#ecfdf5":"white",fontWeight:600,color:"home"===I?"#065f46":"#374151"},children:"Casa"}),(0,i.jsx)("button",{type:"button",onClick:()=>N("out"),style:{flex:1,padding:10,borderRadius:8,border:"out"===I?"2px solid #f59e0b":"2px solid #e5e7eb",background:"out"===I?"#fffbeb":"white",fontWeight:600,color:"out"===I?"#92400e":"#374151"},children:"Fora"})]}),"out"===I&&(0,i.jsxs)("div",{style:{position:"relative"},children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:6,fontWeight:500,color:"#92400e"},children:"Restaurante (obrigat\xf3rio)"}),(0,i.jsx)("input",{type:"text",value:F,onChange:async e=>{let o=e.target.value;if(M(o),O&&P(null),o.trim().length<2){L([]);return}try{q(!0);let e=await l.h.get("/api/restaurants/search?q=".concat(encodeURIComponent(o))),t=await e.json();e.ok&&L(t.restaurants||[])}finally{q(!1)}},placeholder:"Digite o nome do restaurante...",style:{width:"100%",padding:12,fontSize:16,border:"2px solid #fbbf24",borderRadius:O?"8px":"8px 8px 0 0",outline:"none",boxSizing:"border-box"}}),!O&&(T||D.length>0||F.trim().length>=2&&0===D.length)&&(0,i.jsxs)("div",{style:{position:"absolute",top:"100%",left:0,right:0,background:"white",border:"1px solid #e5e7eb",borderTop:"none",borderRadius:"0 0 8px 8px",maxHeight:200,overflowY:"auto",zIndex:10},children:[T&&(0,i.jsx)("div",{style:{padding:10,fontSize:14,color:"#6b7280"},children:"Carregando..."}),!T&&D.map(e=>(0,i.jsxs)("button",{type:"button",onClick:()=>{P({id:e.id,name:e.name}),M(e.name),L([])},style:{width:"100%",textAlign:"left",padding:"10px 12px",border:"none",background:"white",cursor:"pointer",borderBottom:"1px solid #f3f4f6"},children:[(0,i.jsx)("div",{style:{fontWeight:600},children:e.name}),e.address&&(0,i.jsx)("div",{style:{fontSize:12,color:"#6b7280"},children:e.address})]},e.id)),!T&&0===D.length&&F.trim().length>=2&&(0,i.jsxs)("div",{style:{padding:10},children:[(0,i.jsx)("div",{style:{fontSize:14,color:"#6b7280",marginBottom:8},children:"Nenhum restaurante encontrado."}),(0,i.jsxs)("button",{type:"button",onClick:async()=>{if(F.trim()&&confirm('Cadastrar o restaurante "'.concat(F.trim(),'"?')))try{q(!0);let e=await l.h.post("/api/restaurants",{name:F.trim()}),o=await e.json();if(e.ok){let e=o.restaurant.name;P({id:o.restaurant.id,name:e}),M(e),L([])}else alert(o.error||"Erro ao cadastrar restaurante")}catch(e){alert("Erro ao cadastrar restaurante: "+e.message)}finally{q(!1)}},style:{width:"100%",padding:"10px 12px",background:"#10b981",color:"white",border:"none",borderRadius:6,fontWeight:700,cursor:"pointer"},children:['Cadastrar "',F.trim(),'"']})]})]}),O&&(0,i.jsxs)("div",{style:{marginTop:8,fontSize:13,color:"#92400e"},children:["Selecionado: ",(0,i.jsx)("strong",{children:O.name})]})]})]}),(0,i.jsx)("button",{onClick:ec,disabled:y,style:{width:"100%",padding:16,background:"#2196F3",color:"white",border:"none",borderRadius:12,fontSize:16,fontWeight:600,cursor:y?"not-allowed":"pointer",opacity:y?.6:1},children:y?"Salvando...":"Salvar Refei\xe7\xe3o"})]})]}),Q&&(0,i.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:50,padding:20},children:(0,i.jsxs)("div",{style:{background:"white",borderRadius:16,padding:24,maxWidth:500,width:"100%",maxHeight:"80vh",overflowY:"auto"},children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[(0,i.jsx)("h2",{style:{fontSize:20,fontWeight:700},children:"Meus Alimentos"}),(0,i.jsx)("button",{onClick:()=>{J(!1),K(""),X([])},style:{padding:8,background:"#f3f4f6",border:"none",borderRadius:8,cursor:"pointer",color:"#6b7280",display:"flex",alignItems:"center",justifyContent:"center"},title:"Fechar",children:(0,i.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:(0,i.jsx)("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),(0,i.jsx)("input",{type:"text",value:G,onChange:e=>{K(e.target.value),er(e.target.value)},placeholder:"Buscar alimento...",style:{width:"100%",padding:12,fontSize:16,border:"2px solid #10b981",borderRadius:8,outline:"none",marginBottom:16,boxSizing:"border-box"}}),$&&(0,i.jsx)("div",{style:{textAlign:"center",color:"#6b7280"},children:"Buscando..."}),!$&&Z.length>0&&(0,i.jsx)("div",{style:{display:"grid",gap:8},children:Z.map(e=>(0,i.jsxs)("button",{onClick:()=>ea(e),style:{width:"100%",textAlign:"left",padding:12,background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:8,cursor:"pointer"},children:[(0,i.jsxs)("div",{style:{fontWeight:600,marginBottom:4},children:[e.name,e.brand&&(0,i.jsxs)("span",{style:{color:"#6b7280",fontWeight:400},children:[" - ",e.brand]})]}),(0,i.jsxs)("div",{style:{fontSize:12,color:"#6b7280"},children:[e.serving_size&&(0,i.jsxs)("span",{children:["Por\xe7\xe3o: ",e.serving_size," | "]}),e.calories&&(0,i.jsxs)("span",{children:[e.calories," kcal"]})]})]},e.id))}),!$&&G.length>=2&&0===Z.length&&(0,i.jsxs)("div",{style:{textAlign:"center",color:"#dc2626",padding:16},children:["Nenhum alimento encontrado. ",(0,i.jsx)("a",{href:"/meus-alimentos",style:{color:"#2196F3",textDecoration:"underline"},children:"Cadastre aqui"})]})]})}),Y&&(0,i.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:50,padding:20},children:(0,i.jsxs)("div",{style:{background:"white",borderRadius:16,padding:24,maxWidth:400,width:"100%"},children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[(0,i.jsx)("h2",{style:{fontSize:20,fontWeight:700},children:"Adicionar Novo Alimento"}),(0,i.jsx)("button",{onClick:()=>{V(!1),et("")},style:{padding:8,background:"#f3f4f6",border:"none",borderRadius:8,cursor:"pointer",color:"#6b7280",display:"flex",alignItems:"center",justifyContent:"center"},title:"Fechar",children:(0,i.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:(0,i.jsx)("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),(0,i.jsx)("input",{type:"text",value:eo,onChange:e=>et(e.target.value),placeholder:"Ex: Bife de frango grelhado",style:{width:"100%",padding:12,fontSize:16,border:"2px solid #3b82f6",borderRadius:8,outline:"none",marginBottom:16,boxSizing:"border-box"},onKeyDown:e=>{"Enter"===e.key&&ed()},autoFocus:!0}),(0,i.jsx)("button",{onClick:ed,style:{width:"100%",padding:12,background:"#3b82f6",color:"white",border:"none",borderRadius:8,fontSize:16,fontWeight:600,cursor:"pointer"},children:"Adicionar"})]})})]})}},5682:function(e,o,t){"use strict";function i(e,o){return{canUseFeature:t=>"free"!==e&&("unlimited"===e||!!o&&("photo"===t?o.photo_analyses:o.ocr_analyses).remaining>0),getQuotaInfo:t=>{if("free"===e)return{used:0,limit:0,remaining:0,percentage:0,canUse:!1};if("unlimited"===e)return{used:o?"photo"===t?o.photo_analyses.used:o.ocr_analyses.used:0,limit:999999,remaining:999999,percentage:0,canUse:!0};if(!o)return{used:0,limit:0,remaining:0,percentage:0,canUse:!1};let i="photo"===t?o.photo_analyses:o.ocr_analyses;return{used:i.used,limit:i.limit,remaining:i.remaining,percentage:i.percentage,canUse:i.remaining>0}},hasQuota:"premium"===e&&null!==o}}t.d(o,{f:function(){return i}})}},function(e){e.O(0,[187,78,971,23,744],function(){return e(e.s=7372)}),_N_E=e.O()}]);