(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[205],{3790:function(e,t,i){Promise.resolve().then(i.bind(i,79270))},79270:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return l}});var o=i(57437),n=i(2265),r=i(16463),a=i(45591),s=i(86394);function l(){let e=(0,r.useRouter)(),{plan:t}=(0,s.R)(),[l,d]=(0,n.useState)([]),[c,u]=(0,n.useState)(null),[p,h]=(0,n.useState)([]),[g,x]=(0,n.useState)(!0),[f,b]=(0,n.useState)(null),[y,m]=(0,n.useState)(!1),[j,v]=(0,n.useState)(!1),[S,k]=(0,n.useState)(""),[w,z]=(0,n.useState)(""),[C,_]=(0,n.useState)("1"),[R,W]=(0,n.useState)(""),[B,E]=(0,n.useState)([]),[I,F]=(0,n.useState)(!1),[N,D]=(0,n.useState)(!1),[L,A]=(0,n.useState)(!1),[P,T]=(0,n.useState)(null),[M,q]=(0,n.useState)(""),[V,U]=(0,n.useState)([]),[O,H]=(0,n.useState)(!1),[$,Q]=(0,n.useState)(""),[J,G]=(0,n.useState)(!1),[X,Y]=(0,n.useState)(""),[K,Z]=(0,n.useState)(!1),[ee,et]=(0,n.useState)(!1),[ei,eo]=(0,n.useState)(!1),[en,er]=(0,n.useState)(""),[ea,es]=(0,n.useState)(1),[el,ed]=(0,n.useState)(""),[ec,eu]=(0,n.useState)(!1),[ep,eh]=(0,n.useState)(!1),[eg,ex]=(0,n.useState)(null),[ef,eb]=(0,n.useState)(""),[ey,em]=(0,n.useState)(""),[ej,ev]=(0,n.useState)(!1),[eS,ek]=(0,n.useState)(""),[ew,ez]=(0,n.useState)(!1),[eC,e_]=(0,n.useState)(null),[eR,eW]=(0,n.useState)(""),[eB,eE]=(0,n.useState)(""),[eI,eF]=(0,n.useState)(""),[eN,eD]=(0,n.useState)(""),[eL,eA]=(0,n.useState)("");async function eP(){try{let e=await a.h.get("/api/stores"),t=await e.json();e.ok&&U(t.stores||[])}catch(e){console.error("Erro ao buscar lojas:",e)}}async function eT(){try{x(!0);let e=await a.h.get("/api/shopping-lists"),t=await e.json();e.ok&&d(t.lists||[])}catch(e){console.error("Erro ao buscar listas:",e)}finally{x(!1)}}async function eM(e){try{let t=await a.h.get("/api/shopping-lists/".concat(e)),i=await t.json();t.ok&&(u(i.list),h(i.items||[]))}catch(e){console.error("Erro ao buscar detalhes:",e)}}async function eq(e){if(e.preventDefault(),S.trim())try{let e=await a.h.post("/api/shopping-lists",{name:S}),t=await e.json();e.ok?(m(!1),k(""),await eT(),t.list&&eM(t.list.id)):b(t.error||"Erro ao criar lista")}catch(e){b(e.message)}}async function eV(e){if(e.preventDefault(),c&&w.trim())try{(await a.h.post("/api/shopping-lists/items",{list_id:c.id,name:w,quantity:parseFloat(C)||1,unit:R||void 0})).ok&&(v(!1),z(""),_("1"),W(""),await eM(c.id))}catch(e){console.error("Erro ao adicionar item:",e)}}async function eU(e){try{let t=!e.is_purchased,i={is_purchased:t};t||(i.price=null,i.unitPrice=null),await a.h.patch("/api/shopping-lists/items?id=".concat(e.id),i),c&&await eM(c.id)}catch(e){console.error("Erro ao atualizar item:",e)}}async function eO(e,t){try{await a.h.patch("/api/shopping-lists/items?id=".concat(e),{price:t}),c&&await eM(c.id)}catch(e){console.error("Erro ao atualizar pre\xe7o:",e)}}async function eH(e,t){try{await a.h.patch("/api/shopping-lists/items?id=".concat(e),t),c&&await eM(c.id)}catch(e){console.error("Erro ao atualizar item:",e)}}async function e$(e,t,i){let o={},n=t=>(function(e,t){let i=(t||"un").toLowerCase();return"g"===i||"ml"===i?e/1e3:e})(t,e.unit);if("quantity"===t){o.quantity=i;let t=n(i);e.unit_price?o.price=Number((t*e.unit_price).toFixed(2)):e.price&&t>0&&(o.unit_price=Number((e.price/t).toFixed(2)))}else if("unit_price"===t){o.unit_price=i;let t=n(e.quantity);t>0&&(o.price=Number((t*i).toFixed(2)))}else if("price"===t){o.price=i;let t=n(e.quantity);t>0&&(o.unit_price=Number((i/t).toFixed(2)))}h(t=>t.map(t=>t.id===e.id?{...t,...o}:t));try{let t={...o};void 0!==o.unit_price&&(t.unitPrice=o.unit_price,delete t.unit_price),await a.h.patch("/api/shopping-lists/items?id=".concat(e.id),t)}catch(e){console.error("Erro ao atualizar item:",e),await eM(c.id)}}async function eQ(e){if(confirm("Remover este item?"))try{await a.h.delete("/api/shopping-lists/items?id=".concat(e)),c&&await eM(c.id)}catch(e){console.error("Erro ao remover item:",e)}}function eJ(e){e_(e),eW(e.name),eE(String(e.quantity)),eF(e.unit||""),eD(e.unit_price?String(e.unit_price):""),eA(e.price?String(e.price):""),ez(!0)}async function eG(){if(eC&&eR.trim())try{let e={name:eR.trim(),quantity:parseFloat(eB)||1,unit:eI||null};eN&&(e.unitPrice=parseFloat(eN)),eL&&(e.price=parseFloat(eL)),await a.h.patch("/api/shopping-lists/items?id=".concat(eC.id),e),ez(!1),e_(null),c&&await eM(c.id)}catch(e){console.error("Erro ao salvar item:",e)}}async function eX(e){if(confirm("Excluir esta lista?"))try{await a.h.delete("/api/shopping-lists/".concat(e)),u(null),h([]),Z(!1),et(!1),await eT()}catch(e){console.error("Erro ao excluir lista:",e)}}async function eY(){if(!c)return;let e=e9.length>0;if(1===ea&&e){let e=new Date().toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit"});ed("Pendentes ".concat(c.name," - ").concat(e)),es(2);return}try{let t=$||null;if(J&&X.trim()){let e=await a.h.post("/api/stores",{name:X.trim()}),i=await e.json();e.ok&&i.store&&(t=i.store.id,await eP())}let i=await a.h.post("/api/shopping-lists/complete",{list_id:c.id,store_id:t,new_list_name:e?el:void 0}),o=await i.json();if(!i.ok)throw Error(o.error||"Erro ao finalizar lista");H(!1),u(null),h([]),await eT(),o.new_list&&eM(o.new_list.id)}catch(e){console.error("Erro ao finalizar lista:",e)}}function eK(e){Z(!0),et(!1),er(e.store_id||""),eM(e.id)}async function eZ(){if(c)try{await a.h.patch("/api/shopping-lists/".concat(c.id),{store_id:en||null}),et(!1),await eT(),await eM(c.id)}catch(e){console.error("Erro ao salvar edicoes:",e)}}async function e0(){try{D(!0);let e=await a.h.get("/api/shopping-lists/suggestions"),t=await e.json();e.ok&&(E(t.suggestions||[]),F(!0))}catch(e){console.error("Erro ao buscar sugest\xf5es:",e)}finally{D(!1)}}async function e1(e){if(c)try{await a.h.post("/api/shopping-lists/items",{list_id:c.id,name:e.food_name.charAt(0).toUpperCase()+e.food_name.slice(1),quantity:Math.round(e.avg_quantity)||1,unit:e.common_unit||void 0}),E(t=>t.filter(t=>t.food_name!==e.food_name)),await eM(c.id)}catch(e){console.error("Erro ao adicionar sugest\xe3o:",e)}}function e2(e){T(e),q("C\xf3pia de ".concat(e.name)),A(!0)}async function e6(e){if(e.preventDefault(),P&&M.trim())try{let e=await a.h.post("/api/shopping-lists/duplicate",{source_list_id:P.id,name:M}),t=await e.json();e.ok?(A(!1),T(null),q(""),await eT(),t.list&&eM(t.list.id)):b(t.error||"Erro ao duplicar lista")}catch(e){b(e.message)}}function e4(e){return new Date(e).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit"})}async function e8(e){var t,o,n;e.preventDefault();let r=e.target.querySelector('input[type="file"]'),s=null==r?void 0:null===(t=r.files)||void 0===t?void 0:t[0];if(!s){ex("Selecione uma imagem da nota fiscal");return}eh(!0),ex(null);try{let e=ey||null;if(ej&&eS.trim()){let t=await a.h.post("/api/stores",{name:eS.trim()}),i=await t.json();t.ok&&i.store&&(e=i.store.id,await eP())}let t=new FormData;t.append("image",s),t.append("name",ef||"Compras ".concat(new Date().toLocaleDateString("pt-BR"))),e&&t.append("store_id",e);let r=await fetch("/api/shopping-lists/scan-receipt",{method:"POST",body:t}),l=await r.json();if(!r.ok){if(403===r.status&&(null==l?void 0:l.error)==="watch_ad_required"){let{showRewardedAd:e}=await i.e(398).then(i.bind(i,68398));if(!await e("scan_receipt"))throw Error("An\xfancio indispon\xedvel. Tente novamente.");let o=await fetch("/api/shopping-lists/scan-receipt",{method:"POST",body:t,headers:{"x-ad-completed":"1"}}),r=await o.json();if(!o.ok)throw Error(r.error||"Erro ao analisar nota");eu(!1),await eT(),(null===(n=r.list)||void 0===n?void 0:n.id)&&eK({id:r.list.id,name:r.list.name});return}throw Error(l.error||"Erro ao analisar nota")}eu(!1),await eT(),(null===(o=l.list)||void 0===o?void 0:o.id)&&eK({id:l.list.id,name:l.list.name})}catch(e){ex(e.message||"Erro ao processar nota fiscal")}finally{eh(!1)}}(0,n.useEffect)(()=>{eT(),eP()},[]);let e5=l.filter(e=>"active"===e.status),e3=l.filter(e=>"completed"===e.status),e7=ei?e3:e3.slice(0,5),e9=p.filter(e=>!e.is_purchased),te=p.filter(e=>e.is_purchased),tt=te.reduce((e,t)=>e+(Number(t.price)||0),0);function ti(e){return e.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})}return c&&K?(0,o.jsxs)("div",{style:{maxWidth:800,margin:"0 auto",padding:24},children:[(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:24},children:[(0,o.jsx)("button",{onClick:function(){u(null),h([]),Z(!1),et(!1)},style:{padding:"8px 16px",background:"#f3f4f6",border:"none",borderRadius:8,cursor:"pointer",fontSize:14,fontWeight:600},children:"Voltar"}),(0,o.jsx)("h1",{style:{fontSize:24,fontWeight:700,flex:1},children:c.name}),(0,o.jsx)("button",{onClick:()=>eX(c.id),style:{padding:"8px 10px",background:"#fee2e2",border:"1px solid #fca5a5",borderRadius:8,cursor:"pointer",color:"#dc2626",display:"flex",alignItems:"center",justifyContent:"center"},title:"Excluir lista",children:(0,o.jsx)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:(0,o.jsx)("path",{d:"M3 6h18M8 6V4a2 2 0 012-2h4a2 2 0 012 2v2m3 0v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6h14M10 11v6M14 11v6"})})})]}),(0,o.jsxs)("div",{style:{padding:16,background:"#f0fdf4",borderRadius:12,marginBottom:24},children:[(0,o.jsxs)("div",{style:{fontSize:14,color:"#166534",marginBottom:8},children:["Finalizada em ",e4(c.completed_at||c.updated_at)]}),ee?(0,o.jsxs)("div",{style:{marginTop:12},children:[(0,o.jsx)("label",{style:{display:"block",fontSize:14,fontWeight:600,marginBottom:8},children:"Loja"}),(0,o.jsxs)("select",{value:en,onChange:e=>er(e.target.value),style:{width:"100%",padding:10,fontSize:14,border:"2px solid #e5e7eb",borderRadius:8,background:"white",boxSizing:"border-box"},children:[(0,o.jsx)("option",{value:"",children:"Sem loja"}),V.map(e=>(0,o.jsx)("option",{value:e.id,children:e.name},e.id))]})]}):c.store_name&&(0,o.jsxs)("div",{style:{fontSize:14,color:"#166534"},children:["Loja: ",(0,o.jsx)("strong",{children:c.store_name})]})]}),(0,o.jsx)("div",{style:{display:"flex",gap:12,marginBottom:24},children:ee?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("button",{onClick:eZ,style:{padding:"12px 24px",background:"#10b981",color:"white",border:"none",borderRadius:8,cursor:"pointer",fontSize:14,fontWeight:600},children:"Salvar"}),(0,o.jsx)("button",{onClick:()=>et(!1),style:{padding:"12px 24px",background:"#f3f4f6",border:"none",borderRadius:8,cursor:"pointer",fontSize:14,fontWeight:600},children:"Cancelar"})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("button",{onClick:function(){et(!0)},style:{padding:"12px 24px",background:"#f59e0b",color:"white",border:"none",borderRadius:8,cursor:"pointer",fontSize:14,fontWeight:600},children:"Editar"}),(0,o.jsx)("button",{onClick:()=>e2(c),style:{padding:"12px 24px",background:"#2196F3",color:"white",border:"none",borderRadius:8,cursor:"pointer",fontSize:14,fontWeight:600},children:"Duplicar"})]})}),(0,o.jsxs)("div",{style:{marginBottom:24},children:[(0,o.jsxs)("h2",{style:{fontSize:16,fontWeight:600,color:"#6b7280",marginBottom:12},children:["ITENS (",p.length,")"]}),(0,o.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:8},children:p.map(e=>(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12,padding:12,background:"#f0fdf4",borderRadius:12},children:[(0,o.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,o.jsx)("div",{style:{fontWeight:600,fontSize:15,color:"#374151"},children:e.name}),(0,o.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",alignItems:"center",gap:8,marginTop:6},children:[(0,o.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:2},children:[(0,o.jsx)("label",{style:{fontSize:10,color:"#9ca3af"},children:"Qtd"}),(0,o.jsx)("div",{style:{width:60,padding:"6px",fontSize:13,background:"white",border:"1px solid #d1d5db",borderRadius:6,textAlign:"center"},children:e.quantity})]}),(0,o.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:2},children:[(0,o.jsx)("label",{style:{fontSize:10,color:"#9ca3af"},children:"Unid"}),(0,o.jsx)("div",{style:{width:50,padding:"6px",fontSize:13,background:"white",border:"1px solid #d1d5db",borderRadius:6,textAlign:"center"},children:e.unit||"un"})]}),(0,o.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:2},children:[(0,o.jsx)("label",{style:{fontSize:10,color:"#9ca3af"},children:"R$ Unit."}),ee?(0,o.jsx)("input",{type:"number",step:"0.01",min:"0",placeholder:"0,00",defaultValue:e.unit_price?Number(e.unit_price).toFixed(2):"",onBlur:t=>{let i=t.target.value?parseFloat(t.target.value):null;eH(e.id,{unitPrice:i})},style:{width:70,padding:"6px",fontSize:13,border:"1px solid #d1d5db",borderRadius:6,textAlign:"right"}}):(0,o.jsx)("div",{style:{width:70,padding:"6px",fontSize:13,background:"white",border:"1px solid #d1d5db",borderRadius:6,textAlign:"right"},children:e.unit_price?Number(e.unit_price).toFixed(2):"-"})]}),(0,o.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:2},children:[(0,o.jsx)("label",{style:{fontSize:10,color:"#166534",fontWeight:600},children:"R$ Total"}),ee?(0,o.jsx)("input",{type:"number",step:"0.01",min:"0",placeholder:"0,00",defaultValue:e.price?Number(e.price).toFixed(2):"",onBlur:t=>{let i=t.target.value?parseFloat(t.target.value):null;i!==e.price&&eO(e.id,i)},style:{width:80,padding:"6px",fontSize:13,border:"1px solid #10b981",borderRadius:6,textAlign:"right",fontWeight:600,color:"#166534"}}):(0,o.jsx)("div",{style:{width:80,padding:"6px",fontSize:13,background:"white",border:"1px solid #10b981",borderRadius:6,textAlign:"right",fontWeight:600,color:"#166534"},children:e.price?Number(e.price).toFixed(2):"-"})]})]})]}),(0,o.jsx)("button",{onClick:()=>eJ(e),style:{padding:"6px 10px",background:"#dbeafe",border:"1px solid #93c5fd",borderRadius:6,cursor:"pointer",color:"#1e40af",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},title:"Editar item",children:(0,o.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,o.jsx)("path",{d:"M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7"}),(0,o.jsx)("path",{d:"M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z"})]})})]},e.id))})]}),tt>0&&(0,o.jsxs)("div",{style:{padding:16,background:"#dcfce7",borderRadius:12,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,o.jsx)("span",{style:{fontWeight:600,color:"#166534",fontSize:18},children:"Total"}),(0,o.jsx)("span",{style:{fontWeight:700,fontSize:24,color:"#166534"},children:ti(tt)})]}),L&&P&&(0,o.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",padding:24,zIndex:1e3},children:(0,o.jsxs)("div",{style:{background:"white",borderRadius:16,padding:24,width:"100%",maxWidth:400},children:[(0,o.jsx)("h2",{style:{fontSize:20,fontWeight:700,marginBottom:16},children:"Duplicar Lista"}),(0,o.jsxs)("p",{style:{fontSize:14,color:"#6b7280",marginBottom:16},children:["Duplicando: ",(0,o.jsx)("strong",{children:P.name})]}),(0,o.jsxs)("form",{onSubmit:e6,children:[(0,o.jsxs)("div",{style:{marginBottom:16},children:[(0,o.jsx)("label",{style:{display:"block",marginBottom:8,fontWeight:600},children:"Nome da nova lista *"}),(0,o.jsx)("input",{type:"text",value:M,onChange:e=>q(e.target.value),placeholder:"Ex: Compras da semana",required:!0,style:{width:"100%",padding:12,fontSize:16,border:"2px solid #e5e7eb",borderRadius:8,boxSizing:"border-box"}})]}),(0,o.jsxs)("div",{style:{display:"flex",gap:12},children:[(0,o.jsx)("button",{type:"button",onClick:()=>{A(!1),T(null)},style:{flex:1,padding:12,background:"#f3f4f6",border:"none",borderRadius:8,cursor:"pointer",fontSize:16,fontWeight:600},children:"Cancelar"}),(0,o.jsx)("button",{type:"submit",style:{flex:1,padding:12,background:"#2196F3",color:"white",border:"none",borderRadius:8,cursor:"pointer",fontSize:16,fontWeight:600},children:"Duplicar"})]})]})]})}),ew&&eC&&(0,o.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",padding:24,zIndex:1e3},children:(0,o.jsxs)("div",{style:{background:"white",borderRadius:16,padding:24,width:"100%",maxWidth:400},children:[(0,o.jsx)("h2",{style:{fontSize:20,fontWeight:700,marginBottom:16},children:"Editar Item"}),(0,o.jsxs)("div",{style:{marginBottom:16},children:[(0,o.jsx)("label",{style:{display:"block",marginBottom:8,fontWeight:600},children:"Nome do item *"}),(0,o.jsx)("input",{type:"text",value:eR,onChange:e=>eW(e.target.value),placeholder:"Ex: Arroz integral",style:{width:"100%",padding:12,fontSize:16,border:"2px solid #e5e7eb",borderRadius:8,boxSizing:"border-box"}})]}),(0,o.jsxs)("div",{style:{display:"flex",gap:12,marginBottom:16},children:[(0,o.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,o.jsx)("label",{style:{display:"block",marginBottom:8,fontWeight:600},children:"Quantidade"}),(0,o.jsx)("input",{type:"number",step:"0.001",value:eB,onChange:e=>eE(e.target.value),style:{width:"100%",padding:12,fontSize:16,border:"2px solid #e5e7eb",borderRadius:8,boxSizing:"border-box"}})]}),(0,o.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,o.jsx)("label",{style:{display:"block",marginBottom:8,fontWeight:600},children:"Unidade"}),(0,o.jsx)("input",{type:"text",value:eI,onChange:e=>eF(e.target.value),placeholder:"kg, g, un, L...",style:{width:"100%",padding:12,fontSize:16,border:"2px solid #e5e7eb",borderRadius:8,boxSizing:"border-box"}})]})]}),(0,o.jsxs)("div",{style:{display:"flex",gap:12,marginBottom:16},children:[(0,o.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,o.jsx)("label",{style:{display:"block",marginBottom:8,fontWeight:600},children:"R$ Unit\xe1rio"}),(0,o.jsx)("input",{type:"number",step:"0.01",value:eN,onChange:e=>eD(e.target.value),placeholder:"0,00",style:{width:"100%",padding:12,fontSize:16,border:"2px solid #e5e7eb",borderRadius:8,boxSizing:"border-box"}})]}),(0,o.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,o.jsx)("label",{style:{display:"block",marginBottom:8,fontWeight:600},children:"R$ Total"}),(0,o.jsx)("input",{type:"number",step:"0.01",value:eL,onChange:e=>eA(e.target.value),placeholder:"0,00",style:{width:"100%",padding:12,fontSize:16,border:"2px solid #e5e7eb",borderRadius:8,boxSizing:"border-box"}})]})]}),(0,o.jsxs)("div",{style:{display:"flex",gap:12},children:[(0,o.jsx)("button",{type:"button",onClick:()=>{ez(!1),e_(null)},style:{flex:1,padding:12,background:"#f3f4f6",border:"none",borderRadius:8,cursor:"pointer",fontSize:16,fontWeight:600},children:"Cancelar"}),(0,o.jsx)("button",{type:"button",onClick:eG,style:{flex:1,padding:12,background:"#10b981",color:"white",border:"none",borderRadius:8,cursor:"pointer",fontSize:16,fontWeight:600},children:"Salvar"})]})]})})]}):c?(0,o.jsxs)("div",{style:{maxWidth:800,margin:"0 auto",padding:24},children:[(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:24},children:[(0,o.jsx)("button",{onClick:()=>{u(null),h([])},style:{padding:"8px 16px",background:"#f3f4f6",border:"none",borderRadius:8,cursor:"pointer",fontSize:14,fontWeight:600},children:"Voltar"}),(0,o.jsx)("h1",{style:{fontSize:24,fontWeight:700,flex:1},children:c.name}),(0,o.jsx)("button",{onClick:()=>eX(c.id),style:{padding:"8px 10px",background:"#fee2e2",border:"1px solid #fca5a5",borderRadius:8,cursor:"pointer",color:"#dc2626",display:"flex",alignItems:"center",justifyContent:"center"},title:"Excluir lista",children:(0,o.jsx)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:(0,o.jsx)("path",{d:"M3 6h18M8 6V4a2 2 0 012-2h4a2 2 0 012 2v2m3 0v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6h14M10 11v6M14 11v6"})})})]}),(0,o.jsxs)("div",{style:{display:"flex",gap:12,marginBottom:24},children:[(0,o.jsx)("button",{onClick:()=>v(!0),style:{padding:"12px 24px",background:"#2196F3",color:"white",border:"none",borderRadius:8,cursor:"pointer",fontSize:14,fontWeight:600},children:"+ Adicionar Item"}),(0,o.jsx)("button",{onClick:e0,disabled:N,style:{padding:"12px 24px",background:"#f59e0b",color:"white",border:"none",borderRadius:8,cursor:N?"not-allowed":"pointer",fontSize:14,fontWeight:600,opacity:N?.7:1},children:N?"Carregando...":"Sugestoes"})]}),(0,o.jsxs)("div",{style:{marginBottom:24},children:[(0,o.jsxs)("h2",{style:{fontSize:16,fontWeight:600,color:"#6b7280",marginBottom:12},children:["PENDENTES (",e9.length,")"]}),0===e9.length?(0,o.jsx)("div",{style:{padding:24,textAlign:"center",color:"#9ca3af",border:"2px dashed #e5e7eb",borderRadius:12},children:"Nenhum item pendente"}):(0,o.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:8},children:e9.map(e=>(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12,padding:16,background:"white",boxShadow:"0 1px 2px rgba(0,0,0,0.05)",borderRadius:12},children:[(0,o.jsx)("input",{type:"checkbox",checked:!1,onChange:()=>eU(e),style:{width:24,height:24,cursor:"pointer"}}),(0,o.jsxs)("div",{style:{flex:1},children:[(0,o.jsx)("div",{style:{fontWeight:600},children:e.name}),(0,o.jsxs)("div",{style:{fontSize:14,color:"#6b7280"},children:[e.quantity," ",e.unit||"un"]})]}),(0,o.jsx)("button",{onClick:()=>eJ(e),style:{padding:"6px 10px",background:"#dbeafe",border:"1px solid #93c5fd",borderRadius:6,cursor:"pointer",color:"#1e40af",display:"flex",alignItems:"center",justifyContent:"center"},title:"Editar item",children:(0,o.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,o.jsx)("path",{d:"M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7"}),(0,o.jsx)("path",{d:"M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z"})]})}),(0,o.jsx)("button",{onClick:()=>eQ(e.id),style:{padding:"6px 10px",background:"#fee2e2",border:"1px solid #fca5a5",borderRadius:6,cursor:"pointer",color:"#dc2626",display:"flex",alignItems:"center",justifyContent:"center"},title:"Remover item",children:(0,o.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:(0,o.jsx)("path",{d:"M3 6h18M8 6V4a2 2 0 012-2h4a2 2 0 012 2v2m3 0v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6h14M10 11v6M14 11v6"})})})]},e.id))})]}),I&&B.length>0&&(0,o.jsxs)("div",{style:{marginBottom:24},children:[(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[(0,o.jsxs)("h2",{style:{fontSize:16,fontWeight:600,color:"#f59e0b"},children:["SUGESTOES (",B.length,")"]}),(0,o.jsx)("button",{onClick:()=>F(!1),style:{padding:"4px 8px",background:"transparent",border:"none",cursor:"pointer",fontSize:12,color:"#6b7280"},children:"Fechar"})]}),(0,o.jsx)("div",{style:{fontSize:12,color:"#6b7280",marginBottom:12},children:"Baseado no seu consumo dos ultimos 30 dias"}),(0,o.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:8},children:B.map(e=>(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12,padding:16,background:"#fffbeb",border:"2px solid #fcd34d",borderRadius:12},children:[(0,o.jsxs)("div",{style:{flex:1},children:[(0,o.jsx)("div",{style:{fontWeight:600,textTransform:"capitalize"},children:e.food_name}),(0,o.jsxs)("div",{style:{fontSize:12,color:"#6b7280"},children:["Consumido ",e.consumption_count,"x em ",e.days_consumed," dias"]})]}),(0,o.jsx)("button",{onClick:()=>e1(e),style:{padding:"8px 16px",background:"#10b981",color:"white",border:"none",borderRadius:6,cursor:"pointer",fontSize:12,fontWeight:600},children:"Adicionar"}),(0,o.jsx)("button",{onClick:()=>{E(t=>t.filter(t=>t.food_name!==e.food_name))},style:{padding:"8px 12px",background:"#f3f4f6",border:"1px solid #d1d5db",borderRadius:6,cursor:"pointer",fontSize:14,color:"#6b7280"},children:"X"})]},e.food_name))})]}),te.length>0&&(0,o.jsxs)("div",{style:{marginBottom:24},children:[(0,o.jsxs)("h2",{style:{fontSize:16,fontWeight:600,color:"#6b7280",marginBottom:12},children:["COMPRADOS (",te.length,")"]}),(0,o.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:8},children:te.map(e=>(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12,padding:12,background:"#f0fdf4",borderRadius:12},children:[(0,o.jsx)("input",{type:"checkbox",checked:!0,onChange:()=>eU(e),style:{width:22,height:22,cursor:"pointer",flexShrink:0}}),(0,o.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,o.jsx)("div",{style:{fontWeight:600,fontSize:15,textDecoration:"line-through",color:"#6b7280"},children:e.name}),(0,o.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",alignItems:"center",gap:8,marginTop:6},children:[(0,o.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:2},children:[(0,o.jsx)("label",{style:{fontSize:10,color:"#9ca3af"},children:"Qtd"}),(0,o.jsx)("input",{type:"number",step:"0.001",min:"0.001",className:"no-spinner",defaultValue:e.quantity,onFocus:e=>e.target.select(),onBlur:t=>{let i=parseFloat(t.target.value);i&&i!==Number(e.quantity)&&e$(e,"quantity",i)},style:{width:60,padding:"6px",fontSize:13,border:"1px solid #d1d5db",borderRadius:6,textAlign:"center"}})]}),(0,o.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:2},children:[(0,o.jsx)("label",{style:{fontSize:10,color:"#9ca3af"},children:"Unid"}),(0,o.jsx)("input",{type:"text",defaultValue:e.unit||"un",onBlur:t=>{let i=t.target.value.trim();i&&i!==e.unit&&eH(e.id,{unit:i})},style:{width:50,padding:"6px",fontSize:13,border:"1px solid #d1d5db",borderRadius:6,textAlign:"center"}})]}),(0,o.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:2},children:[(0,o.jsx)("label",{style:{fontSize:10,color:"#9ca3af"},children:"R$ Unit."}),(0,o.jsx)("input",{type:"number",step:"0.01",min:"0",placeholder:"0,00",className:"no-spinner",defaultValue:e.unit_price?Number(e.unit_price).toFixed(2):"",onFocus:e=>e.target.select(),onBlur:t=>{let i=t.target.value?parseFloat(t.target.value):0;i!==Number(e.unit_price)&&e$(e,"unit_price",i)},style:{width:70,padding:"6px",fontSize:13,border:"1px solid #d1d5db",borderRadius:6,textAlign:"right",background:"#f9fafb"}},"unit-".concat(e.id,"-").concat(e.unit_price))]}),(0,o.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:2},children:[(0,o.jsx)("label",{style:{fontSize:10,color:"#166534",fontWeight:600},children:"R$ Total"}),(0,o.jsx)("input",{type:"number",step:"0.01",min:"0",placeholder:"0,00",className:"no-spinner",defaultValue:e.price?Number(e.price).toFixed(2):"",onFocus:e=>e.target.select(),onBlur:t=>{let i=t.target.value?parseFloat(t.target.value):0;i!==Number(e.price)&&e$(e,"price",i)},style:{width:80,padding:"6px",fontSize:13,border:"1px solid #10b981",borderRadius:6,textAlign:"right",fontWeight:600,color:"#166534"}},"total-".concat(e.id,"-").concat(e.price))]})]})]}),(0,o.jsx)("div",{style:{display:"none"}})]},e.id))}),tt>0&&(0,o.jsxs)("div",{style:{marginTop:12,padding:12,background:"#dcfce7",borderRadius:8,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,o.jsx)("span",{style:{fontWeight:600,color:"#166534"},children:"Total"}),(0,o.jsx)("span",{style:{fontWeight:700,fontSize:18,color:"#166534"},children:ti(tt)})]})]}),te.length>0&&(0,o.jsxs)("button",{onClick:function(){Q(""),G(!1),Y(""),es(1),ed(""),H(!0)},style:{width:"100%",padding:16,background:"#10b981",color:"white",border:"none",borderRadius:12,fontSize:16,fontWeight:600,cursor:"pointer"},children:["Finalizar Lista",e9.length>0&&(0,o.jsxs)("span",{style:{fontSize:13,fontWeight:400,marginLeft:8},children:["(",e9.length," pendente",e9.length>1?"s":"",")"]})]}),O&&(0,o.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",padding:24,zIndex:1e3},children:(0,o.jsx)("div",{style:{background:"white",borderRadius:16,padding:24,width:"100%",maxWidth:400},children:1===ea?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("h2",{style:{fontSize:20,fontWeight:700,marginBottom:16},children:"Finalizar Lista"}),e9.length>0&&(0,o.jsxs)("div",{style:{padding:12,background:"#fef3c7",borderRadius:8,marginBottom:16,fontSize:14,color:"#92400e"},children:[e9.length," item(ns) ainda nao comprado(s). Serao transferidos para uma nova lista."]}),(0,o.jsx)("p",{style:{fontSize:14,color:"#6b7280",marginBottom:16},children:"Onde voce fez as compras?"}),J?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("input",{type:"text",value:X,onChange:e=>Y(e.target.value),placeholder:"Nome da loja (ex: Carrefour Centro)",style:{width:"100%",padding:12,fontSize:16,border:"2px solid #e5e7eb",borderRadius:8,marginBottom:12,boxSizing:"border-box"}}),(0,o.jsx)("button",{type:"button",onClick:()=>{G(!1),Y("")},style:{width:"100%",padding:10,background:"#f3f4f6",border:"none",borderRadius:8,cursor:"pointer",fontSize:14,color:"#6b7280",marginBottom:16},children:"Voltar para lista de lojas"})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("select",{value:$,onChange:e=>Q(e.target.value),style:{width:"100%",padding:12,fontSize:16,border:"2px solid #e5e7eb",borderRadius:8,marginBottom:12,boxSizing:"border-box",background:"white"},children:[(0,o.jsx)("option",{value:"",children:"Selecione uma loja (opcional)"}),V.map(e=>(0,o.jsx)("option",{value:e.id,children:e.name},e.id))]}),(0,o.jsx)("button",{type:"button",onClick:()=>G(!0),style:{width:"100%",padding:10,background:"#f3f4f6",border:"1px dashed #d1d5db",borderRadius:8,cursor:"pointer",fontSize:14,color:"#6b7280",marginBottom:16},children:"+ Adicionar nova loja"})]}),(0,o.jsxs)("div",{style:{display:"flex",gap:12},children:[(0,o.jsx)("button",{type:"button",onClick:()=>H(!1),style:{flex:1,padding:12,background:"#f3f4f6",border:"none",borderRadius:8,cursor:"pointer",fontSize:16,fontWeight:600},children:"Cancelar"}),(0,o.jsx)("button",{type:"button",onClick:eY,style:{flex:1,padding:12,background:"#10b981",color:"white",border:"none",borderRadius:8,cursor:"pointer",fontSize:16,fontWeight:600},children:e9.length>0?"Proximo":"Finalizar"})]})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("h2",{style:{fontSize:20,fontWeight:700,marginBottom:16},children:"Itens Pendentes"}),(0,o.jsx)("p",{style:{fontSize:14,color:"#6b7280",marginBottom:8},children:"Os seguintes itens nao foram comprados:"}),(0,o.jsx)("div",{style:{maxHeight:150,overflowY:"auto",padding:12,background:"#f9fafb",borderRadius:8,marginBottom:16},children:e9.map(e=>(0,o.jsxs)("div",{style:{fontSize:14,color:"#374151",marginBottom:4},children:["â€¢ ",e.name," (",e.quantity," ",e.unit||"un",")"]},e.id))}),(0,o.jsx)("p",{style:{fontSize:14,color:"#6b7280",marginBottom:8},children:"Qual nome dar para a nova lista com esses itens?"}),(0,o.jsx)("input",{type:"text",value:el,onChange:e=>ed(e.target.value),placeholder:"Nome da nova lista",style:{width:"100%",padding:12,fontSize:16,border:"2px solid #e5e7eb",borderRadius:8,marginBottom:16,boxSizing:"border-box"}}),(0,o.jsxs)("div",{style:{display:"flex",gap:12},children:[(0,o.jsx)("button",{type:"button",onClick:()=>es(1),style:{flex:1,padding:12,background:"#f3f4f6",border:"none",borderRadius:8,cursor:"pointer",fontSize:16,fontWeight:600},children:"Voltar"}),(0,o.jsx)("button",{type:"button",onClick:eY,disabled:!el.trim(),style:{flex:1,padding:12,background:el.trim()?"#10b981":"#9ca3af",color:"white",border:"none",borderRadius:8,cursor:el.trim()?"pointer":"not-allowed",fontSize:16,fontWeight:600},children:"Finalizar"})]})]})})}),j&&(0,o.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",padding:24,zIndex:1e3},children:(0,o.jsxs)("div",{style:{background:"white",borderRadius:16,padding:24,width:"100%",maxWidth:400},children:[(0,o.jsx)("h2",{style:{fontSize:20,fontWeight:700,marginBottom:16},children:"Adicionar Item"}),(0,o.jsxs)("form",{onSubmit:eV,children:[(0,o.jsxs)("div",{style:{marginBottom:16},children:[(0,o.jsx)("label",{style:{display:"block",marginBottom:8,fontWeight:600},children:"Nome do item *"}),(0,o.jsx)("input",{type:"text",value:w,onChange:e=>z(e.target.value),placeholder:"Ex: Arroz integral",required:!0,style:{width:"100%",padding:12,fontSize:16,border:"2px solid #e5e7eb",borderRadius:8,boxSizing:"border-box"}})]}),(0,o.jsxs)("div",{style:{display:"flex",gap:12,marginBottom:16},children:[(0,o.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,o.jsx)("label",{style:{display:"block",marginBottom:8,fontWeight:600},children:"Quantidade"}),(0,o.jsx)("input",{type:"number",step:"0.1",value:C,onChange:e=>_(e.target.value),style:{width:"100%",padding:12,fontSize:16,border:"2px solid #e5e7eb",borderRadius:8,boxSizing:"border-box"}})]}),(0,o.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,o.jsx)("label",{style:{display:"block",marginBottom:8,fontWeight:600},children:"Unidade"}),(0,o.jsx)("input",{type:"text",value:R,onChange:e=>W(e.target.value),placeholder:"kg, un, L...",style:{width:"100%",padding:12,fontSize:16,border:"2px solid #e5e7eb",borderRadius:8,boxSizing:"border-box"}})]})]}),(0,o.jsxs)("div",{style:{display:"flex",gap:12},children:[(0,o.jsx)("button",{type:"button",onClick:()=>v(!1),style:{flex:1,padding:12,background:"#f3f4f6",border:"none",borderRadius:8,cursor:"pointer",fontSize:16,fontWeight:600},children:"Cancelar"}),(0,o.jsx)("button",{type:"submit",style:{flex:1,padding:12,background:"#2196F3",color:"white",border:"none",borderRadius:8,cursor:"pointer",fontSize:16,fontWeight:600},children:"Adicionar"})]})]})]})}),ew&&eC&&(0,o.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",padding:24,zIndex:1e3},children:(0,o.jsxs)("div",{style:{background:"white",borderRadius:16,padding:24,width:"100%",maxWidth:400},children:[(0,o.jsx)("h2",{style:{fontSize:20,fontWeight:700,marginBottom:16},children:"Editar Item"}),(0,o.jsxs)("div",{style:{marginBottom:16},children:[(0,o.jsx)("label",{style:{display:"block",marginBottom:8,fontWeight:600},children:"Nome do item *"}),(0,o.jsx)("input",{type:"text",value:eR,onChange:e=>eW(e.target.value),placeholder:"Ex: Arroz integral",style:{width:"100%",padding:12,fontSize:16,border:"2px solid #e5e7eb",borderRadius:8,boxSizing:"border-box"}})]}),(0,o.jsxs)("div",{style:{display:"flex",gap:12,marginBottom:16},children:[(0,o.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,o.jsx)("label",{style:{display:"block",marginBottom:8,fontWeight:600},children:"Quantidade"}),(0,o.jsx)("input",{type:"number",step:"0.001",value:eB,onChange:e=>eE(e.target.value),style:{width:"100%",padding:12,fontSize:16,border:"2px solid #e5e7eb",borderRadius:8,boxSizing:"border-box"}})]}),(0,o.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,o.jsx)("label",{style:{display:"block",marginBottom:8,fontWeight:600},children:"Unidade"}),(0,o.jsx)("input",{type:"text",value:eI,onChange:e=>eF(e.target.value),placeholder:"kg, g, un, L...",style:{width:"100%",padding:12,fontSize:16,border:"2px solid #e5e7eb",borderRadius:8,boxSizing:"border-box"}})]})]}),eC.is_purchased&&(0,o.jsxs)("div",{style:{display:"flex",gap:12,marginBottom:16},children:[(0,o.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,o.jsx)("label",{style:{display:"block",marginBottom:8,fontWeight:600},children:"R$ Unit\xe1rio"}),(0,o.jsx)("input",{type:"number",step:"0.01",value:eN,onChange:e=>eD(e.target.value),placeholder:"0,00",style:{width:"100%",padding:12,fontSize:16,border:"2px solid #e5e7eb",borderRadius:8,boxSizing:"border-box"}})]}),(0,o.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,o.jsx)("label",{style:{display:"block",marginBottom:8,fontWeight:600},children:"R$ Total"}),(0,o.jsx)("input",{type:"number",step:"0.01",value:eL,onChange:e=>eA(e.target.value),placeholder:"0,00",style:{width:"100%",padding:12,fontSize:16,border:"2px solid #e5e7eb",borderRadius:8,boxSizing:"border-box"}})]})]}),(0,o.jsxs)("div",{style:{display:"flex",gap:12},children:[(0,o.jsx)("button",{type:"button",onClick:()=>{ez(!1),e_(null)},style:{flex:1,padding:12,background:"#f3f4f6",border:"none",borderRadius:8,cursor:"pointer",fontSize:16,fontWeight:600},children:"Cancelar"}),(0,o.jsx)("button",{type:"button",onClick:eG,style:{flex:1,padding:12,background:"#10b981",color:"white",border:"none",borderRadius:8,cursor:"pointer",fontSize:16,fontWeight:600},children:"Salvar"})]})]})})]}):(0,o.jsxs)("div",{style:{maxWidth:800,margin:"0 auto",padding:24},children:[(0,o.jsxs)("div",{style:{marginBottom:24},children:[(0,o.jsx)("h1",{style:{fontSize:24,fontWeight:700,marginBottom:16},children:"Lista de Compras"}),(0,o.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,o.jsxs)("button",{onClick:async()=>{try{if("free"===t){let{showRewardedAd:e}=await i.e(398).then(i.bind(i,68398));await e("shopping_dashboard")}}catch(e){}e.push("/lista-compras/dashboard")},style:{flex:1,height:44,background:"white",color:"#374151",border:"2px solid #e5e7eb",borderRadius:8,cursor:"pointer",fontSize:14,fontWeight:600,display:"flex",alignItems:"center",justifyContent:"center",gap:6},children:[(0,o.jsx)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,o.jsx)("path",{d:"M18 20V10M12 20V4M6 20v-6"})}),"Painel"]}),(0,o.jsxs)("button",{onClick:function(){let e=new Date().toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit"});eb("Compras ".concat(e)),em(""),ev(!1),ek(""),ex(null),eu(!0)},style:{flex:1,height:44,background:"#10b981",color:"white",border:"none",borderRadius:8,cursor:"pointer",fontSize:14,fontWeight:600,display:"flex",alignItems:"center",justifyContent:"center",gap:6},children:[(0,o.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,o.jsx)("rect",{x:"3",y:"4",width:"18",height:"16",rx:"2"}),(0,o.jsx)("line",{x1:"7",y1:"8",x2:"17",y2:"8"}),(0,o.jsx)("line",{x1:"7",y1:"12",x2:"13",y2:"12"}),(0,o.jsx)("line",{x1:"7",y1:"16",x2:"10",y2:"16"})]}),"Nota"]}),(0,o.jsxs)("button",{onClick:()=>m(!0),style:{flex:1,height:44,background:"#2196F3",color:"white",border:"none",borderRadius:8,cursor:"pointer",fontSize:14,fontWeight:600,display:"flex",alignItems:"center",justifyContent:"center",gap:6},children:[(0,o.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,o.jsx)("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),(0,o.jsx)("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"Nova"]})]})]}),g?(0,o.jsx)("div",{style:{padding:32,textAlign:"center",color:"#9ca3af"},children:"Carregando..."}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{style:{marginBottom:32},children:[(0,o.jsx)("h2",{style:{fontSize:16,fontWeight:600,color:"#6b7280",marginBottom:12},children:"LISTAS ATIVAS"}),0===e5.length?(0,o.jsx)("div",{style:{padding:32,textAlign:"center",color:"#9ca3af",border:"2px dashed #e5e7eb",borderRadius:12},children:"Nenhuma lista ativa"}):(0,o.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:12},children:e5.map(e=>(0,o.jsxs)("div",{style:{padding:16,background:"white",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",borderRadius:12,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,o.jsxs)("div",{onClick:()=>eM(e.id),style:{flex:1,cursor:"pointer"},children:[(0,o.jsx)("div",{style:{fontWeight:600,fontSize:16},children:e.name}),(0,o.jsxs)("div",{style:{fontSize:14,color:"#6b7280"},children:["Criada em ",e4(e.created_at)]})]}),(0,o.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[(0,o.jsx)("button",{onClick:t=>{t.stopPropagation(),e2(e)},style:{padding:"8px 12px",background:"#f3f4f6",border:"1px solid #d1d5db",borderRadius:8,cursor:"pointer",fontSize:14,fontWeight:500,color:"#374151"},title:"Duplicar lista",children:"Duplicar"}),(0,o.jsx)("div",{onClick:()=>eM(e.id),style:{padding:"8px 16px",background:"#dbeafe",color:"#1e40af",borderRadius:8,fontSize:14,fontWeight:600,cursor:"pointer"},children:"Abrir"})]})]},e.id))})]}),e3.length>0&&(0,o.jsxs)("div",{children:[(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[(0,o.jsxs)("h2",{style:{fontSize:16,fontWeight:600,color:"#6b7280"},children:["LISTAS CONCLUIDAS ",!ei&&e3.length>5&&"(ultimas 5 de ".concat(e3.length,")")]}),e3.length>5&&(0,o.jsx)("button",{onClick:()=>eo(!ei),style:{padding:"6px 12px",background:"#f3f4f6",border:"none",borderRadius:6,cursor:"pointer",fontSize:13,fontWeight:500,color:"#6b7280"},children:ei?"Mostrar menos":"Ver todas"})]}),(0,o.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:8},children:e7.map(e=>(0,o.jsxs)("div",{style:{padding:12,background:"#f0fdf4",borderRadius:12,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,o.jsxs)("div",{onClick:()=>eK(e),style:{flex:1,cursor:"pointer"},children:[(0,o.jsxs)("div",{style:{fontWeight:600,color:"#166534",fontSize:15,marginBottom:2},children:[e.name,(0,o.jsxs)("span",{style:{fontWeight:400,color:"#6b7280",fontSize:13},children:[" - ",e4(e.completed_at||e.updated_at),e.store_name&&" - ".concat(e.store_name)]})]}),e.total_price&&Number(e.total_price)>0&&(0,o.jsx)("div",{style:{fontSize:15,fontWeight:700,color:"#166534"},children:ti(Number(e.total_price))})]}),(0,o.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,o.jsx)("button",{onClick:()=>eK(e),style:{padding:"6px 12px",background:"#dbeafe",border:"1px solid #93c5fd",borderRadius:6,cursor:"pointer",fontSize:13,fontWeight:500,color:"#1e40af"},children:"Ver"}),(0,o.jsx)("button",{onClick:()=>e2(e),style:{padding:"6px 12px",background:"#dcfce7",border:"1px solid #86efac",borderRadius:6,cursor:"pointer",fontSize:13,fontWeight:500,color:"#166534"},children:"Duplicar"})]})]},e.id))})]})]}),y&&(0,o.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",padding:24,zIndex:1e3},children:(0,o.jsxs)("div",{style:{background:"white",borderRadius:16,padding:24,width:"100%",maxWidth:400},children:[(0,o.jsx)("h2",{style:{fontSize:20,fontWeight:700,marginBottom:16},children:"Nova Lista de Compras"}),(0,o.jsxs)("form",{onSubmit:eq,children:[(0,o.jsxs)("div",{style:{marginBottom:16},children:[(0,o.jsx)("label",{style:{display:"block",marginBottom:8,fontWeight:600},children:"Nome da lista *"}),(0,o.jsx)("input",{type:"text",value:S,onChange:e=>k(e.target.value),placeholder:"Ex: Compras da semana",required:!0,style:{width:"100%",padding:12,fontSize:16,border:"2px solid #e5e7eb",borderRadius:8,boxSizing:"border-box"}})]}),f&&(0,o.jsx)("div",{style:{padding:12,background:"#fee2e2",border:"2px solid #ef4444",borderRadius:8,color:"#991b1b",marginBottom:16},children:f}),(0,o.jsxs)("div",{style:{display:"flex",gap:12},children:[(0,o.jsx)("button",{type:"button",onClick:()=>{m(!1),b(null)},style:{flex:1,padding:12,background:"#f3f4f6",border:"none",borderRadius:8,cursor:"pointer",fontSize:16,fontWeight:600},children:"Cancelar"}),(0,o.jsx)("button",{type:"submit",style:{flex:1,padding:12,background:"#2196F3",color:"white",border:"none",borderRadius:8,cursor:"pointer",fontSize:16,fontWeight:600},children:"Criar Lista"})]})]})]})}),L&&P&&(0,o.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",padding:24,zIndex:1e3},children:(0,o.jsxs)("div",{style:{background:"white",borderRadius:16,padding:24,width:"100%",maxWidth:400},children:[(0,o.jsx)("h2",{style:{fontSize:20,fontWeight:700,marginBottom:16},children:"Duplicar Lista"}),(0,o.jsxs)("p",{style:{fontSize:14,color:"#6b7280",marginBottom:16},children:["Duplicando: ",(0,o.jsx)("strong",{children:P.name})]}),(0,o.jsxs)("form",{onSubmit:e6,children:[(0,o.jsxs)("div",{style:{marginBottom:16},children:[(0,o.jsx)("label",{style:{display:"block",marginBottom:8,fontWeight:600},children:"Nome da nova lista *"}),(0,o.jsx)("input",{type:"text",value:M,onChange:e=>q(e.target.value),placeholder:"Ex: Compras da semana",required:!0,style:{width:"100%",padding:12,fontSize:16,border:"2px solid #e5e7eb",borderRadius:8,boxSizing:"border-box"}})]}),(0,o.jsxs)("div",{style:{display:"flex",gap:12},children:[(0,o.jsx)("button",{type:"button",onClick:()=>{A(!1),T(null)},style:{flex:1,padding:12,background:"#f3f4f6",border:"none",borderRadius:8,cursor:"pointer",fontSize:16,fontWeight:600},children:"Cancelar"}),(0,o.jsx)("button",{type:"submit",style:{flex:1,padding:12,background:"#2196F3",color:"white",border:"none",borderRadius:8,cursor:"pointer",fontSize:16,fontWeight:600},children:"Duplicar"})]})]})]})}),ec&&(0,o.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",padding:24,zIndex:1e3},children:(0,o.jsxs)("div",{style:{background:"white",borderRadius:16,padding:24,width:"100%",maxWidth:400},children:[(0,o.jsx)("h2",{style:{fontSize:20,fontWeight:700,marginBottom:8},children:"Escanear Nota Fiscal"}),(0,o.jsx)("p",{style:{fontSize:14,color:"#6b7280",marginBottom:16},children:"Tire uma foto da nota para importar os itens automaticamente."}),(0,o.jsxs)("form",{onSubmit:e8,children:[(0,o.jsxs)("div",{style:{marginBottom:16},children:[(0,o.jsx)("label",{style:{display:"block",marginBottom:8,fontWeight:600},children:"Nome da lista"}),(0,o.jsx)("input",{type:"text",value:ef,onChange:e=>eb(e.target.value),placeholder:"Ex: Compras 29/12",style:{width:"100%",padding:12,fontSize:16,border:"2px solid #e5e7eb",borderRadius:8,boxSizing:"border-box"}})]}),(0,o.jsxs)("div",{style:{marginBottom:16},children:[(0,o.jsx)("label",{style:{display:"block",marginBottom:8,fontWeight:600},children:"Loja (opcional)"}),ej?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("input",{type:"text",value:eS,onChange:e=>ek(e.target.value),placeholder:"Nome da loja",style:{width:"100%",padding:12,fontSize:16,border:"2px solid #e5e7eb",borderRadius:8,marginBottom:8,boxSizing:"border-box"}}),(0,o.jsx)("button",{type:"button",onClick:()=>{ev(!1),ek("")},style:{width:"100%",padding:10,background:"#f3f4f6",border:"none",borderRadius:8,cursor:"pointer",fontSize:14,color:"#6b7280"},children:"Voltar para lista"})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("select",{value:ey,onChange:e=>em(e.target.value),style:{width:"100%",padding:12,fontSize:16,border:"2px solid #e5e7eb",borderRadius:8,marginBottom:8,boxSizing:"border-box",background:"white"},children:[(0,o.jsx)("option",{value:"",children:"Selecione uma loja"}),V.map(e=>(0,o.jsx)("option",{value:e.id,children:e.name},e.id))]}),(0,o.jsx)("button",{type:"button",onClick:()=>ev(!0),style:{width:"100%",padding:10,background:"#f3f4f6",border:"1px dashed #d1d5db",borderRadius:8,cursor:"pointer",fontSize:14,color:"#6b7280"},children:"+ Nova loja"})]})]}),(0,o.jsxs)("div",{style:{marginBottom:16},children:[(0,o.jsx)("label",{style:{display:"block",marginBottom:8,fontWeight:600},children:"Foto da nota *"}),(0,o.jsx)("input",{type:"file",accept:"image/*",capture:"environment",required:!0,style:{width:"100%",padding:12,fontSize:14,border:"2px solid #e5e7eb",borderRadius:8,boxSizing:"border-box",background:"#f9fafb"}}),(0,o.jsx)("p",{style:{fontSize:12,color:"#9ca3af",marginTop:4},children:"Tire uma foto clara da nota fiscal completa"})]}),eg&&(0,o.jsx)("div",{style:{padding:12,background:"#fee2e2",border:"2px solid #ef4444",borderRadius:8,color:"#991b1b",marginBottom:16,fontSize:14},children:eg}),(0,o.jsxs)("div",{style:{display:"flex",gap:12},children:[(0,o.jsx)("button",{type:"button",onClick:()=>eu(!1),disabled:ep,style:{flex:1,padding:12,background:"#f3f4f6",border:"none",borderRadius:8,cursor:ep?"not-allowed":"pointer",fontSize:16,fontWeight:600,opacity:ep?.7:1},children:"Cancelar"}),(0,o.jsx)("button",{type:"submit",disabled:ep,style:{flex:1,padding:12,background:ep?"#9ca3af":"#10b981",color:"white",border:"none",borderRadius:8,cursor:ep?"not-allowed":"pointer",fontSize:16,fontWeight:600},children:ep?"Analisando...":"Escanear"})]})]})]})})]})}},86394:function(e,t,i){"use strict";i.d(t,{R:function(){return d}});var o=i(2265),n=i(87185),r=i(45591);async function a(){let e=await r.h.get("/api/user/profile");if(!e.ok)throw Error("Failed to fetch user plan: ".concat(e.status));let t=(await e.json()).user;return{plan:t.plan||"free",subscription_status:t.subscription_status||"active",subscription_started_at:t.subscription_started_at,subscription_expires_at:t.subscription_expires_at}}async function s(){let e=await r.h.get("/api/subscription/quota");if(!e.ok)throw Error("Failed to fetch quota usage: ".concat(e.status));return e.json()}async function l(){try{let{Purchases:e}=await i.e(938).then(i.bind(i,31938)),{customerInfo:t}=await e.getCustomerInfo();await r.h.post("/api/subscription/sync",{customerInfo:t}),console.log("[useUserPlan] Sync success")}catch(e){console.warn("[useUserPlan] Sync error:",e)}}function d(){let[e,t]=(0,o.useState)("free"),[i,r]=(0,o.useState)("active"),[d,c]=(0,o.useState)(null),[u,p]=(0,o.useState)(!0),[h,g]=(0,o.useState)(null),x=(0,o.useRef)(!1),f=async()=>{try{p(!0),g(null),n.dV.isNativePlatform()&&!x.current&&(x.current=!0,await l());let e=await a();if(t(e.plan),r(e.subscription_status),"premium"===e.plan){let e=await s(),t=function(e){var t;let i=e.photo_analyses/e.limits.photo_analyses_per_month*100,o=e.ocr_analyses/e.limits.ocr_analyses_per_month*100,n=e.text_analyses/e.limits.text_analyses_per_month*100,r=null===(t=e.limits)||void 0===t?void 0:t.report_analyses_per_month,a=e.report_analyses,s=new Date,l=new Date(s.getFullYear(),s.getMonth()+1,1);return{photo_analyses:{used:e.photo_analyses,limit:e.limits.photo_analyses_per_month,percentage:Math.round(i),remaining:e.limits.photo_analyses_per_month-e.photo_analyses},ocr_analyses:{used:e.ocr_analyses,limit:e.limits.ocr_analyses_per_month,percentage:Math.round(o),remaining:e.limits.ocr_analyses_per_month-e.ocr_analyses},text_analyses:{used:e.text_analyses,limit:e.limits.text_analyses_per_month,percentage:Math.round(n),remaining:e.limits.text_analyses_per_month-e.text_analyses},report_analyses:void 0!==r?{used:a||0,limit:r,percentage:Math.round(r?(a||0)/r*100:0),remaining:r-(a||0)}:void 0,resetDate:l}}(e);c(t)}else c(null)}catch(e){console.error("Error fetching user plan:",e),g(e instanceof Error?e:Error("Unknown error")),t("free"),c(null)}finally{p(!1)}};return(0,o.useEffect)(()=>{f()},[]),{plan:e,subscription_status:i,quota:d,isLoading:u,error:h,refetch:f}}},45591:function(e,t,i){"use strict";i.d(t,{h:function(){return a},x:function(){return r}});var o=i(45800);let n=i(20357).env.NEXT_PUBLIC_API_URL||"https://app.foodtracker.com.br";async function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{token:i,...r}=t,a={...r.headers};if(i)a.Authorization="Bearer ".concat(i);else{let e=localStorage.getItem("auth_token");console.log("[API Client] localStorage auth_token:",e?"exists":"null"),e&&(a.Authorization="Bearer ".concat(e))}r.body&&"string"==typeof r.body&&!a["Content-Type"]&&(a["Content-Type"]="application/json");let s=e.startsWith("http")?e:"".concat(n).concat(e);console.log("[API Client]",{isMobile:!0,baseUrl:n,endpoint:e,finalUrl:s,hasAuthToken:!!a.Authorization,allHeaders:Object.keys(a),xAdCompleted:a["x-ad-completed"]||"not set"});try{let t=await fetch(s,{...r,headers:a,credentials:"include"});if(console.log("[API Client] Response ".concat(e,":"),{status:t.status}),401===t.status){console.warn("401 Unauthorized - triggering client logout");try{(0,o.h)()}catch(e){}}return t}catch(e){throw console.error("[API Client Error]",e),e}}let a={get:(e,t)=>r(e,{method:"GET",token:t}),post:(e,t,i)=>r(e,{method:"POST",body:JSON.stringify(t),token:i}),put:(e,t,i)=>r(e,{method:"PUT",body:JSON.stringify(t),token:i}),patch:(e,t,i)=>r(e,{method:"PATCH",body:JSON.stringify(t),token:i}),delete:(e,t)=>r(e,{method:"DELETE",token:t})}},45800:function(e,t,i){"use strict";function o(){try{try{localStorage.removeItem("auth_token")}catch(e){}try{localStorage.setItem("auth_logout_at",String(Date.now()))}catch(e){}try{window.dispatchEvent(new Event("app:logout"))}catch(e){}}catch(e){}}i.d(t,{h:function(){return o}})},16463:function(e,t,i){"use strict";var o=i(71169);i.o(o,"usePathname")&&i.d(t,{usePathname:function(){return o.usePathname}}),i.o(o,"useRouter")&&i.d(t,{useRouter:function(){return o.useRouter}}),i.o(o,"useSearchParams")&&i.d(t,{useSearchParams:function(){return o.useSearchParams}})}},function(e){e.O(0,[325,971,23,744],function(){return e(e.s=3790)}),_N_E=e.O()}]);