(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[160,398],{18784:function(e,n,o){Promise.resolve().then(o.bind(o,78947))},78947:function(e,n,o){"use strict";o.r(n),o.d(n,{default:function(){return c}});var a=o(57437),t=o(2265),i=o(86394),r=o(46285);let s={free:{photo_analyses_per_month:999999,ocr_analyses_per_month:999999,text_analyses_per_month:999999,coach_analyses_per_month:999999,report_analyses_per_month:999999,history_days:30,coach_ai:!0,advanced_reports:!0,data_export:!1,show_ads:!0},premium:{photo_analyses_per_month:150,ocr_analyses_per_month:150,text_analyses_per_month:150,coach_analyses_per_month:5,report_analyses_per_month:5,history_days:null,coach_ai:!0,advanced_reports:!0,data_export:!0,show_ads:!1},unlimited:{photo_analyses_per_month:999999,ocr_analyses_per_month:999999,text_analyses_per_month:999999,coach_analyses_per_month:999999,report_analyses_per_month:999999,history_days:null,coach_ai:!0,advanced_reports:!0,data_export:!0,show_ads:!1}};var d=o(45591),l=o(45224);function c(){let{plan:e,isLoading:n}=(0,i.R)(),[o,c]=(0,t.useState)(!1),[u,h]=(0,t.useState)(!1),[g,f]=(0,t.useState)(!0),[p,m]=(0,t.useState)(!1),[y,b]=(0,t.useState)(!0),[x,w]=(0,t.useState)(null),[_,v]=(0,t.useState)([]),[j,A]=(0,t.useState)(null);async function S(){try{let e=await d.h.get("/api/user/goals"),n=await e.json();e.ok&&n.goals&&n.goals.goal_type&&m(!0)}catch(e){console.error("Erro ao buscar objetivos:",e)}finally{b(!1)}}async function R(){try{f(!0);let e=await d.h.get("/api/coach/history"),n=await e.json();e.ok&&(v(n.analyses||[]),n.analyses.length>0&&w({analysisText:n.analyses[0].analysis_text,recommendations:n.analyses[0].recommendations,insights:n.analyses[0].insights,warnings:n.analyses[0].warnings,analysis_date:n.analyses[0].analysis_date}))}catch(e){console.error("Erro ao buscar hist\xf3rico:",e)}finally{f(!1)}}async function B(){if(!s[e].coach_ai){c(!0);return}h(!0),A(null);try{let e=await (0,l.q)(e=>fetch("/api/coach/analyze",{method:"POST",headers:{"Content-Type":"application/json",...e||{}},body:JSON.stringify({})}),{feature:"coach_analysis"}),n=await e.json();if(!e.ok){let o=(0,l.p)(e,n);if(o)throw Error(o);if(499===e.status)return;if(403===e.status&&"upgrade_required"===n.error){c(!0);return}throw Error(n.message||n.error||"Erro ao analisar")}e.ok&&n.analysis&&(w(n.analysis),await R())}catch(e){A(e.message)}finally{h(!1)}}(0,t.useEffect)(()=>{R(),S()},[]),g||_.length;let z=s[e].coach_ai;return(0,a.jsxs)("div",{style:{maxWidth:900,margin:"0 auto",padding:24},children:[(0,a.jsx)(r.x5,{isOpen:o,onClose:()=>c(!1),feature:"coach_analysis",currentPlan:e}),(0,a.jsx)("h1",{style:{fontSize:32,fontWeight:700,marginBottom:24},children:"Coach IA"}),n&&(0,a.jsx)("div",{style:{background:"#f9fafb",border:"2px solid #e5e7eb",borderRadius:16,padding:32,textAlign:"center",marginBottom:24},children:(0,a.jsx)("div",{style:{fontSize:16,color:"#6b7280"},children:"Carregando informa\xe7\xf5es..."})}),!n&&!y&&!p&&z&&(0,a.jsx)("div",{style:{background:"#fffbeb",border:"2px solid #fbbf24",borderRadius:16,padding:24,marginBottom:24},children:(0,a.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",gap:16},children:[(0,a.jsx)("div",{style:{fontSize:32}}),(0,a.jsxs)("div",{style:{flex:1},children:[(0,a.jsx)("h3",{style:{fontSize:18,fontWeight:700,marginBottom:8,color:"#92400e"},children:"Configure seus objetivos primeiro"}),(0,a.jsx)("p",{style:{fontSize:15,color:"#92400e",marginBottom:16},children:"Para receber an\xe1lises personalizadas e relevantes, voc\xea precisa definir seus objetivos (perder/ganhar/manter peso), altura, idade e n\xedvel de atividade."}),(0,a.jsx)("a",{href:"/objetivos",style:{display:"inline-block",padding:"12px 24px",background:"#fbbf24",color:"#92400e",borderRadius:8,fontWeight:600,textDecoration:"none"},children:"Configurar Objetivos Agora"})]})]})}),!n&&(0,a.jsxs)("div",{style:{background:z?"linear-gradient(135deg, #667eea 0%, #764ba2 100%)":"linear-gradient(135deg, #94a3b8 0%, #64748b 100%)",color:"white",borderRadius:16,padding:32,marginBottom:32,textAlign:"center",position:"relative"},children:[!z&&(0,a.jsx)("div",{style:{position:"absolute",top:16,right:16,background:"#fbbf24",color:"#92400e",padding:"6px 12px",borderRadius:8,fontSize:12,fontWeight:700},children:"PREMIUM"}),(0,a.jsx)("div",{style:{fontSize:48,marginBottom:16},children:""}),(0,a.jsx)("h2",{style:{fontSize:24,fontWeight:700,marginBottom:12},children:z?"An\xe1lise Personalizada":"Recurso Premium"}),(0,a.jsx)("p",{style:{fontSize:16,marginBottom:24,opacity:.9},children:z?"Receba insights baseados no seu peso, medidas e alimenta\xe7\xe3o":"Desbloqueie o Coach IA e receba an\xe1lises personalizadas ilimitadas"}),(0,a.jsx)("button",{onClick:z?B:()=>c(!0),disabled:u||z&&g,style:{padding:"16px 32px",background:"white",color:z?"#667eea":"#64748b",border:"none",borderRadius:12,fontSize:16,fontWeight:700,cursor:u||g?"not-allowed":"pointer",opacity:u||g?.7:1},children:u?" Analisando...":z?" Analisar Agora":" Desbloquear Premium"})]}),!n&&!g&&!x&&0===_.length&&!j&&z&&(0,a.jsxs)("div",{style:{background:"#fffbeb",border:"2px solid #fbbf24",borderRadius:16,padding:32,textAlign:"center",marginBottom:24},children:[(0,a.jsx)("div",{style:{fontSize:48,marginBottom:16}}),(0,a.jsx)("h3",{style:{fontSize:20,fontWeight:700,marginBottom:12,color:"#92400e"},children:"Dados insuficientes para an\xe1lise"}),(0,a.jsx)("p",{style:{fontSize:16,color:"#92400e",marginBottom:24},children:"Para receber insights personalizados, voc\xea precisa ter registrado:"}),(0,a.jsxs)("ul",{style:{listStyle:"none",padding:0,margin:"0 auto",maxWidth:400,textAlign:"left"},children:[(0,a.jsx)("li",{style:{padding:"8px 0",fontSize:15,color:"#92400e"},children:"Peso atual"}),(0,a.jsx)("li",{style:{padding:"8px 0",fontSize:15,color:"#92400e"},children:"Medidas corporais (cintura, quadril, etc.)"}),(0,a.jsx)("li",{style:{padding:"8px 0",fontSize:15,color:"#92400e"},children:"Refei\xe7\xf5es recentes"})]}),(0,a.jsxs)("div",{style:{marginTop:24,display:"flex",gap:12,justifyContent:"center",flexWrap:"wrap"},children:[(0,a.jsx)("a",{href:"/peso",style:{padding:"12px 24px",background:"#fbbf24",color:"#92400e",borderRadius:8,fontWeight:600,textDecoration:"none",display:"inline-block"},children:"Registrar Peso/Medidas"}),(0,a.jsx)("a",{href:"/capture",style:{padding:"12px 24px",background:"#fbbf24",color:"#92400e",borderRadius:8,fontWeight:600,textDecoration:"none",display:"inline-block"},children:"Registrar Refei\xe7\xe3o"})]})]}),u&&(0,a.jsxs)("div",{style:{background:"#f9fafb",border:"2px solid #e5e7eb",borderRadius:16,padding:32,marginBottom:24},children:[(0,a.jsxs)("div",{style:{marginBottom:24},children:[(0,a.jsx)("div",{style:{height:20,background:"#e5e7eb",borderRadius:4,marginBottom:12,animation:"pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite"}}),(0,a.jsx)("div",{style:{height:20,background:"#e5e7eb",borderRadius:4,width:"80%",animation:"pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite"}})]}),(0,a.jsx)("div",{style:{fontSize:14,color:"#6b7280",textAlign:"center"},children:"Analisando seus dados e gerando insights..."})]}),j&&(0,a.jsx)("div",{style:{padding:16,background:"#fee2e2",border:"2px solid #ef4444",borderRadius:12,color:"#991b1b",marginBottom:24},children:j}),x&&(0,a.jsxs)("div",{children:[x.analysis_date&&(0,a.jsxs)("div",{style:{fontSize:14,color:"#6b7280",marginBottom:16},children:["An\xe1lise de ",new Date(x.analysis_date).toLocaleDateString("pt-BR",{day:"2-digit",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"})]}),x.warnings&&x.warnings.length>0&&(0,a.jsxs)("div",{style:{background:"#fef2f2",border:"2px solid #ef4444",borderRadius:16,padding:24,marginBottom:24},children:[(0,a.jsx)("h3",{style:{fontSize:20,fontWeight:700,marginBottom:16,color:"#ef4444"},children:"Alertas Importantes"}),(0,a.jsx)("ul",{style:{paddingLeft:20,margin:0},children:x.warnings.map((e,n)=>(0,a.jsx)("li",{style:{fontSize:16,marginBottom:12,color:"#991b1b"},children:e},n))})]}),(0,a.jsxs)("div",{style:{background:"white",border:"2px solid #e5e7eb",borderRadius:16,padding:24,marginBottom:24},children:[(0,a.jsx)("h3",{style:{fontSize:20,fontWeight:700,marginBottom:16},children:"An\xe1lise Geral"}),(0,a.jsx)("div",{style:{fontSize:16,lineHeight:1.8,color:"#374151",whiteSpace:"pre-wrap"},children:x.analysisText})]}),x.insights&&x.insights.length>0&&(0,a.jsxs)("div",{style:{background:"white",border:"2px solid #3b82f6",borderRadius:16,padding:24,marginBottom:24},children:[(0,a.jsx)("h3",{style:{fontSize:20,fontWeight:700,marginBottom:16,color:"#3b82f6"},children:"Insights Identificados"}),(0,a.jsx)("ul",{style:{paddingLeft:20,margin:0},children:x.insights.map((e,n)=>(0,a.jsx)("li",{style:{fontSize:16,marginBottom:12,color:"#374151"},children:e},n))})]}),x.recommendations&&x.recommendations.length>0&&(0,a.jsxs)("div",{style:{background:"white",border:"2px solid #10b981",borderRadius:16,padding:24,marginBottom:24},children:[(0,a.jsx)("h3",{style:{fontSize:20,fontWeight:700,marginBottom:16,color:"#10b981"},children:"Recomenda\xe7\xf5es Pr\xe1ticas"}),(0,a.jsx)("ul",{style:{paddingLeft:20,margin:0},children:x.recommendations.map((e,n)=>(0,a.jsx)("li",{style:{fontSize:16,marginBottom:12,color:"#374151"},children:e},n))})]})]}),_.length>1&&(0,a.jsxs)("div",{style:{background:"white",border:"2px solid #e5e7eb",borderRadius:16,padding:24,marginTop:32},children:[(0,a.jsx)("h3",{style:{fontSize:20,fontWeight:700,marginBottom:16},children:"Hist\xf3rico de An\xe1lises"}),(0,a.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:12},children:_.slice(1).map((e,n)=>(0,a.jsx)("button",{onClick:()=>w({analysisText:e.analysis_text,recommendations:e.recommendations,insights:e.insights,warnings:e.warnings,analysis_date:e.analysis_date}),style:{padding:16,background:"#f9fafb",border:"2px solid #e5e7eb",borderRadius:12,cursor:"pointer",textAlign:"left",fontSize:14},children:new Date(e.analysis_date).toLocaleDateString("pt-BR",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})},n))})]}),(0,a.jsx)("div",{style:{marginTop:32,padding:16,background:"#f9fafb",borderRadius:12,border:"1px solid #e5e7eb"},children:(0,a.jsx)("p",{style:{margin:0,fontSize:12,color:"#6b7280",textAlign:"center",lineHeight:1.6},children:"As informacoes sao geradas por inteligencia artificial e tem carater informativo. Nao substituem orientacao de nutricionistas ou medicos. Consulte um profissional de saude para orientacoes personalizadas."})})]})}},68398:function(e,n,o){"use strict";o.d(n,{Ob:function(){return h},sc:function(){return g},showRewardedAd:function(){return f},tJ:function(){return u}});var a=o(87185);let t="ca-app-pub-3940256099942544/2934735716",i="ca-app-pub-3940256099942544/1712485313",r=null,s=null,d=null,l=!1;async function c(){if(!r)try{let e=await o.e(124).then(o.bind(o,97124));r=e.AdMob||null,s=e.BannerAdSize||null,d=e.BannerAdPosition||null}catch(e){console.warn("[AdMob] Community plugin not available:",e),r=null}}async function u(){if(a.dV.isNativePlatform()&&!l){if(await c(),!r){l=!0;return}try{"function"==typeof r.initialize&&await r.initialize({})}catch(e){console.warn("[AdMob] init error (non-fatal):",e)}finally{l=!0}}}async function h(){if(!a.dV.isNativePlatform()){console.log("[AdMob] showTopBanner: not native platform, skipping");return}if(await u(),!r){console.warn("[AdMob] showTopBanner: admob not loaded");return}try{console.log("[AdMob] showTopBanner: calling showBanner with id:",t),await r.showBanner({adId:t,adSize:null==s?void 0:s.ADAPTIVE_BANNER,position:null==d?void 0:d.TOP_CENTER,margin:0}),console.log("[AdMob] showTopBanner: success")}catch(e){console.warn("[AdMob] showTopBanner failed:",e)}}async function g(){if(a.dV.isNativePlatform()&&(await u(),r))try{await r.removeBanner()}catch(e){console.warn("[AdMob] hideTopBanner failed:",e)}}async function f(e){if(!a.dV.isNativePlatform())return console.log("[AdMob] Not native, simulating rewarded ad for dev"),!0;if(await u(),!r)return console.warn("[AdMob] showRewardedAd: admob not loaded, allowing action"),!0;try{return console.log("[AdMob] showRewardedAd: preparing with id:",i),await r.prepareRewardVideoAd({adId:i}),console.log("[AdMob] showRewardedAd: showing..."),await r.showRewardVideoAd(),console.log("[AdMob] showRewardedAd: completed successfully"),!0}catch(e){return console.warn("[AdMob] showRewardedAd failed:",e),!1}}},45224:function(e,n,o){"use strict";o.d(n,{p:function(){return i},q:function(){return t}});var a=o(68398);async function t(e,n){console.log("[AdGuard] Starting request for feature:",null==n?void 0:n.feature);let o=await e();if(console.log("[AdGuard] First request status:",o.status),403!==o.status)return console.log("[AdGuard] Not 403, returning response"),o;try{let t=await o.clone().json().catch(()=>({}));if(console.log("[AdGuard] 403 payload:",t),(null==t?void 0:t.error)==="watch_ad_required"){if(console.log("[AdGuard] watch_ad_required detected, currentPlan:",null==t?void 0:t.currentPlan),!(null==n?void 0:n.skipConfirmation)&&!window.confirm("Este recurso requer assistir a um an\xfancio curto para continuar. Deseja prosseguir?"))return console.log("[AdGuard] User cancelled ad"),new Response(JSON.stringify({error:"ad_cancelled"}),{status:499,headers:{"Content-Type":"application/json"}});console.log("[AdGuard] Showing rewarded ad...");let o=await (0,a.showRewardedAd)(null==n?void 0:n.feature);if(console.log("[AdGuard] Ad result:",o),!o)return console.log("[AdGuard] Ad failed, returning 503"),new Response(JSON.stringify({error:"ad_failed"}),{status:503,headers:{"Content-Type":"application/json"}});console.log("[AdGuard] Ad success, retrying with x-ad-completed header");let i=await e({"x-ad-completed":"1"});return console.log("[AdGuard] Retry response status:",i.status),i}}catch(e){console.error("[AdGuard] Error:",e)}return o}function i(e,n){if(499===e.status&&(null==n?void 0:n.error)==="ad_cancelled")return null;if(503===e.status&&(null==n?void 0:n.error)==="ad_failed")return"N\xe3o foi poss\xedvel carregar o an\xfancio. Por favor, tente novamente em alguns instantes.";if(403===e.status){if((null==n?void 0:n.error)==="watch_ad_required")return"An\xfancio indispon\xedvel no momento. Tente novamente.";null==n||n.error}return null}},16463:function(e,n,o){"use strict";var a=o(71169);o.o(a,"usePathname")&&o.d(n,{usePathname:function(){return a.usePathname}}),o.o(a,"useRouter")&&o.d(n,{useRouter:function(){return a.useRouter}}),o.o(a,"useSearchParams")&&o.d(n,{useSearchParams:function(){return a.useSearchParams}})}},function(e){e.O(0,[325,78,971,23,744],function(){return e(e.s=18784)}),_N_E=e.O()}]);