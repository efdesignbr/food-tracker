(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[882,398],{51104:function(e,t,i){Promise.resolve().then(i.bind(i,17726))},17726:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return f}});var o=i(57437),n=i(2265),a=i(35087),r=i(45591),s=i(45224),l=i(86394),d=i(68398);let c={breakfast:{label:"Caf\xe9 da Manh\xe3",icon:"",color:"#f59e0b"},lunch:{label:"Almo\xe7o",icon:"",color:"#10b981"},dinner:{label:"Jantar",icon:"",color:"#6366f1"},snack:{label:"Lanche",icon:"",color:"#ec4899"}},g={week:{label:"7 dias",icon:""},month:{label:"30 dias",icon:""},all:{label:"Tudo",icon:""},custom:{label:"Personalizado",icon:""}};function h(e){let[t,i,o]=e.split("-").map(Number);return new Date(t,(i||1)-1,o||1)}function f(){let{plan:e}=(0,l.R)(),[t,i]=(0,n.useState)(!1),[f,u]=(0,n.useState)([]),[m,y]=(0,n.useState)([]),[x,p]=(0,n.useState)(!0),[b,j]=(0,n.useState)(null),[v,S]=(0,n.useState)("week"),[w,z]=(0,n.useState)(""),[_,D]=(0,n.useState)(""),[B,k]=(0,n.useState)({calories:2e3,protein:150,carbs:250,fat:65,water:2e3}),[R,W]=(0,n.useState)(null),[A,C]=(0,n.useState)(!1),[M,F]=(0,n.useState)(null),[P,T]=(0,n.useState)(!1);(0,n.useEffect)(()=>{!async function(){try{p(!0);let[e,t,i]=await Promise.all([r.h.get("/api/meals"),r.h.get("/api/user/profile"),r.h.get("/api/water-intake?history=true")]);if(!e.ok)throw Error("Erro ao buscar refei\xe7\xf5es");let o=await e.json();if(u(o.meals||[]),i.ok){let e=await i.json();y(e.history||[])}if(t.ok){let e=await t.json();k(e.user.goals)}}catch(e){j(e.message)}finally{p(!1)}}()},[]);let E=(0,n.useMemo)(()=>(function(e,t,i,o){if("all"===t)return e;if("custom"===t&&i&&o)return e.filter(e=>{let t=new Date(e.consumed_at);return t>=i&&t<=o});let n=new Date;switch(t){case"week":n.setDate(n.getDate()-7);break;case"month":n.setDate(n.getDate()-30)}return e.filter(e=>new Date(e.consumed_at)>=n)})(f,v,w?h(w):void 0,_?h(_):void 0),[f,v,w,_]),I=(0,n.useMemo)(()=>{if("all"===v)return m;if("custom"===v&&w&&_)return m.filter(e=>e.date>=w&&e.date<=_);let e=new Date;return"week"===v?e.setDate(e.getDate()-7):"month"===v&&e.setDate(e.getDate()-30),m.filter(t=>t.date>=(0,a.YX)(e))},[m,v,w,_]),V=(0,n.useMemo)(()=>{let e;let t=E.length,i=E.reduce((e,t)=>e+t.foods.reduce((e,t)=>e+(t.calories||0),0),0),o=E.reduce((e,t)=>e+t.foods.reduce((e,t)=>e+(t.protein_g||0),0),0),n=E.reduce((e,t)=>e+t.foods.reduce((e,t)=>e+(t.carbs_g||0),0),0),a=E.reduce((e,t)=>e+t.foods.reduce((e,t)=>e+(t.fat_g||0),0),0),r=E.reduce((e,t)=>e+t.foods.reduce((e,t)=>e+(t.fiber_g||0),0),0),s=E.reduce((e,t)=>e+t.foods.reduce((e,t)=>e+(t.sodium_mg||0),0),0),l=E.reduce((e,t)=>e+t.foods.reduce((e,t)=>e+(t.sugar_g||0),0),0),d=E.reduce((e,t)=>e+t.foods.reduce((e,t)=>e+(t.cholesterol_mg||0),0),0),c=E.reduce((e,t)=>e+t.foods.reduce((e,t)=>e+(t.saturated_fat_g||0),0),0),g=E.reduce((e,t)=>e+t.foods.reduce((e,t)=>e+(t.calcium_mg||0),0),0),f=E.reduce((e,t)=>e+t.foods.reduce((e,t)=>e+(t.magnesium_mg||0),0),0),u=E.reduce((e,t)=>e+t.foods.reduce((e,t)=>e+(t.phosphorus_mg||0),0),0),m=E.reduce((e,t)=>e+t.foods.reduce((e,t)=>e+(t.iron_mg||0),0),0),y=E.reduce((e,t)=>e+t.foods.reduce((e,t)=>e+(t.potassium_mg||0),0),0),x=E.reduce((e,t)=>e+t.foods.reduce((e,t)=>e+(t.zinc_mg||0),0),0),p=E.reduce((e,t)=>e+t.foods.reduce((e,t)=>e+(t.copper_mg||0),0),0),b=E.reduce((e,t)=>e+t.foods.reduce((e,t)=>e+(t.manganese_mg||0),0),0),j=E.reduce((e,t)=>e+t.foods.reduce((e,t)=>e+(t.vitamin_c_mg||0),0),0),S=E.reduce((e,t)=>e+t.foods.reduce((e,t)=>e+(t.vitamin_a_mcg||0),0),0),z=E.reduce((e,t)=>e+t.foods.reduce((e,t)=>e+(t.vitamin_b1_mg||0),0),0),D=E.reduce((e,t)=>e+t.foods.reduce((e,t)=>e+(t.vitamin_b2_mg||0),0),0),B=E.reduce((e,t)=>e+t.foods.reduce((e,t)=>e+(t.vitamin_b3_mg||0),0),0),k=E.reduce((e,t)=>e+t.foods.reduce((e,t)=>e+(t.vitamin_b6_mg||0),0),0),R={};E.forEach(e=>{let t=e.foods.reduce((e,t)=>e+(t.calories||0),0);R[e.meal_type]||(R[e.meal_type]={total:0,count:0}),R[e.meal_type].total+=t,R[e.meal_type].count+=1});let W={};E.forEach(e=>{e.foods.forEach(e=>{let t=e.name.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\b(natural|desnatado|integral|light|zero|diet)\b/gi,"").replace(/\s+/g," ").trim();t.endsWith("s")&&!t.endsWith("ss")&&(t=t.slice(0,-1)),W[t]=(W[t]||0)+1})});let A=Object.entries(W).sort((e,t)=>{let[,i]=e,[,o]=t;return o-i}).slice(0,10),C=new Map;E.forEach(e=>{let t=new Date(e.consumed_at).toLocaleDateString("pt-BR"),i=e.foods.reduce((e,t)=>e+(t.calories||0),0);C.set(t,(C.get(t)||0)+i)});let M=[],F=new Date;"custom"===v&&w&&_?(e=h(w),F=h(_)):"week"===v?(e=new Date).setDate(e.getDate()-6):"month"===v?(e=new Date).setDate(e.getDate()-29):(e=new Date).setDate(e.getDate()-6);let P=Math.ceil((F.getTime()-e.getTime())/864e5);for(let e=Math.min(P+1,30)-1;e>=0;e--){let t=new Date(F);t.setDate(t.getDate()-e);let i=t.toLocaleDateString("pt-BR");M.push({date:i,dateObj:t,calories:C.get(i)||0})}let T=C.size>0?Array.from(C.values()).reduce((e,t)=>e+t,0)/C.size:0,V=I.reduce((e,t)=>e+t.total_ml,0),N=I.length>0?V/I.length:0,L=I.filter(e=>e.total_ml>0).length,O={home:0,out:0},H={};return E.forEach(e=>{"out"===e.location_type?(O.out+=1,e.restaurant_name&&(H[e.restaurant_name]=(H[e.restaurant_name]||0)+1)):O.home+=1}),{totalMeals:t,totalCalories:i,totalProtein:o,totalCarbs:n,totalFat:a,totalFiber:r,totalSodium:s,totalSugar:l,avgCaloriesPerMeal:t>0?i/t:0,avgCaloriesPerDay:T,caloriesByType:R,topFoods:A,last7Days:M,totalWater:V,avgWaterPerDay:N,daysWithWater:L,locationCounts:O,topRestaurants:Object.entries(H).sort((e,t)=>t[1]-e[1]).slice(0,5),totalCholesterol:d,totalSaturatedFat:c,totalCalcium:g,totalMagnesium:f,totalPhosphorus:u,totalIron:m,totalPotassium:y,totalZinc:x,totalCopper:p,totalManganese:b,totalVitaminC:j,totalVitaminA:S,totalVitaminB1:z,totalVitaminB2:D,totalVitaminB3:B,totalVitaminB6:k}},[E,I,v,w,_]),N=async()=>{if(0===E.length){F("Nenhuma refei\xe7\xe3o dispon\xedvel para an\xe1lise");return}try{let e,t;if(C(!0),F(null),"custom"===v&&w&&_)e=w,t=_;else{let i=new Date;switch(v){case"week":i.setDate(i.getDate()-7);break;case"month":i.setDate(i.getDate()-30);break;case"all":if(f.length>0){let e=f.reduce((e,t)=>new Date(t.consumed_at)<new Date(e.consumed_at)?t:e);i.setTime(new Date(e.consumed_at).getTime())}}e=(0,a.YX)(i),t=(0,a.xk)()}let i=await (0,s.q)(i=>fetch("/api/reports/analysis",{method:"POST",headers:{"Content-Type":"application/json",...i||{}},body:JSON.stringify({start_date:e,end_date:t,goals:B})}),{feature:"ai_reports"});if(!i.ok){let e=await i.json();throw Error(e.error||"Erro ao analisar per\xedodo")}let o=await i.json();W(o.analysis),T(!0)}catch(e){F(e.message||"Erro ao solicitar an\xe1lise")}finally{C(!1)}};return x?(0,o.jsx)("div",{style:{padding:24,maxWidth:1200,margin:"0 auto"},children:(0,o.jsxs)("div",{style:{textAlign:"center",padding:48},children:[(0,o.jsx)("div",{style:{fontSize:48,marginBottom:16}}),(0,o.jsx)("p",{style:{color:"#666",fontSize:16},children:"Carregando..."})]})}):b?(0,o.jsx)("div",{style:{padding:24,maxWidth:1200,margin:"0 auto"},children:(0,o.jsxs)("div",{style:{padding:24,background:"#fee2e2",border:"2px solid #ef4444",borderRadius:12,textAlign:"center"},children:[(0,o.jsx)("div",{style:{fontSize:48,marginBottom:8}}),(0,o.jsx)("p",{style:{color:"#991b1b",margin:0},children:b})]})}):(0,o.jsxs)("div",{style:{padding:16,maxWidth:1200,margin:"0 auto",paddingBottom:80},children:[(0,o.jsx)("h1",{style:{fontSize:28,fontWeight:700,marginBottom:16},children:" Relat\xf3rios"}),(0,o.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:8,marginBottom:16},children:Object.keys(g).map(e=>(0,o.jsxs)("button",{onClick:()=>{S(e),"custom"!==e&&(T(!1),W(null))},style:{padding:"12px 8px",border:"none",background:v===e?"#2196F3":"white",color:v===e?"white":"#666",borderRadius:12,fontWeight:600,fontSize:14,cursor:"pointer",boxShadow:v===e?"0 4px 12px rgba(33, 150, 243, 0.3)":"0 2px 4px rgba(0,0,0,0.1)",transition:"all 0.2s",display:"flex",flexDirection:"column",alignItems:"center",gap:4},children:[(0,o.jsx)("span",{style:{fontSize:18},children:g[e].icon}),(0,o.jsx)("span",{children:g[e].label})]},e))}),"custom"===v&&(0,o.jsxs)("div",{style:{background:"white",borderRadius:12,padding:16,marginBottom:16,boxShadow:"0 2px 8px rgba(0,0,0,0.1)",border:"2px solid #2196F3"},children:[(0,o.jsx)("div",{style:{marginBottom:12,fontWeight:600,color:"#374151",fontSize:14},children:"Selecione o Per\xedodo"}),(0,o.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[(0,o.jsxs)("div",{style:{width:"100%"},children:[(0,o.jsx)("label",{style:{display:"block",fontSize:12,color:"#666",marginBottom:4},children:"Data Inicial"}),(0,o.jsx)("input",{type:"date",value:w,onChange:e=>z(e.target.value),style:{appearance:"none",WebkitAppearance:"none",display:"block",width:"100%",boxSizing:"border-box",padding:"10px 12px",margin:0,borderRadius:8,border:"1px solid #d1d5db",backgroundColor:"white",fontSize:16,color:"#374151",minHeight:44}})]}),(0,o.jsxs)("div",{style:{width:"100%"},children:[(0,o.jsx)("label",{style:{display:"block",fontSize:12,color:"#666",marginBottom:4},children:"Data Final"}),(0,o.jsx)("input",{type:"date",value:_,onChange:e=>D(e.target.value),style:{appearance:"none",WebkitAppearance:"none",display:"block",width:"100%",boxSizing:"border-box",padding:"10px 12px",margin:0,borderRadius:8,border:"1px solid #d1d5db",backgroundColor:"white",fontSize:16,color:"#374151",minHeight:44}})]})]})]}),E.length>0&&(0,o.jsx)("button",{onClick:N,disabled:A,style:{width:"100%",padding:"16px",border:"none",background:A?"#9ca3af":"linear-gradient(135deg, #8b5cf6 0%, #6366f1 100%)",color:"white",borderRadius:12,fontWeight:700,fontSize:16,cursor:A?"not-allowed":"pointer",boxShadow:"0 4px 12px rgba(139, 92, 246, 0.3)",transition:"all 0.2s",marginBottom:24,display:"flex",alignItems:"center",justifyContent:"center",gap:8},children:A?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("span",{}),(0,o.jsx)("span",{children:"Analisando com IA..."})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("span",{}),(0,o.jsx)("span",{children:"Analisar Per\xedodo com IA"})]})}),M&&(0,o.jsx)("div",{style:{padding:16,background:"#fee2e2",border:"2px solid #ef4444",borderRadius:12,marginBottom:24,color:"#991b1b",fontSize:14},children:M}),P&&R&&(0,o.jsxs)("div",{style:{background:"white",borderRadius:16,padding:20,marginBottom:24,boxShadow:"0 4px 16px rgba(139, 92, 246, 0.2)",border:"2px solid #8b5cf6"},children:[(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[(0,o.jsx)("h2",{style:{fontSize:20,fontWeight:700,color:"#8b5cf6",margin:0},children:"An\xe1lise da IA"}),(0,o.jsx)("button",{onClick:()=>T(!1),style:{background:"none",border:"none",fontSize:20,cursor:"pointer",color:"#9ca3af",padding:4}})]}),(0,o.jsxs)("div",{style:{padding:16,background:"#f3f4f6",borderRadius:12,marginBottom:16,borderLeft:"4px solid #8b5cf6"},children:[(0,o.jsx)("div",{style:{fontWeight:600,fontSize:14,color:"#374151",marginBottom:8},children:"Resumo"}),(0,o.jsx)("p",{style:{margin:0,fontSize:14,color:"#4b5563",lineHeight:1.6},children:R.summary})]}),(0,o.jsxs)("div",{style:{display:"grid",gap:12,marginBottom:16},children:[(0,o.jsxs)("div",{style:{padding:14,background:"#fef3c7",borderRadius:8},children:[(0,o.jsx)("div",{style:{fontWeight:600,fontSize:13,color:"#92400e",marginBottom:6},children:"Balan\xe7o Cal\xf3rico"}),(0,o.jsx)("p",{style:{margin:0,fontSize:13,color:"#78350f",lineHeight:1.5},children:R.caloric_balance})]}),(0,o.jsxs)("div",{style:{padding:14,background:"#dbeafe",borderRadius:8},children:[(0,o.jsx)("div",{style:{fontWeight:600,fontSize:13,color:"#1e40af",marginBottom:6},children:"Macronutrientes"}),(0,o.jsx)("p",{style:{margin:0,fontSize:13,color:"#1e3a8a",lineHeight:1.5},children:R.macronutrient_distribution})]}),(0,o.jsxs)("div",{style:{padding:14,background:"#fee2e2",borderRadius:8},children:[(0,o.jsx)("div",{style:{fontWeight:600,fontSize:13,color:"#991b1b",marginBottom:6},children:"Alimentos Inflamat\xf3rios"}),(0,o.jsx)("p",{style:{margin:0,fontSize:13,color:"#7f1d1d",lineHeight:1.5},children:R.inflammatory_foods})]}),(0,o.jsxs)("div",{style:{padding:14,background:"#dcfce7",borderRadius:8},children:[(0,o.jsx)("div",{style:{fontWeight:600,fontSize:13,color:"#166534",marginBottom:6},children:"Regularidade das Refei\xe7\xf5es"}),(0,o.jsx)("p",{style:{margin:0,fontSize:13,color:"#14532d",lineHeight:1.5},children:R.meal_regularity})]}),(0,o.jsxs)("div",{style:{padding:14,background:"#e0f2fe",borderRadius:8},children:[(0,o.jsx)("div",{style:{fontWeight:600,fontSize:13,color:"#075985",marginBottom:6},children:"Hidrata\xe7\xe3o"}),(0,o.jsx)("p",{style:{margin:0,fontSize:13,color:"#0c4a6e",lineHeight:1.5},children:R.hydration})]})]}),(0,o.jsxs)("div",{style:{padding:16,background:"#f0fdf4",borderRadius:12,border:"2px solid #10b981"},children:[(0,o.jsx)("div",{style:{fontWeight:600,fontSize:14,color:"#166534",marginBottom:10},children:"Sugest\xf5es de Melhoria"}),(0,o.jsx)("ul",{style:{margin:0,paddingLeft:20,fontSize:13,color:"#14532d",lineHeight:1.7},children:R.suggestions.map((e,t)=>(0,o.jsx)("li",{style:{marginBottom:6},children:e},t))})]}),(0,o.jsx)("p",{style:{margin:"16px 0 0 0",fontSize:11,color:"#9ca3af",textAlign:"center",lineHeight:1.5},children:"Analise gerada por inteligencia artificial. Nao substitui orientacao de profissionais de saude."})]}),E.length>0?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(140px, 1fr))",gap:12,marginBottom:24},children:[(0,o.jsxs)("div",{style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:16,borderRadius:12,color:"white"},children:[(0,o.jsx)("div",{style:{fontSize:12,opacity:.9},children:"Refei\xe7\xf5es"}),(0,o.jsx)("div",{style:{fontSize:28,fontWeight:700},children:V.totalMeals})]}),(0,o.jsxs)("div",{style:{background:"linear-gradient(135deg, #f093fb 0%, #f5576c 100%)",padding:16,borderRadius:12,color:"white"},children:[(0,o.jsx)("div",{style:{fontSize:12,opacity:.9},children:"Total"}),(0,o.jsx)("div",{style:{fontSize:28,fontWeight:700},children:V.totalCalories.toFixed(0)}),(0,o.jsx)("div",{style:{fontSize:11,opacity:.8},children:"kcal"})]}),(0,o.jsxs)("div",{style:{background:"linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)",padding:16,borderRadius:12,color:"white"},children:[(0,o.jsx)("div",{style:{fontSize:12,opacity:.9},children:"M\xe9dia/Ref"}),(0,o.jsx)("div",{style:{fontSize:28,fontWeight:700},children:V.avgCaloriesPerMeal.toFixed(0)}),(0,o.jsx)("div",{style:{fontSize:11,opacity:.8},children:"kcal"})]}),(0,o.jsxs)("div",{style:{background:"linear-gradient(135deg, #fa709a 0%, #fee140 100%)",padding:16,borderRadius:12,color:"white"},children:[(0,o.jsx)("div",{style:{fontSize:12,opacity:.9},children:"M\xe9dia/Dia"}),(0,o.jsx)("div",{style:{fontSize:28,fontWeight:700},children:V.avgCaloriesPerDay.toFixed(0)}),(0,o.jsx)("div",{style:{fontSize:11,opacity:.8},children:"kcal"})]}),(0,o.jsxs)("div",{style:{background:"linear-gradient(135deg, #06b6d4 0%, #0891b2 100%)",padding:16,borderRadius:12,color:"white"},children:[(0,o.jsx)("div",{style:{fontSize:12,opacity:.9},children:" \xc1gua Total"}),(0,o.jsxs)("div",{style:{fontSize:28,fontWeight:700},children:[(V.totalWater/1e3).toFixed(1),"L"]}),(0,o.jsxs)("div",{style:{fontSize:11,opacity:.8},children:[V.daysWithWater," dias"]})]})]}),("free"!==e||t)&&(0,o.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(320px, 1fr))",gap:20,marginBottom:24,alignItems:"stretch"},children:[(0,o.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,o.jsx)("h2",{style:{fontSize:18,fontWeight:700,marginBottom:16,color:"#374151"},children:"Nutrientes no Per\xedodo"}),"free"===e&&!t&&(0,o.jsxs)("div",{style:{padding:12,background:"#fef3c7",border:"1px solid #fcd34d",borderRadius:8,marginBottom:12},children:[(0,o.jsx)("div",{style:{fontSize:13,color:"#92400e",marginBottom:8},children:"Para ver detalhes completos deste per\xedodo, assista a um an\xfancio."}),(0,o.jsx)("button",{onClick:async()=>{await (0,d.showRewardedAd)("reports_extra")&&i(!0)},style:{padding:"8px 12px",background:"#fbbf24",color:"#92400e",border:"none",borderRadius:8,fontWeight:700,cursor:"pointer"},children:"Desbloquear com an\xfancio"})]}),(0,o.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:10,marginBottom:12,flex:1},children:[(0,o.jsxs)("div",{style:{background:"linear-gradient(to top, #16a34a ".concat(Math.min(V.totalProtein/(B.protein*V.last7Days.length)*100,100),"%, #6b7280 ").concat(Math.min(V.totalProtein/(B.protein*V.last7Days.length)*100,100),"%)"),borderRadius:10,padding:12,textAlign:"center"},children:[(0,o.jsx)("div",{style:{fontSize:11,color:"white",marginBottom:4,fontWeight:600},children:"Prote\xedna"}),(0,o.jsxs)("div",{style:{fontSize:18,fontWeight:700,color:"white"},children:[V.totalProtein.toFixed(0),"g"]}),(0,o.jsxs)("div",{style:{fontSize:10,color:"rgba(255,255,255,0.8)"},children:["Meta: ",B.protein*V.last7Days.length,"g"]})]}),(0,o.jsxs)("div",{style:{background:"linear-gradient(to top, #16a34a ".concat(Math.min(V.totalCarbs/(B.carbs*V.last7Days.length)*100,100),"%, #6b7280 ").concat(Math.min(V.totalCarbs/(B.carbs*V.last7Days.length)*100,100),"%)"),borderRadius:10,padding:12,textAlign:"center"},children:[(0,o.jsx)("div",{style:{fontSize:11,color:"white",marginBottom:4,fontWeight:600},children:"Carbos"}),(0,o.jsxs)("div",{style:{fontSize:18,fontWeight:700,color:"white"},children:[V.totalCarbs.toFixed(0),"g"]}),(0,o.jsxs)("div",{style:{fontSize:10,color:"rgba(255,255,255,0.8)"},children:["Meta: ",B.carbs*V.last7Days.length,"g"]})]}),(0,o.jsxs)("div",{style:{background:"linear-gradient(to top, #16a34a ".concat(Math.min(V.totalFat/(B.fat*V.last7Days.length)*100,100),"%, #6b7280 ").concat(Math.min(V.totalFat/(B.fat*V.last7Days.length)*100,100),"%)"),borderRadius:10,padding:12,textAlign:"center"},children:[(0,o.jsx)("div",{style:{fontSize:11,color:"white",marginBottom:4,fontWeight:600},children:"Gorduras"}),(0,o.jsxs)("div",{style:{fontSize:18,fontWeight:700,color:"white"},children:[V.totalFat.toFixed(0),"g"]}),(0,o.jsxs)("div",{style:{fontSize:10,color:"rgba(255,255,255,0.8)"},children:["Meta: ",B.fat*V.last7Days.length,"g"]})]}),(0,o.jsxs)("div",{style:{background:"linear-gradient(to top, #16a34a ".concat(Math.min(V.totalFiber/(25*V.last7Days.length)*100,100),"%, #6b7280 ").concat(Math.min(V.totalFiber/(25*V.last7Days.length)*100,100),"%)"),borderRadius:10,padding:12,textAlign:"center"},children:[(0,o.jsx)("div",{style:{fontSize:11,color:"white",marginBottom:4,fontWeight:600},children:"Fibras"}),(0,o.jsxs)("div",{style:{fontSize:18,fontWeight:700,color:"white"},children:[V.totalFiber.toFixed(0),"g"]}),(0,o.jsxs)("div",{style:{fontSize:10,color:"rgba(255,255,255,0.8)"},children:["Meta: ",25*V.last7Days.length,"g"]})]}),(0,o.jsxs)("div",{style:{background:"linear-gradient(to top, #dc2626 ".concat(Math.min(V.totalSugar/(50*V.last7Days.length)*100,100),"%, #6b7280 ").concat(Math.min(V.totalSugar/(50*V.last7Days.length)*100,100),"%)"),borderRadius:10,padding:12,textAlign:"center"},children:[(0,o.jsx)("div",{style:{fontSize:11,color:"white",marginBottom:4,fontWeight:600},children:"A\xe7\xfacar"}),(0,o.jsxs)("div",{style:{fontSize:18,fontWeight:700,color:"white"},children:[V.totalSugar.toFixed(0),"g"]}),(0,o.jsxs)("div",{style:{fontSize:10,color:"rgba(255,255,255,0.8)"},children:["Limite: ",50*V.last7Days.length,"g"]})]}),(0,o.jsxs)("div",{style:{background:"linear-gradient(to top, #dc2626 ".concat(Math.min(V.totalSodium/(2300*V.last7Days.length)*100,100),"%, #6b7280 ").concat(Math.min(V.totalSodium/(2300*V.last7Days.length)*100,100),"%)"),borderRadius:10,padding:12,textAlign:"center"},children:[(0,o.jsx)("div",{style:{fontSize:11,color:"white",marginBottom:4,fontWeight:600},children:"S\xf3dio"}),(0,o.jsxs)("div",{style:{fontSize:18,fontWeight:700,color:"white"},children:[(V.totalSodium/1e3).toFixed(1),"g"]}),(0,o.jsxs)("div",{style:{fontSize:10,color:"rgba(255,255,255,0.8)"},children:["Limite: ",(2300*V.last7Days.length/1e3).toFixed(1),"g"]})]})]}),(0,o.jsx)("div",{style:{background:"linear-gradient(to top, #0891b2 ".concat(Math.min(V.avgWaterPerDay/B.water*100,100),"%, #9ca3af ").concat(Math.min(V.avgWaterPerDay/B.water*100,100),"%)"),borderRadius:10,padding:12},children:(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("div",{style:{fontSize:11,color:"white",marginBottom:4,fontWeight:600},children:"\xc1gua"}),(0,o.jsxs)("div",{style:{fontSize:18,fontWeight:700,color:"white"},children:[(V.totalWater/1e3).toFixed(1),"L total"]})]}),(0,o.jsxs)("div",{style:{textAlign:"right"},children:[(0,o.jsxs)("div",{style:{fontSize:14,fontWeight:600,color:"white"},children:[V.avgWaterPerDay.toFixed(0),"ml/dia"]}),(0,o.jsxs)("div",{style:{fontSize:10,color:"rgba(255,255,255,0.8)"},children:["Meta: ",B.water,"ml/dia"]})]})]})})]}),(0,o.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,o.jsx)("h2",{style:{fontSize:18,fontWeight:700,marginBottom:16,color:"#374151"},children:"Calorias por Tipo de Refei\xe7\xe3o"}),(0,o.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:10,flex:1,justifyContent:"space-between"},children:Object.entries(V.caloriesByType).map(e=>{let[t,i]=e,n=c[t]||c.lunch,a=i.total/i.count;return(0,o.jsxs)("div",{style:{padding:14,background:"#f9fafb",borderRadius:10,border:"1px solid #e5e7eb",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10},children:[(0,o.jsx)("span",{style:{fontSize:22},children:n.icon}),(0,o.jsxs)("div",{children:[(0,o.jsx)("div",{style:{fontWeight:600,fontSize:14,color:n.color},children:n.label}),(0,o.jsxs)("div",{style:{fontSize:11,color:"#6b7280"},children:[i.count," refei\xe7\xf5es"]})]})]}),(0,o.jsxs)("div",{style:{textAlign:"right"},children:[(0,o.jsxs)("div",{style:{fontSize:18,fontWeight:700,color:n.color},children:[i.total.toFixed(0)," kcal"]}),(0,o.jsxs)("div",{style:{fontSize:11,color:"#6b7280"},children:["~",a.toFixed(0)," kcal/ref"]})]})]},t)})})]})]}),(0,o.jsxs)("div",{style:{marginBottom:24},children:[(0,o.jsxs)("h2",{style:{fontSize:18,fontWeight:700,marginBottom:4,color:"#374151"},children:["Evolu\xe7\xe3o (",V.last7Days.length," dias)"]}),(0,o.jsxs)("div",{style:{fontSize:12,color:"#6b7280",marginBottom:16},children:["Meta: ",B.calories," kcal/dia"]}),(0,o.jsxs)("div",{style:{position:"relative",height:200},children:[(0,o.jsx)("div",{style:{position:"absolute",bottom:164,left:0,right:0,borderTop:"2px dashed #9ca3af",opacity:.6}}),(0,o.jsx)("div",{style:{display:"flex",alignItems:"flex-end",justifyContent:"space-between",height:"100%",paddingBottom:24,gap:4},children:V.last7Days.map((e,t)=>{let i=B.calories>0?Math.round(e.calories/B.calories*140):0,n=e.calories>B.calories;return(0,o.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",flex:1},children:[e.calories>0&&(0,o.jsx)("div",{style:{fontSize:9,fontWeight:600,color:n?"#ef4444":"#10b981",marginBottom:2},children:e.calories.toFixed(0)}),(0,o.jsx)("div",{style:{width:"100%",height:Math.min(i,160),background:0===e.calories?"#e5e7eb":n?"#ef4444":"#10b981",borderRadius:"3px 3px 0 0",minHeight:e.calories>0?8:4}}),(0,o.jsx)("div",{style:{fontSize:9,color:"#6b7280",marginTop:4,textAlign:"center",fontWeight:500},children:e.dateObj.toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit"})})]},t)})})]})]}),("free"!==e||t)&&(V.totalCalcium>0||V.totalIron>0||V.totalVitaminC>0||V.totalMagnesium>0||V.totalPotassium>0||V.totalZinc>0)&&(0,o.jsxs)("div",{style:{background:"white",borderRadius:16,padding:20,marginBottom:24,boxShadow:"0 2px 8px rgba(0,0,0,0.1)",border:"1px solid #e5e7eb"},children:[(0,o.jsx)("h2",{style:{fontSize:18,fontWeight:700,marginBottom:16,color:"#374151"},children:"Micronutrientes no Per\xedodo"}),(0,o.jsxs)("div",{style:{marginBottom:16},children:[(0,o.jsx)("div",{style:{fontSize:12,fontWeight:600,color:"#6b7280",marginBottom:8},children:"Minerais"}),(0,o.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:8},children:[V.totalCalcium>0&&(0,o.jsxs)("div",{style:{background:"#fef3c7",padding:10,borderRadius:8,textAlign:"center"},children:[(0,o.jsx)("div",{style:{fontSize:10,color:"#92400e",marginBottom:2},children:"C\xe1lcio"}),(0,o.jsxs)("div",{style:{fontSize:16,fontWeight:700,color:"#b45309"},children:[V.totalCalcium.toFixed(0),"mg"]}),(0,o.jsxs)("div",{style:{fontSize:9,color:"#92400e"},children:["Meta: ",1e3*V.last7Days.length,"mg"]})]}),V.totalIron>0&&(0,o.jsxs)("div",{style:{background:"#fee2e2",padding:10,borderRadius:8,textAlign:"center"},children:[(0,o.jsx)("div",{style:{fontSize:10,color:"#991b1b",marginBottom:2},children:"Ferro"}),(0,o.jsxs)("div",{style:{fontSize:16,fontWeight:700,color:"#dc2626"},children:[V.totalIron.toFixed(1),"mg"]}),(0,o.jsxs)("div",{style:{fontSize:9,color:"#991b1b"},children:["Meta: ",14*V.last7Days.length,"mg"]})]}),V.totalMagnesium>0&&(0,o.jsxs)("div",{style:{background:"#d1fae5",padding:10,borderRadius:8,textAlign:"center"},children:[(0,o.jsx)("div",{style:{fontSize:10,color:"#065f46",marginBottom:2},children:"Magn\xe9sio"}),(0,o.jsxs)("div",{style:{fontSize:16,fontWeight:700,color:"#059669"},children:[V.totalMagnesium.toFixed(0),"mg"]}),(0,o.jsxs)("div",{style:{fontSize:9,color:"#065f46"},children:["Meta: ",400*V.last7Days.length,"mg"]})]}),V.totalPhosphorus>0&&(0,o.jsxs)("div",{style:{background:"#e0e7ff",padding:10,borderRadius:8,textAlign:"center"},children:[(0,o.jsx)("div",{style:{fontSize:10,color:"#3730a3",marginBottom:2},children:"F\xf3sforo"}),(0,o.jsxs)("div",{style:{fontSize:16,fontWeight:700,color:"#4f46e5"},children:[V.totalPhosphorus.toFixed(0),"mg"]}),(0,o.jsxs)("div",{style:{fontSize:9,color:"#3730a3"},children:["Meta: ",700*V.last7Days.length,"mg"]})]}),V.totalPotassium>0&&(0,o.jsxs)("div",{style:{background:"#fce7f3",padding:10,borderRadius:8,textAlign:"center"},children:[(0,o.jsx)("div",{style:{fontSize:10,color:"#9d174d",marginBottom:2},children:"Pot\xe1ssio"}),(0,o.jsxs)("div",{style:{fontSize:16,fontWeight:700,color:"#db2777"},children:[(V.totalPotassium/1e3).toFixed(1),"g"]}),(0,o.jsxs)("div",{style:{fontSize:9,color:"#9d174d"},children:["Meta: ",(3500*V.last7Days.length/1e3).toFixed(1),"g"]})]}),V.totalZinc>0&&(0,o.jsxs)("div",{style:{background:"#cffafe",padding:10,borderRadius:8,textAlign:"center"},children:[(0,o.jsx)("div",{style:{fontSize:10,color:"#155e75",marginBottom:2},children:"Zinco"}),(0,o.jsxs)("div",{style:{fontSize:16,fontWeight:700,color:"#0891b2"},children:[V.totalZinc.toFixed(1),"mg"]}),(0,o.jsxs)("div",{style:{fontSize:9,color:"#155e75"},children:["Meta: ",11*V.last7Days.length,"mg"]})]}),V.totalCopper>0&&(0,o.jsxs)("div",{style:{background:"#fed7aa",padding:10,borderRadius:8,textAlign:"center"},children:[(0,o.jsx)("div",{style:{fontSize:10,color:"#9a3412",marginBottom:2},children:"Cobre"}),(0,o.jsxs)("div",{style:{fontSize:16,fontWeight:700,color:"#ea580c"},children:[V.totalCopper.toFixed(2),"mg"]}),(0,o.jsxs)("div",{style:{fontSize:9,color:"#9a3412"},children:["Meta: ",.9*V.last7Days.length,"mg"]})]}),V.totalManganese>0&&(0,o.jsxs)("div",{style:{background:"#f5d0fe",padding:10,borderRadius:8,textAlign:"center"},children:[(0,o.jsx)("div",{style:{fontSize:10,color:"#86198f",marginBottom:2},children:"Mangan\xeas"}),(0,o.jsxs)("div",{style:{fontSize:16,fontWeight:700,color:"#a21caf"},children:[V.totalManganese.toFixed(2),"mg"]}),(0,o.jsxs)("div",{style:{fontSize:9,color:"#86198f"},children:["Meta: ",2.3*V.last7Days.length,"mg"]})]})]})]}),(V.totalVitaminC>0||V.totalVitaminA>0||V.totalVitaminB1>0||V.totalVitaminB2>0||V.totalVitaminB3>0||V.totalVitaminB6>0)&&(0,o.jsxs)("div",{style:{marginBottom:16},children:[(0,o.jsx)("div",{style:{fontSize:12,fontWeight:600,color:"#6b7280",marginBottom:8},children:"Vitaminas"}),(0,o.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:8},children:[V.totalVitaminA>0&&(0,o.jsxs)("div",{style:{background:"#ffedd5",padding:10,borderRadius:8,textAlign:"center"},children:[(0,o.jsx)("div",{style:{fontSize:10,color:"#9a3412",marginBottom:2},children:"Vitamina A"}),(0,o.jsxs)("div",{style:{fontSize:16,fontWeight:700,color:"#ea580c"},children:[V.totalVitaminA.toFixed(0),"mcg"]}),(0,o.jsxs)("div",{style:{fontSize:9,color:"#9a3412"},children:["Meta: ",900*V.last7Days.length,"mcg"]})]}),V.totalVitaminC>0&&(0,o.jsxs)("div",{style:{background:"#fef9c3",padding:10,borderRadius:8,textAlign:"center"},children:[(0,o.jsx)("div",{style:{fontSize:10,color:"#854d0e",marginBottom:2},children:"Vitamina C"}),(0,o.jsxs)("div",{style:{fontSize:16,fontWeight:700,color:"#ca8a04"},children:[V.totalVitaminC.toFixed(0),"mg"]}),(0,o.jsxs)("div",{style:{fontSize:9,color:"#854d0e"},children:["Meta: ",90*V.last7Days.length,"mg"]})]}),V.totalVitaminB1>0&&(0,o.jsxs)("div",{style:{background:"#ecfccb",padding:10,borderRadius:8,textAlign:"center"},children:[(0,o.jsx)("div",{style:{fontSize:10,color:"#3f6212",marginBottom:2},children:"Vitamina B1"}),(0,o.jsxs)("div",{style:{fontSize:16,fontWeight:700,color:"#65a30d"},children:[V.totalVitaminB1.toFixed(2),"mg"]}),(0,o.jsxs)("div",{style:{fontSize:9,color:"#3f6212"},children:["Meta: ",1.2*V.last7Days.length,"mg"]})]}),V.totalVitaminB2>0&&(0,o.jsxs)("div",{style:{background:"#d9f99d",padding:10,borderRadius:8,textAlign:"center"},children:[(0,o.jsx)("div",{style:{fontSize:10,color:"#365314",marginBottom:2},children:"Vitamina B2"}),(0,o.jsxs)("div",{style:{fontSize:16,fontWeight:700,color:"#4d7c0f"},children:[V.totalVitaminB2.toFixed(2),"mg"]}),(0,o.jsxs)("div",{style:{fontSize:9,color:"#365314"},children:["Meta: ",1.3*V.last7Days.length,"mg"]})]}),V.totalVitaminB3>0&&(0,o.jsxs)("div",{style:{background:"#a7f3d0",padding:10,borderRadius:8,textAlign:"center"},children:[(0,o.jsx)("div",{style:{fontSize:10,color:"#14532d",marginBottom:2},children:"Vitamina B3"}),(0,o.jsxs)("div",{style:{fontSize:16,fontWeight:700,color:"#16a34a"},children:[V.totalVitaminB3.toFixed(1),"mg"]}),(0,o.jsxs)("div",{style:{fontSize:9,color:"#14532d"},children:["Meta: ",16*V.last7Days.length,"mg"]})]}),V.totalVitaminB6>0&&(0,o.jsxs)("div",{style:{background:"#99f6e4",padding:10,borderRadius:8,textAlign:"center"},children:[(0,o.jsx)("div",{style:{fontSize:10,color:"#134e4a",marginBottom:2},children:"Vitamina B6"}),(0,o.jsxs)("div",{style:{fontSize:16,fontWeight:700,color:"#0d9488"},children:[V.totalVitaminB6.toFixed(2),"mg"]}),(0,o.jsxs)("div",{style:{fontSize:9,color:"#134e4a"},children:["Meta: ",1.7*V.last7Days.length,"mg"]})]})]})]}),(V.totalCholesterol>0||V.totalSaturatedFat>0)&&(0,o.jsxs)("div",{children:[(0,o.jsx)("div",{style:{fontSize:12,fontWeight:600,color:"#6b7280",marginBottom:8},children:"Limites de Aten\xe7\xe3o"}),(0,o.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:8},children:[V.totalCholesterol>0&&(0,o.jsxs)("div",{style:{background:V.totalCholesterol>300*V.last7Days.length?"#fecaca":"#f3f4f6",padding:10,borderRadius:8,textAlign:"center",border:V.totalCholesterol>300*V.last7Days.length?"2px solid #ef4444":"1px solid #e5e7eb"},children:[(0,o.jsx)("div",{style:{fontSize:10,color:"#991b1b",marginBottom:2},children:"Colesterol"}),(0,o.jsxs)("div",{style:{fontSize:16,fontWeight:700,color:V.totalCholesterol>300*V.last7Days.length?"#ef4444":"#374151"},children:[V.totalCholesterol.toFixed(0),"mg"]}),(0,o.jsxs)("div",{style:{fontSize:9,color:"#991b1b"},children:["Limite: ",300*V.last7Days.length,"mg"]})]}),V.totalSaturatedFat>0&&(0,o.jsxs)("div",{style:{background:V.totalSaturatedFat>22*V.last7Days.length?"#fecaca":"#f3f4f6",padding:10,borderRadius:8,textAlign:"center",border:V.totalSaturatedFat>22*V.last7Days.length?"2px solid #ef4444":"1px solid #e5e7eb"},children:[(0,o.jsx)("div",{style:{fontSize:10,color:"#9f1239",marginBottom:2},children:"G. Saturada"}),(0,o.jsxs)("div",{style:{fontSize:16,fontWeight:700,color:V.totalSaturatedFat>22*V.last7Days.length?"#ef4444":"#374151"},children:[V.totalSaturatedFat.toFixed(1),"g"]}),(0,o.jsxs)("div",{style:{fontSize:9,color:"#9f1239"},children:["Limite: ",22*V.last7Days.length,"g"]})]})]})]})]}),(0,o.jsxs)("div",{style:{display:"grid",gap:16,marginBottom:24},children:[(0,o.jsxs)("div",{style:{background:"white",borderRadius:16,padding:20,boxShadow:"0 2px 8px rgba(0,0,0,0.1)",border:"1px solid #e5e7eb"},children:[(0,o.jsx)("h2",{style:{fontSize:18,fontWeight:700,marginBottom:12,color:"#374151"},children:"Locais das Refei\xe7\xf5es"}),(0,o.jsxs)("div",{style:{display:"flex",gap:12,marginBottom:12},children:[(0,o.jsxs)("div",{style:{flex:1,background:"#ecfdf5",border:"1px solid #d1fae5",borderRadius:12,padding:12},children:[(0,o.jsx)("div",{style:{fontSize:12,color:"#065f46",marginBottom:4},children:" Casa"}),(0,o.jsx)("div",{style:{fontSize:20,fontWeight:700,color:"#10b981"},children:V.locationCounts.home})]}),(0,o.jsxs)("div",{style:{flex:1,background:"#fffbeb",border:"1px solid #fde68a",borderRadius:12,padding:12},children:[(0,o.jsx)("div",{style:{fontSize:12,color:"#92400e",marginBottom:4},children:" Fora"}),(0,o.jsx)("div",{style:{fontSize:20,fontWeight:700,color:"#f59e0b"},children:V.locationCounts.out})]})]}),V.topRestaurants.length>0&&(0,o.jsxs)("div",{children:[(0,o.jsx)("div",{style:{fontSize:12,color:"#6b7280",marginBottom:6},children:"Top Restaurantes"}),(0,o.jsx)("div",{style:{display:"grid",gap:6},children:V.topRestaurants.map(e=>{let[t,i]=e;return(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px 10px",background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:8},children:[(0,o.jsx)("span",{style:{fontSize:14,color:"#374151"},children:t}),(0,o.jsxs)("span",{style:{fontSize:14,fontWeight:700,color:"#6b7280"},children:[i,"x"]})]},t)})})]})]}),V.topFoods.length>0&&(0,o.jsxs)("div",{style:{background:"white",borderRadius:16,padding:20,boxShadow:"0 2px 8px rgba(0,0,0,0.1)",border:"1px solid #e5e7eb"},children:[(0,o.jsx)("h2",{style:{fontSize:18,fontWeight:700,marginBottom:16,color:"#374151"},children:"\uD83C\uDFC6 Top 10 Alimentos Mais Consumidos"}),(0,o.jsx)("div",{style:{display:"grid",gap:8},children:V.topFoods.map((e,t)=>{let[i,n]=e;return(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 16px",background:t<3?"#fef3c7":"#f9fafb",borderRadius:8,border:t<3?"1px solid #fbbf24":"1px solid #e5e7eb"},children:[(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12},children:[(0,o.jsx)("span",{style:{fontSize:18,fontWeight:700,color:t<3?"#f59e0b":"#9ca3af",minWidth:24},children:0===t?"\uD83E\uDD47":1===t?"\uD83E\uDD48":2===t?"\uD83E\uDD49":"".concat(t+1,".")}),(0,o.jsx)("span",{style:{fontWeight:600,fontSize:15,textTransform:"capitalize",color:"#374151"},children:i})]}),(0,o.jsxs)("span",{style:{fontSize:16,fontWeight:700,color:t<3?"#f59e0b":"#6b7280"},children:[n,"x"]})]},i)})})]})]})]}):(0,o.jsxs)("div",{style:{textAlign:"center",padding:"48px 24px",background:"#f9fafb",borderRadius:16,border:"2px dashed #d1d5db"},children:[(0,o.jsx)("div",{style:{fontSize:64,marginBottom:16}}),(0,o.jsx)("h3",{style:{fontSize:18,fontWeight:600,marginBottom:8},children:"Nenhum dado neste per\xedodo"}),(0,o.jsx)("p",{style:{color:"#666",fontSize:14},children:"Tente selecionar outro per\xedodo ou capture uma refei\xe7\xe3o!"})]})]})}},86394:function(e,t,i){"use strict";i.d(t,{R:function(){return d}});var o=i(2265),n=i(87185),a=i(45591);async function r(){let e=await a.h.get("/api/user/profile");if(!e.ok)throw Error("Failed to fetch user plan: ".concat(e.status));let t=(await e.json()).user;return{plan:t.plan||"free",subscription_status:t.subscription_status||"active",subscription_started_at:t.subscription_started_at,subscription_expires_at:t.subscription_expires_at}}async function s(){let e=await a.h.get("/api/subscription/quota");if(!e.ok)throw Error("Failed to fetch quota usage: ".concat(e.status));return e.json()}async function l(){try{let{Purchases:e}=await i.e(938).then(i.bind(i,31938)),{customerInfo:t}=await e.getCustomerInfo();await a.h.post("/api/subscription/sync",{customerInfo:t}),console.log("[useUserPlan] Sync success")}catch(e){console.warn("[useUserPlan] Sync error:",e)}}function d(){let[e,t]=(0,o.useState)("free"),[i,a]=(0,o.useState)("active"),[d,c]=(0,o.useState)(null),[g,h]=(0,o.useState)(!0),[f,u]=(0,o.useState)(null),m=(0,o.useRef)(!1),y=async()=>{try{h(!0),u(null),n.dV.isNativePlatform()&&!m.current&&(m.current=!0,await l());let e=await r();if(t(e.plan),a(e.subscription_status),"premium"===e.plan){let e=await s(),t=function(e){var t;let i=e.photo_analyses/e.limits.photo_analyses_per_month*100,o=e.ocr_analyses/e.limits.ocr_analyses_per_month*100,n=e.text_analyses/e.limits.text_analyses_per_month*100,a=null===(t=e.limits)||void 0===t?void 0:t.report_analyses_per_month,r=e.report_analyses,s=new Date,l=new Date(s.getFullYear(),s.getMonth()+1,1);return{photo_analyses:{used:e.photo_analyses,limit:e.limits.photo_analyses_per_month,percentage:Math.round(i),remaining:e.limits.photo_analyses_per_month-e.photo_analyses},ocr_analyses:{used:e.ocr_analyses,limit:e.limits.ocr_analyses_per_month,percentage:Math.round(o),remaining:e.limits.ocr_analyses_per_month-e.ocr_analyses},text_analyses:{used:e.text_analyses,limit:e.limits.text_analyses_per_month,percentage:Math.round(n),remaining:e.limits.text_analyses_per_month-e.text_analyses},report_analyses:void 0!==a?{used:r||0,limit:a,percentage:Math.round(a?(r||0)/a*100:0),remaining:a-(r||0)}:void 0,resetDate:l}}(e);c(t)}else c(null)}catch(e){console.error("Error fetching user plan:",e),u(e instanceof Error?e:Error("Unknown error")),t("free"),c(null)}finally{h(!1)}};return(0,o.useEffect)(()=>{y()},[]),{plan:e,subscription_status:i,quota:d,isLoading:g,error:f,refetch:y}}},68398:function(e,t,i){"use strict";i.d(t,{Ob:function(){return g},showRewardedAd:function(){return h},tJ:function(){return c}});var o=i(87185);function n(e,t){var i;return(null===(i=process.env)||void 0===i?void 0:i[e])||t}n("NEXT_PUBLIC_ADMOB_APP_ID_IOS","ca-app-pub-1018925088575422~2172895788");let a=n("NEXT_PUBLIC_ADMOB_BANNER_ID_IOS","ca-app-pub-1018925088575422/1014553329"),r=n("NEXT_PUBLIC_ADMOB_REWARDED_ID_IOS","ca-app-pub-1018925088575422/2438303871"),s=null,l=!1;async function d(){if(!s)try{s=(await i.e(124).then(i.bind(i,97124))).AdMob}catch(e){console.warn("[AdMob] Community plugin not available:",e),s=null}}async function c(){if(o.dV.isNativePlatform()&&!l){if(await d(),!s){l=!0;return}try{await s.initialize({requestTrackingAuthorization:!0})}catch(e){console.warn("[AdMob] init error (non-fatal):",e)}finally{l=!0}}}async function g(){if(o.dV.isNativePlatform()&&(await c(),s))try{"function"==typeof s.showBannerAd?await s.showBannerAd({adId:a,position:"TOP_CENTER"}):"function"==typeof s.showBanner&&await s.showBanner({adId:a,position:"TOP_CENTER"})}catch(e){console.warn("[AdMob] showTopBanner failed:",e)}}async function h(e){if(!o.dV.isNativePlatform())return console.log("[AdMob] Not native, simulating rewarded ad for dev"),!0;if(await c(),!s)return!0;try{if("function"==typeof s.showRewardedAd)return await s.showRewardedAd({adId:r}),!0;if("function"==typeof s.showRewardVideoAd)return await s.showRewardVideoAd({adId:r}),!0;return console.warn("[AdMob] No rewarded method available"),!1}catch(e){return console.warn("[AdMob] showRewardedAd failed:",e),!1}}},45224:function(e,t,i){"use strict";i.d(t,{q:function(){return n}});var o=i(68398);async function n(e,t){let i=await e();if(403!==i.status)return i;try{let n=await i.clone().json().catch(()=>({}));if((null==n?void 0:n.error)==="watch_ad_required"){if(!await (0,o.showRewardedAd)(null==t?void 0:t.feature))return i;return await e({"x-ad-completed":"1"})}}catch(e){}return i}},45591:function(e,t,i){"use strict";i.d(t,{h:function(){return r},x:function(){return a}});var o=i(45800);let n=i(20357).env.NEXT_PUBLIC_API_URL||"https://app.foodtracker.com.br";async function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{token:i,...a}=t,r={...a.headers};if(i)r.Authorization="Bearer ".concat(i);else{let e=localStorage.getItem("auth_token");console.log("[API Client] localStorage auth_token:",e?"exists":"null"),e&&(r.Authorization="Bearer ".concat(e))}a.body&&"string"==typeof a.body&&!r["Content-Type"]&&(r["Content-Type"]="application/json");let s=e.startsWith("http")?e:"".concat(n).concat(e);console.log("[API Client]",{isMobile:!0,baseUrl:n,endpoint:e,finalUrl:s,hasAuthToken:!!r.Authorization});try{let t=await fetch(s,{...a,headers:r,credentials:"include"});if(console.log("[API Client] Response ".concat(e,":"),{status:t.status}),401===t.status){console.warn("401 Unauthorized - triggering client logout");try{(0,o.h)()}catch(e){}}return t}catch(e){throw console.error("[API Client Error]",e),e}}let r={get:(e,t)=>a(e,{method:"GET",token:t}),post:(e,t,i)=>a(e,{method:"POST",body:JSON.stringify(t),token:i}),put:(e,t,i)=>a(e,{method:"PUT",body:JSON.stringify(t),token:i}),patch:(e,t,i)=>a(e,{method:"PATCH",body:JSON.stringify(t),token:i}),delete:(e,t)=>a(e,{method:"DELETE",token:t})}},45800:function(e,t,i){"use strict";function o(){try{try{localStorage.removeItem("auth_token")}catch(e){}try{localStorage.setItem("auth_logout_at",String(Date.now()))}catch(e){}try{window.dispatchEvent(new Event("app:logout"))}catch(e){}}catch(e){}}i.d(t,{h:function(){return o}})},35087:function(e,t,i){"use strict";i.d(t,{F1:function(){return r},XV:function(){return s},YX:function(){return l},Yd:function(){return a},xk:function(){return n}});let o="America/Sao_Paulo";function n(){return new Date().toLocaleDateString("en-CA",{timeZone:o})}function a(){return{date:n(),time:new Date().toLocaleTimeString("pt-BR",{timeZone:o,hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"})}}function r(e){return new Date(e+"T00:00:00").toLocaleDateString("pt-BR",{timeZone:o})}function s(e){return new Date(e+"T00:00:00").toLocaleDateString("pt-BR",{timeZone:o,day:"2-digit",month:"long",year:"numeric"})}function l(e){return e.toLocaleDateString("en-CA",{timeZone:o})}}},function(e){e.O(0,[325,971,23,744],function(){return e(e.s=51104)}),_N_E=e.O()}]);