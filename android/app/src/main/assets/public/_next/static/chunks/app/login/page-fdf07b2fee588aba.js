(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[626],{52848:function(e,o,t){Promise.resolve().then(t.bind(t,15207))},15207:function(e,o,t){"use strict";t.r(o),t.d(o,{default:function(){return u}});var r=t(57437),n=t(2265),l=t(98174),a=t(16463),i=t(87138),s=t(87185),c=t(45591);function d(){let e=s.dV.isNativePlatform(),[o,t]=(0,n.useState)(""),[d,u]=(0,n.useState)(""),[g,h]=(0,n.useState)(null),[f,p]=(0,n.useState)(!1),y=(0,a.useRouter)(),b=(0,a.useSearchParams)().get("callbackUrl")||"/";async function m(t){t.preventDefault(),h(null),p(!0);try{if(console.log("Tentando login com:",{email:o,isMobile:e}),e){let e=await c.h.post("/api/auth/mobile-login",{email:o,password:d}),t=await e.json();e.ok?t.token?(localStorage.setItem("auth_token",t.token),console.log("Token salvo, redirecionando..."),y.push("/"),y.refresh()):h("Erro: Token n\xe3o recebido"):h(t.error||"Erro no login")}else{let e=await (0,l.zB)("credentials",{email:o,password:d,redirect:!1});(null==e?void 0:e.error)?(console.error("Erro no login:",e.error),h("Email ou senha incorretos")):(null==e?void 0:e.ok)?(console.log("Login bem-sucedido, redirecionando para:",b),y.push(b),y.refresh()):(console.warn("Resposta inesperada:",e),h("Erro inesperado ao fazer login"))}}catch(e){console.error("Exce\xe7\xe3o ao fazer login:",e),h("Erro ao fazer login: "+e.message)}finally{p(!1)}}return(0,r.jsxs)("div",{style:{width:"100%",maxWidth:400,padding:32,backgroundColor:"#fff",borderRadius:12,boxShadow:"0 4px 6px rgba(0,0,0,0.1)"},children:[(0,r.jsx)("h1",{style:{fontSize:28,fontWeight:700,marginBottom:8,textAlign:"center"},children:"Food Tracker"}),(0,r.jsx)("p",{style:{fontSize:14,color:"#666",textAlign:"center",marginBottom:32},children:"Fa\xe7a login para continuar"}),(0,r.jsxs)("form",{onSubmit:m,style:{display:"grid",gap:16},children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{style:{display:"block",fontSize:14,fontWeight:500,marginBottom:8},children:"Email"}),(0,r.jsx)("input",{type:"email",placeholder:"seu@email.com",value:o,onChange:e=>t(e.target.value),required:!0,style:{width:"100%",padding:"12px 16px",fontSize:14,border:"1px solid #e0e0e0",borderRadius:8,outline:"none",transition:"border-color 0.2s"},onFocus:e=>e.target.style.borderColor="#2196F3",onBlur:e=>e.target.style.borderColor="#e0e0e0"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{style:{display:"block",fontSize:14,fontWeight:500,marginBottom:8},children:"Senha"}),(0,r.jsx)("input",{type:"password",placeholder:"••••••••",value:d,onChange:e=>u(e.target.value),required:!0,style:{width:"100%",padding:"12px 16px",fontSize:14,border:"1px solid #e0e0e0",borderRadius:8,outline:"none",transition:"border-color 0.2s"},onFocus:e=>e.target.style.borderColor="#2196F3",onBlur:e=>e.target.style.borderColor="#e0e0e0"})]}),g&&(0,r.jsx)("div",{style:{padding:12,backgroundColor:"#ffebee",color:"#c62828",borderRadius:8,fontSize:14},children:g}),(0,r.jsx)("button",{type:"submit",disabled:f,style:{width:"100%",padding:"12px 24px",fontSize:16,fontWeight:600,color:"#fff",backgroundColor:f?"#999":"#2196F3",border:"none",borderRadius:8,cursor:f?"not-allowed":"pointer",transition:"background-color 0.2s"},onMouseEnter:e=>{f||(e.currentTarget.style.backgroundColor="#1976D2")},onMouseLeave:e=>{f||(e.currentTarget.style.backgroundColor="#2196F3")},children:f?"Entrando…":"Entrar"})]}),(0,r.jsxs)("p",{style:{textAlign:"center",marginTop:16,color:"#666",fontSize:14},children:["Ainda nao tem conta?"," ",(0,r.jsx)(i.default,{href:"/signup",style:{color:"#2196F3",fontWeight:600,textDecoration:"none"},children:"Criar conta"})]})]})}function u(){return(0,r.jsx)("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#f5f5f5"},children:(0,r.jsx)(n.Suspense,{fallback:(0,r.jsx)("div",{children:"Carregando..."}),children:(0,r.jsx)(d,{})})})}},45591:function(e,o,t){"use strict";t.d(o,{h:function(){return a},x:function(){return l}});var r=t(45800);let n=t(20357).env.NEXT_PUBLIC_API_URL||"https://app.foodtracker.com.br";async function l(e){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{token:t,timeoutMs:l,...a}=o,i={...a.headers};if(t)i.Authorization="Bearer ".concat(t);else{let e=localStorage.getItem("auth_token");console.log("[API Client] localStorage auth_token:",e?"exists":"null"),e&&(i.Authorization="Bearer ".concat(e))}a.body&&"string"==typeof a.body&&!i["Content-Type"]&&(i["Content-Type"]="application/json");let s=e.startsWith("http")?e:"".concat(n).concat(e);console.log("[API Client]",{isMobile:!0,baseUrl:n,endpoint:e,finalUrl:s,hasAuthToken:!!i.Authorization,allHeaders:Object.keys(i),xAdCompleted:i["x-ad-completed"]||"not set"});try{var c;let o=a.signal?null:new AbortController,t=null!==(c=null==o?void 0:o.signal)&&void 0!==c?c:a.signal,n=null;o&&(n=setTimeout(()=>{try{o.abort()}catch(e){}},"number"==typeof l?l:1e4));let d=await fetch(s,{...a,headers:i,credentials:"include",signal:t});if(n&&clearTimeout(n),console.log("[API Client] Response ".concat(e,":"),{status:d.status}),401===d.status){console.warn("401 Unauthorized - triggering client logout");try{(0,r.h)()}catch(e){}}if(404===d.status)try{let e=d.clone(),o=await e.json().catch(()=>null),t=(null==o?void 0:o.error)||"";if("string"==typeof t&&t.toLowerCase().includes("tenant")){console.warn("404 tenant_not_found - triggering client logout");try{(0,r.h)()}catch(e){}}}catch(e){}return d}catch(e){if((null==e?void 0:e.name)==="AbortError")throw console.error("[API Client Error] Timeout"),Error("Tempo de rede esgotado");throw console.error("[API Client Error]",e),e}}let a={get:(e,o)=>l(e,{method:"GET",token:o}),post:(e,o,t)=>l(e,{method:"POST",body:JSON.stringify(o),token:t}),put:(e,o,t)=>l(e,{method:"PUT",body:JSON.stringify(o),token:t}),patch:(e,o,t)=>l(e,{method:"PATCH",body:JSON.stringify(o),token:t}),delete:(e,o)=>l(e,{method:"DELETE",token:o})}},45800:function(e,o,t){"use strict";function r(){try{try{localStorage.removeItem("auth_token")}catch(e){}try{localStorage.setItem("auth_logout_at",String(Date.now()))}catch(e){}try{window.dispatchEvent(new Event("app:logout"))}catch(e){}}catch(e){}}t.d(o,{h:function(){return r}})}},function(e){e.O(0,[325,353,138,971,23,744],function(){return e(e.s=52848)}),_N_E=e.O()}]);