(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[573],{9919:function(t,e,o){Promise.resolve().then(o.bind(o,526))},526:function(t,e,o){"use strict";o.r(e),o.d(e,{default:function(){return S}});var i=o(7437),n=o(2265),r=o(5591),a=o(6463),s=o(6856),l=o(5974),d=o(4142),c=o(2842),h=o(9542),u=o(560),g=o(2684),x=o(7948),f=o(81),p=o(8295),m=o(4015),y=o(2566),b=o(1534);let j=["#10b981","#3b82f6","#f59e0b","#ef4444","#8b5cf6","#ec4899","#6366f1","#14b8a6"];function S(){let t=(0,a.useRouter)(),[e,o]=(0,n.useState)(null),[S,k]=(0,n.useState)(!0),[w,v]=(0,n.useState)(null);async function C(){try{k(!0);let t=await r.h.get("/api/shopping-lists/stats"),e=await t.json();t.ok?o(e.stats):v(e.error||"Erro ao carregar dados")}catch(t){v(t.message||"Erro de conex\xe3o")}finally{k(!1)}}function R(t){return t.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})}function z(t){let[e,o]=t.split("-");return new Date(parseInt(e),parseInt(o)-1,1).toLocaleDateString("pt-BR",{month:"short",year:"2-digit"})}function B(t){return new Date(t).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit"})}return((0,n.useEffect)(()=>{C()},[]),S)?(0,i.jsx)("div",{style:{padding:32,textAlign:"center",color:"#6b7280"},children:"Carregando estat\xedsticas..."}):w?(0,i.jsxs)("div",{style:{padding:32,textAlign:"center",color:"#ef4444"},children:["Erro: ",w,(0,i.jsx)("br",{}),(0,i.jsx)("button",{onClick:C,style:{marginTop:16,padding:"8px 16px",background:"#f3f4f6",border:"none",borderRadius:8,cursor:"pointer"},children:"Tentar novamente"})]}):e?(0,i.jsxs)("div",{style:{maxWidth:1e3,margin:"0 auto",padding:24,paddingBottom:80},children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:16,marginBottom:32},children:[(0,i.jsx)("button",{onClick:()=>t.back(),style:{padding:"8px 16px",background:"#f3f4f6",border:"none",borderRadius:8,cursor:"pointer",fontSize:14,fontWeight:600,color:"#374151"},children:"â† Voltar"}),(0,i.jsx)("h1",{style:{fontSize:28,fontWeight:700,margin:0},children:"Painel de Gastos"})]}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:24},children:[(0,i.jsxs)("div",{style:{background:"white",borderRadius:16,padding:24,boxShadow:"0 1px 3px rgba(0,0,0,0.1)",gridColumn:"1 / -1"},children:[(0,i.jsx)("h2",{style:{fontSize:18,fontWeight:600,marginBottom:24,color:"#1f2937"},children:"Evolu\xe7\xe3o de Gastos (\xdaltimos 12 meses)"}),(0,i.jsx)("div",{style:{height:300,width:"100%"},children:e.monthly.length>0?(0,i.jsx)(s.h,{width:"100%",height:"100%",children:(0,i.jsxs)(l.v,{data:e.monthly,children:[(0,i.jsx)(d.q,{strokeDasharray:"3 3",vertical:!1,stroke:"#e5e7eb"}),(0,i.jsx)(c.K,{dataKey:"month",tickFormatter:z,axisLine:!1,tickLine:!1,tick:{fill:"#6b7280",fontSize:12},dy:10}),(0,i.jsx)(h.B,{axisLine:!1,tickLine:!1,tick:{fill:"#6b7280",fontSize:12},tickFormatter:t=>"R$".concat(t)}),(0,i.jsx)(u.u,{cursor:{fill:"#f3f4f6"},formatter:t=>[R(Number(t)),"Total"],labelFormatter:t=>z(t),contentStyle:{borderRadius:8,border:"none",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"}}),(0,i.jsx)(g.$Q,{dataKey:"total",fill:"#10b981",radius:[4,4,0,0],maxBarSize:60})]})}):(0,i.jsx)("div",{style:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center",color:"#9ca3af"},children:"Sem dados suficientes"})})]}),(0,i.jsxs)("div",{style:{background:"white",borderRadius:16,padding:24,boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[(0,i.jsx)("h2",{style:{fontSize:18,fontWeight:600,marginBottom:24,color:"#1f2937"},children:"Onde voc\xea compra"}),(0,i.jsx)("div",{style:{height:300,width:"100%"},children:e.byStore.length>0?(0,i.jsx)(s.h,{width:"100%",height:"100%",children:(0,i.jsxs)(x.u,{children:[(0,i.jsx)(f.by,{data:e.byStore,cx:"50%",cy:"50%",innerRadius:60,outerRadius:80,paddingAngle:5,dataKey:"total",nameKey:"storeName",children:e.byStore.map((t,e)=>(0,i.jsx)(p.b,{fill:j[e%j.length]},"cell-".concat(e)))}),(0,i.jsx)(u.u,{formatter:(t,e)=>[R(Number(t)),e],contentStyle:{borderRadius:8,border:"none",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"}}),(0,i.jsx)(m.D,{layout:"horizontal",verticalAlign:"bottom",align:"center",wrapperStyle:{fontSize:12,paddingTop:20}})]})}):(0,i.jsx)("div",{style:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center",color:"#9ca3af"},children:"Sem dados suficientes"})})]}),(0,i.jsxs)("div",{style:{background:"white",borderRadius:16,padding:24,boxShadow:"0 1px 3px rgba(0,0,0,0.1)",gridColumn:"1 / -1"},children:[(0,i.jsx)("h2",{style:{fontSize:18,fontWeight:600,marginBottom:8,color:"#1f2937"},children:"Hist\xf3rico de Pre\xe7os (Top 10 Itens)"}),(0,i.jsx)("p",{style:{fontSize:14,color:"#6b7280",marginBottom:24},children:"Varia\xe7\xe3o do pre\xe7o unit\xe1rio dos seus itens mais frequentes"}),(0,i.jsx)("div",{style:{height:300,width:"100%"},children:e.topItemsPriceHistory.length>0?(0,i.jsx)(s.h,{width:"100%",height:"100%",children:(0,i.jsxs)(y.w,{children:[(0,i.jsx)(d.q,{strokeDasharray:"3 3",vertical:!1,stroke:"#e5e7eb"}),(0,i.jsx)(c.K,{dataKey:"date",type:"category",allowDuplicatedCategory:!1,tickFormatter:B,axisLine:!1,tickLine:!1,tick:{fill:"#6b7280",fontSize:12},dy:10}),(0,i.jsx)(h.B,{axisLine:!1,tickLine:!1,tick:{fill:"#6b7280",fontSize:12},tickFormatter:t=>"R$".concat(t)}),(0,i.jsx)(u.u,{labelFormatter:t=>B(t),formatter:t=>[R(Number(t)),"Pre\xe7o Unit."],contentStyle:{borderRadius:8,border:"none",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"}}),(0,i.jsx)(m.D,{}),e.topItemsPriceHistory.map((t,e)=>(0,i.jsx)(b.x1,{data:t.history,name:t.itemName,type:"monotone",dataKey:"price",stroke:j[e%j.length],strokeWidth:2,dot:{r:4},activeDot:{r:6},connectNulls:!0},t.itemName))]})}):(0,i.jsxs)("div",{style:{height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",color:"#9ca3af",textAlign:"center",padding:20},children:[(0,i.jsx)("p",{style:{marginBottom:8,fontWeight:500},children:"Sem dados suficientes para exibir o gr\xe1fico"}),(0,i.jsxs)("p",{style:{fontSize:13,maxWidth:300},children:["O hist\xf3rico aparecer\xe1 a partir da ",(0,i.jsx)("strong",{children:"segunda compra"})," do mesmo item onde voc\xea informar o ",(0,i.jsx)("strong",{children:"pre\xe7o unit\xe1rio"}),"."]})]})})]})]})]}):null}},5591:function(t,e,o){"use strict";o.d(e,{h:function(){return r},x:function(){return n}});let i=o(357).env.NEXT_PUBLIC_API_URL||"https://app.foodtracker.com.br";async function n(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{token:o,...n}=e,r={...n.headers};if(o)r.Authorization="Bearer ".concat(o);else{let t=localStorage.getItem("auth_token");console.log("[API Client] localStorage auth_token:",t?"exists":"null"),t&&(r.Authorization="Bearer ".concat(t))}n.body&&"string"==typeof n.body&&!r["Content-Type"]&&(r["Content-Type"]="application/json");let a=t.startsWith("http")?t:"".concat(i).concat(t);console.log("[API Client]",{isMobile:!0,baseUrl:i,endpoint:t,finalUrl:a,hasAuthToken:!!r.Authorization});try{let e=await fetch(a,{...n,headers:r,credentials:"include"});return console.log("[API Client] Response ".concat(t,":"),{status:e.status}),401!==e.status||window.location.pathname.includes("/login")||(console.warn("401 Unauthorized - Redirecting to login"),localStorage.removeItem("auth_token"),window.location.href="/login"),e}catch(t){throw console.error("[API Client Error]",t),t}}let r={get:(t,e)=>n(t,{method:"GET",token:e}),post:(t,e,o)=>n(t,{method:"POST",body:JSON.stringify(e),token:o}),put:(t,e,o)=>n(t,{method:"PUT",body:JSON.stringify(e),token:o}),patch:(t,e,o)=>n(t,{method:"PATCH",body:JSON.stringify(e),token:o}),delete:(t,e)=>n(t,{method:"DELETE",token:e})}}},function(t){t.O(0,[723,971,23,744],function(){return t(t.s=9919)}),_N_E=t.O()}]);