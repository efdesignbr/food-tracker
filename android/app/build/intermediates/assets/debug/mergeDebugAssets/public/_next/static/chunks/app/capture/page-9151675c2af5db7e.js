(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[790],{7372:function(e,t,o){Promise.resolve().then(o.bind(o,7581))},7581:function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return c}});var n=o(7437),i=o(2265),r=o(6394),a=o(5682),s=o(9229),l=o(5591);function d(){try{let e=new Intl.DateTimeFormat("sv-SE",{timeZone:"America/Sao_Paulo",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!1}).formatToParts(new Date),t=t=>{var o;return(null===(o=e.find(e=>e.type===t))||void 0===o?void 0:o.value)||""};return"".concat(t("year"),"-").concat(t("month"),"-").concat(t("day"),"T").concat(t("hour"),":").concat(t("minute"))}catch(o){let e=new Date,t=e=>String(e).padStart(2,"0");return"".concat(e.getFullYear(),"-").concat(t(e.getMonth()+1),"-").concat(t(e.getDate()),"T").concat(t(e.getHours()),":").concat(t(e.getMinutes()))}}function c(){var e,t;let{plan:o,quota:c,isLoading:u}=(0,r.R)(),{hasQuota:g}=(0,a.f)(o,c),[p,h]=(0,i.useState)(!1),[f,b]=(0,i.useState)(null),[m,x]=(0,i.useState)(null),[y,v]=(0,i.useState)(!1),[j,w]=(0,i.useState)(""),[S,k]=(0,i.useState)(null),[_,z]=(0,i.useState)(()=>d()),[C,R]=(0,i.useState)(""),[B,W]=(0,i.useState)(null),[E,T]=(0,i.useState)(!1),[A,I]=(0,i.useState)("home"),[N,F]=(0,i.useState)(""),[L,M]=(0,i.useState)([]),[P,D]=(0,i.useState)(!1),[q,O]=(0,i.useState)(null),[U,H]=(0,i.useState)([]),[Q,J]=(0,i.useState)(!1),[Y,V]=(0,i.useState)(!1),[G,K]=(0,i.useState)(""),[Z,X]=(0,i.useState)([]),[$,ee]=(0,i.useState)(!1),[et,eo]=(0,i.useState)("");async function en(e){return new Promise((t,o)=>{let n=new FileReader;n.readAsDataURL(e),n.onload=n=>{var i;let r=new Image;r.src=null===(i=n.target)||void 0===i?void 0:i.result,r.onload=()=>{let n=document.createElement("canvas"),i=r.width,a=r.height;i>a&&i>1024?(a=1024*a/i,i=1024):a>1024&&(i=1024*i/a,a=1024),n.width=i,n.height=a;let s=n.getContext("2d");null==s||s.drawImage(r,0,0,i,a);let l=.8,d=()=>{n.toBlob(n=>{if(!n){o(Error("Erro ao comprimir imagem"));return}n.size<512e3||l<.3?t(new File([n],e.name,{type:"image/jpeg",lastModified:Date.now()})):(l-=.1,d())},"image/jpeg",l)};d()},r.onerror=()=>o(Error("Erro ao carregar imagem"))},n.onerror=()=>o(Error("Erro ao ler arquivo"))})}async function ei(e){var t;let o=null===(t=e.target.files)||void 0===t?void 0:t[0];if(o){v(!0),W(null);try{let e=await en(o);b(e),x(URL.createObjectURL(e))}catch(e){W("Erro ao processar imagem. Tente outra foto.")}finally{v(!1)}}}async function er(e){if(e.trim().length<2){X([]);return}try{ee(!0);let t=await l.h.get("/api/food-bank?q=".concat(encodeURIComponent(e))),o=await t.json();t.ok&&X(o.items||[])}catch(e){console.error("Erro ao buscar alimentos:",e)}finally{ee(!1)}}async function ea(e){var t,o,n,i,r,a,s;let d=prompt('Quantas unidades de "'.concat(e.name,'"?'),"1");if(!d)return;let c=Number(d);if(isNaN(c)||c<=0){alert("Quantidade inv\xe1lida! Digite um n\xfamero maior que zero.");return}try{await l.h.post("/api/food-bank/increment-usage",{id:e.id})}catch(e){console.error("Erro ao incrementar uso:",e)}let u=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=Math.pow(10,t);return Math.round(e*o)/o};H([...U,{name:e.name,quantity:c,unit:e.serving_size||"por\xe7\xe3o",calories:Math.round((null!==(t=e.calories)&&void 0!==t?t:0)*c),protein_g:u((null!==(o=e.protein)&&void 0!==o?o:0)*c),carbs_g:u((null!==(n=e.carbs)&&void 0!==n?n:0)*c),fat_g:u((null!==(i=e.fat)&&void 0!==i?i:0)*c),fiber_g:u((null!==(r=e.fiber)&&void 0!==r?r:0)*c),sodium_mg:Math.round((null!==(a=e.sodium)&&void 0!==a?a:0)*c),sugar_g:u((null!==(s=e.sugar)&&void 0!==s?s:0)*c),source:"bank"}]),K(""),X([]),J(!1)}function es(){if(!et.trim()){alert("Digite o nome do alimento!");return}H([...U,{name:et.trim(),quantity:1,unit:"por\xe7\xe3o",source:"new"}]),eo(""),V(!1)}async function el(){if(!f){W("Selecione uma foto para analisar!");return}v(!0),W(null);try{let e=new FormData;e.append("image",f),e.append("context",JSON.stringify({location_type:A,restaurant_name:"out"===A?null==q?void 0:q.name:void 0}));let t=await (0,l.x)("/api/meals/analyze-image",{method:"POST",body:e}),o=await t.json();if(!t.ok){if(403===t.status){h(!0);return}throw Error(o.error||"Erro ao analisar foto")}k(o.result)}catch(e){W(e instanceof Error?e.message:"Erro ao analisar foto")}finally{v(!1)}}async function ed(){if(0===U.length){W("Adicione pelo menos um alimento para analisar!");return}v(!0),W(null);try{let e;let t={foods:U.map(e=>({name:e.name,quantity:e.quantity,unit:e.unit,calories:e.calories,protein_g:e.protein_g,carbs_g:e.carbs_g,fat_g:e.fat_g,fiber_g:e.fiber_g,sodium_mg:e.sodium_mg,sugar_g:e.sugar_g})),location_type:A,restaurant_name:"out"===A?null==q?void 0:q.name:void 0};if(f){let o=new FormData;o.append("image",f),o.append("data",JSON.stringify(t)),e=await (0,l.x)("/api/meals/analyze-meal",{method:"POST",body:o})}else e=await l.h.post("/api/meals/analyze-meal",t);let o=await e.json();if(!e.ok){if(403===e.status){h(!0);return}throw Error(o.error||"Erro ao analisar")}k(o.result)}catch(e){W(e.message)}finally{v(!1)}}async function ec(){if(S){if(!j){W("Por favor, selecione o tipo de refei\xe7\xe3o");return}v(!0),W(null),T(!1);try{let e;let t={meal_type:j,consumed_at:_+":00-03:00",notes:C||S.notes||"",foods:(S.foods||[]).map(e=>({name:e.name,quantity:Number(e.quantity)||1,unit:e.unit||"un",calories:e.calories,protein_g:e.protein_g,carbs_g:e.carbs_g,fat_g:e.fat_g,fiber_g:e.fiber_g,sodium_mg:e.sodium_mg,sugar_g:e.sugar_g}))};if(t.location_type=A,"out"===A){if(!(null==q?void 0:q.id))throw Error("Selecione um restaurante para refei\xe7\xf5es fora de casa");t.restaurant_id=q.id}else t.restaurant_id=null;if(f){let o=new FormData;o.append("image",f),o.append("payload",JSON.stringify(t)),e=await (0,l.x)("/api/meals/approve",{method:"POST",body:o})}else e=await l.h.post("/api/meals/approve",t);let o=await e.json();if(!e.ok)throw Error(o.error||"Erro ao salvar");T(!0),b(null),x(null),H([]),k(null),R(""),z(d()),I("home"),O(null),F(""),M([])}catch(e){W(e.message)}finally{v(!1)}}}let eu=(null==S?void 0:null===(e=S.foods)||void 0===e?void 0:e.reduce((e,t)=>e+(t.calories||0),0))||0;return(0,n.jsxs)("div",{style:{maxWidth:800,margin:"0 auto",padding:24},children:[(0,n.jsx)("h1",{style:{fontSize:28,fontWeight:700,marginBottom:24},children:"Capturar Refei\xe7\xe3o"}),(0,n.jsx)(s.x5,{isOpen:p,onClose:()=>h(!1),feature:"photo_analysis",currentPlan:o}),g&&c&&(0,n.jsx)(s.Lw,{quotaType:"photo",used:c.photo_analyses.used,limit:c.photo_analyses.limit,percentage:c.photo_analyses.percentage,remaining:c.photo_analyses.remaining,resetDate:c.resetDate}),(0,n.jsx)("div",{style:{border:"2px dashed #d1d5db",borderRadius:16,padding:24,textAlign:"center",background:"#f9fafb",marginBottom:24,position:"relative"},children:m?(0,n.jsxs)("div",{children:[(0,n.jsx)("img",{src:m,alt:"Preview",style:{maxWidth:"100%",maxHeight:200,borderRadius:12,marginBottom:12}}),(0,n.jsxs)("div",{style:{display:"flex",gap:8,justifyContent:"center",flexWrap:"wrap"},children:[(0,n.jsx)("button",{onClick:()=>{b(null),x(null)},style:{padding:"8px 16px",background:"#ef4444",color:"white",border:"none",borderRadius:8,cursor:"pointer"},children:"Remover Foto"}),!S&&(0,n.jsx)("button",{onClick:el,disabled:y,style:{padding:"8px 16px",background:y?"#9ca3af":"#8b5cf6",color:"white",border:"none",borderRadius:8,cursor:y?"not-allowed":"pointer",fontWeight:600},children:y?"Analisando...":"Analisar Foto com IA"})]})]}):(0,n.jsxs)("label",{style:{cursor:"pointer"},children:[(0,n.jsx)("div",{style:{fontSize:40,marginBottom:8,color:"#2196F3"},children:"Foto"}),(0,n.jsx)("div",{style:{fontSize:14,color:"#666",marginBottom:12},children:"Adicionar foto da refei\xe7\xe3o (opcional)"}),(0,n.jsx)("input",{type:"file",accept:"image/*",onChange:ei,style:{display:"none"}}),(0,n.jsx)("div",{style:{display:"inline-block",padding:"10px 20px",background:"#2196F3",color:"white",borderRadius:8,fontWeight:600,fontSize:14},children:"Selecionar Foto"})]})}),!S&&(0,n.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginBottom:24},children:[(0,n.jsx)("button",{onClick:()=>J(!0),style:{padding:16,background:"#10b981",color:"white",border:"none",borderRadius:12,fontSize:16,fontWeight:600,cursor:"pointer"},children:"Meus Alimentos"}),(0,n.jsx)("button",{onClick:()=>V(!0),style:{padding:16,background:"#3b82f6",color:"white",border:"none",borderRadius:12,fontSize:16,fontWeight:600,cursor:"pointer"},children:"Adicionar Novo"})]}),!S&&U.length>0&&(0,n.jsxs)("div",{style:{background:"#f0fdf4",border:"2px solid #10b981",borderRadius:16,padding:24,marginBottom:24},children:[(0,n.jsxs)("h3",{style:{fontSize:18,fontWeight:600,marginBottom:16,color:"#065f46"},children:["Alimentos Adicionados (",U.length,")"]}),(0,n.jsx)("div",{style:{display:"grid",gap:12,marginBottom:16},children:U.map((e,t)=>(0,n.jsxs)("div",{style:{padding:12,background:"white",borderRadius:8,border:"1px solid #e5e7eb",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{style:{fontWeight:600},children:e.name}),(0,n.jsxs)("div",{style:{fontSize:12,color:"#6b7280"},children:[e.quantity," ",e.unit,"bank"===e.source&&(0,n.jsx)("span",{children:" • Do banco"}),"new"===e.source&&(0,n.jsx)("span",{children:" • Novo"})]})]}),(0,n.jsx)("button",{onClick:()=>(function(e){let t=[...U];t.splice(e,1),H(t)})(t),style:{padding:"6px",background:"#fee2e2",color:"#dc2626",border:"none",borderRadius:6,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},title:"Remover",children:(0,n.jsx)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:(0,n.jsx)("path",{d:"M3 6h18M8 6V4a2 2 0 012-2h4a2 2 0 012 2v2m3 0v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6h14M10 11v6M14 11v6"})})})]},t))}),(0,n.jsx)("button",{onClick:ed,disabled:y,style:{width:"100%",padding:16,background:y?"#9ca3af":"#8b5cf6",color:"white",border:"none",borderRadius:12,fontSize:16,fontWeight:600,cursor:y?"not-allowed":"pointer"},children:y?"Analisando com IA...":"Analisar com IA"})]}),B&&(0,n.jsx)("div",{style:{padding:16,background:"#fee2e2",border:"2px solid #ef4444",borderRadius:12,color:"#991b1b",marginBottom:24},children:B}),E&&(0,n.jsx)("div",{style:{padding:16,background:"#d1fae5",border:"2px solid #10b981",borderRadius:12,color:"#065f46",marginBottom:24},children:"Refei\xe7\xe3o salva com sucesso!"}),S&&(0,n.jsxs)("div",{style:{marginBottom:32},children:[(0,n.jsxs)("div",{style:{background:"white",border:"2px solid #e5e7eb",borderRadius:16,padding:24,marginBottom:24},children:[(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[(0,n.jsx)("h2",{style:{fontSize:20,fontWeight:700},children:"An\xe1lise da Refei\xe7\xe3o"}),(0,n.jsxs)("div",{style:{padding:"8px 16px",background:"#dbeafe",color:"#1e40af",borderRadius:20,fontWeight:600},children:[eu," kcal"]})]}),S.notes&&(0,n.jsx)("p",{style:{color:"#666",fontSize:14,marginBottom:16,fontStyle:"italic"},children:S.notes}),(0,n.jsx)("div",{style:{display:"grid",gap:12},children:null===(t=S.foods)||void 0===t?void 0:t.map((e,t)=>(0,n.jsxs)("div",{style:{padding:16,background:"#f9fafb",borderRadius:12,border:"1px solid #e5e7eb"},children:[(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:12,alignItems:"center"},children:[(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,n.jsx)("span",{style:{fontWeight:600,fontSize:16},children:e.name}),"taco"===e.source&&(0,n.jsx)("span",{style:{fontSize:10,padding:"2px 6px",background:"#10b981",color:"white",borderRadius:4,fontWeight:600},children:"TACO"}),"bank"===e.source&&(0,n.jsx)("span",{style:{fontSize:10,padding:"2px 6px",background:"#3b82f6",color:"white",borderRadius:4,fontWeight:600},children:"MEUS ALIMENTOS"}),!e.source&&(0,n.jsx)("span",{style:{fontSize:10,padding:"2px 6px",background:"#f59e0b",color:"white",borderRadius:4,fontWeight:600},children:"IA"})]}),(0,n.jsxs)("span",{style:{color:"#666"},children:[e.quantity," ",e.unit]})]}),(0,n.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(120px, 1fr))",gap:8},children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{style:{fontSize:12,color:"#666",display:"block",marginBottom:4},children:"Calorias (kcal)"}),(0,n.jsx)("input",{type:"number",value:e.calories||"",onChange:e=>{let o=[...S.foods];o[t].calories=Number(e.target.value)||void 0,k({...S,foods:o})},style:{width:"100%",padding:"6px 8px",fontSize:14,border:"1px solid #d1d5db",borderRadius:6,outline:"none",boxSizing:"border-box"},placeholder:"0"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{style:{fontSize:12,color:"#666",display:"block",marginBottom:4},children:"Prote\xedna (g)"}),(0,n.jsx)("input",{type:"number",step:"0.1",value:e.protein_g||"",onChange:e=>{let o=[...S.foods];o[t].protein_g=Number(e.target.value)||void 0,k({...S,foods:o})},style:{width:"100%",padding:"6px 8px",fontSize:14,border:"1px solid #d1d5db",borderRadius:6,outline:"none",boxSizing:"border-box"},placeholder:"0"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{style:{fontSize:12,color:"#666",display:"block",marginBottom:4},children:"Carboidrato (g)"}),(0,n.jsx)("input",{type:"number",step:"0.1",value:e.carbs_g||"",onChange:e=>{let o=[...S.foods];o[t].carbs_g=Number(e.target.value)||void 0,k({...S,foods:o})},style:{width:"100%",padding:"6px 8px",fontSize:14,border:"1px solid #d1d5db",borderRadius:6,outline:"none",boxSizing:"border-box"},placeholder:"0"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{style:{fontSize:12,color:"#666",display:"block",marginBottom:4},children:"Gordura (g)"}),(0,n.jsx)("input",{type:"number",step:"0.1",value:e.fat_g||"",onChange:e=>{let o=[...S.foods];o[t].fat_g=Number(e.target.value)||void 0,k({...S,foods:o})},style:{width:"100%",padding:"6px 8px",fontSize:14,border:"1px solid #d1d5db",borderRadius:6,outline:"none",boxSizing:"border-box"},placeholder:"0"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{style:{fontSize:12,color:"#666",display:"block",marginBottom:4},children:"Fibras (g)"}),(0,n.jsx)("input",{type:"number",step:"0.1",value:e.fiber_g||"",onChange:e=>{let o=[...S.foods];o[t].fiber_g=Number(e.target.value)||void 0,k({...S,foods:o})},style:{width:"100%",padding:"6px 8px",fontSize:14,border:"1px solid #d1d5db",borderRadius:6,outline:"none",boxSizing:"border-box"},placeholder:"0"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{style:{fontSize:12,color:"#666",display:"block",marginBottom:4},children:"S\xf3dio (mg)"}),(0,n.jsx)("input",{type:"number",step:"1",value:e.sodium_mg||"",onChange:e=>{let o=[...S.foods];o[t].sodium_mg=Number(e.target.value)||void 0,k({...S,foods:o})},style:{width:"100%",padding:"6px 8px",fontSize:14,border:"1px solid #d1d5db",borderRadius:6,outline:"none",boxSizing:"border-box"},placeholder:"0"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{style:{fontSize:12,color:"#666",display:"block",marginBottom:4},children:"A\xe7\xfacar (g)"}),(0,n.jsx)("input",{type:"number",step:"0.1",value:e.sugar_g||"",onChange:e=>{let o=[...S.foods];o[t].sugar_g=Number(e.target.value)||void 0,k({...S,foods:o})},style:{width:"100%",padding:"6px 8px",fontSize:14,border:"1px solid #d1d5db",borderRadius:6,outline:"none",boxSizing:"border-box"},placeholder:"0"})]})]})]},t))})]}),(0,n.jsxs)("div",{style:{display:"grid",gap:16},children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{style:{display:"block",marginBottom:8,fontWeight:600},children:"Tipo de Refei\xe7\xe3o *"}),(0,n.jsxs)("select",{value:j,onChange:e=>w(e.target.value),style:{width:"100%",padding:12,fontSize:16,border:j?"2px solid #e5e7eb":"2px solid #ef4444",borderRadius:8,backgroundColor:"white",boxSizing:"border-box"},children:[(0,n.jsx)("option",{value:"",children:"Selecione o tipo..."}),(0,n.jsx)("option",{value:"breakfast",children:"Caf\xe9 da Manh\xe3"}),(0,n.jsx)("option",{value:"lunch",children:"Almo\xe7o"}),(0,n.jsx)("option",{value:"dinner",children:"Jantar"}),(0,n.jsx)("option",{value:"snack",children:"Lanche"})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{style:{display:"block",marginBottom:8,fontWeight:600},children:"Quando foi consumido?"}),(0,n.jsx)("input",{type:"datetime-local",value:_,onChange:e=>z(e.target.value),style:{width:"100%",padding:12,fontSize:16,border:"2px solid #e5e7eb",borderRadius:8,boxSizing:"border-box"}})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{style:{display:"block",marginBottom:8,fontWeight:600},children:"Observa\xe7\xf5es (opcional)"}),(0,n.jsx)("input",{type:"text",value:C,onChange:e=>R(e.target.value),placeholder:"Ex: Comi tudo, estava delicioso!",style:{width:"100%",padding:12,fontSize:16,border:"2px solid #e5e7eb",borderRadius:8,boxSizing:"border-box"}})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{style:{display:"block",marginBottom:8,fontWeight:600},children:"Local da Refei\xe7\xe3o"}),(0,n.jsxs)("div",{style:{display:"flex",gap:8,marginBottom:8},children:[(0,n.jsx)("button",{type:"button",onClick:()=>{I("home"),O(null)},style:{flex:1,padding:10,borderRadius:8,border:"home"===A?"2px solid #10b981":"2px solid #e5e7eb",background:"home"===A?"#ecfdf5":"white",fontWeight:600,color:"home"===A?"#065f46":"#374151"},children:"Casa"}),(0,n.jsx)("button",{type:"button",onClick:()=>I("out"),style:{flex:1,padding:10,borderRadius:8,border:"out"===A?"2px solid #f59e0b":"2px solid #e5e7eb",background:"out"===A?"#fffbeb":"white",fontWeight:600,color:"out"===A?"#92400e":"#374151"},children:"Fora"})]}),"out"===A&&(0,n.jsxs)("div",{style:{position:"relative"},children:[(0,n.jsx)("label",{style:{display:"block",marginBottom:6,fontWeight:500,color:"#92400e"},children:"Restaurante (obrigat\xf3rio)"}),(0,n.jsx)("input",{type:"text",value:N,onChange:async e=>{let t=e.target.value;if(F(t),q&&O(null),t.trim().length<2){M([]);return}try{D(!0);let e=await l.h.get("/api/restaurants/search?q=".concat(encodeURIComponent(t))),o=await e.json();e.ok&&M(o.restaurants||[])}finally{D(!1)}},placeholder:"Digite o nome do restaurante...",style:{width:"100%",padding:12,fontSize:16,border:"2px solid #fbbf24",borderRadius:q?"8px":"8px 8px 0 0",outline:"none",boxSizing:"border-box"}}),!q&&(P||L.length>0||N.trim().length>=2&&0===L.length)&&(0,n.jsxs)("div",{style:{position:"absolute",top:"100%",left:0,right:0,background:"white",border:"1px solid #e5e7eb",borderTop:"none",borderRadius:"0 0 8px 8px",maxHeight:200,overflowY:"auto",zIndex:10},children:[P&&(0,n.jsx)("div",{style:{padding:10,fontSize:14,color:"#6b7280"},children:"Carregando..."}),!P&&L.map(e=>(0,n.jsxs)("button",{type:"button",onClick:()=>{O({id:e.id,name:e.name}),F(e.name),M([])},style:{width:"100%",textAlign:"left",padding:"10px 12px",border:"none",background:"white",cursor:"pointer",borderBottom:"1px solid #f3f4f6"},children:[(0,n.jsx)("div",{style:{fontWeight:600},children:e.name}),e.address&&(0,n.jsx)("div",{style:{fontSize:12,color:"#6b7280"},children:e.address})]},e.id)),!P&&0===L.length&&N.trim().length>=2&&(0,n.jsxs)("div",{style:{padding:10},children:[(0,n.jsx)("div",{style:{fontSize:14,color:"#6b7280",marginBottom:8},children:"Nenhum restaurante encontrado."}),(0,n.jsxs)("button",{type:"button",onClick:async()=>{if(N.trim()&&confirm('Cadastrar o restaurante "'.concat(N.trim(),'"?')))try{D(!0);let e=await l.h.post("/api/restaurants",{name:N.trim()}),t=await e.json();if(e.ok){let e=t.restaurant.name;O({id:t.restaurant.id,name:e}),F(e),M([])}else alert(t.error||"Erro ao cadastrar restaurante")}catch(e){alert("Erro ao cadastrar restaurante: "+e.message)}finally{D(!1)}},style:{width:"100%",padding:"10px 12px",background:"#10b981",color:"white",border:"none",borderRadius:6,fontWeight:700,cursor:"pointer"},children:['Cadastrar "',N.trim(),'"']})]})]}),q&&(0,n.jsxs)("div",{style:{marginTop:8,fontSize:13,color:"#92400e"},children:["Selecionado: ",(0,n.jsx)("strong",{children:q.name})]})]})]}),(0,n.jsx)("button",{onClick:ec,disabled:y,style:{width:"100%",padding:16,background:"#2196F3",color:"white",border:"none",borderRadius:12,fontSize:16,fontWeight:600,cursor:y?"not-allowed":"pointer",opacity:y?.6:1},children:y?"Salvando...":"Salvar Refei\xe7\xe3o"})]})]}),Q&&(0,n.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:50,padding:20},children:(0,n.jsxs)("div",{style:{background:"white",borderRadius:16,padding:24,maxWidth:500,width:"100%",maxHeight:"80vh",overflowY:"auto"},children:[(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[(0,n.jsx)("h2",{style:{fontSize:20,fontWeight:700},children:"Meus Alimentos"}),(0,n.jsx)("button",{onClick:()=>{J(!1),K(""),X([])},style:{padding:8,background:"#f3f4f6",border:"none",borderRadius:8,cursor:"pointer",color:"#6b7280",display:"flex",alignItems:"center",justifyContent:"center"},title:"Fechar",children:(0,n.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:(0,n.jsx)("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),(0,n.jsx)("input",{type:"text",value:G,onChange:e=>{K(e.target.value),er(e.target.value)},placeholder:"Buscar alimento...",style:{width:"100%",padding:12,fontSize:16,border:"2px solid #10b981",borderRadius:8,outline:"none",marginBottom:16,boxSizing:"border-box"}}),$&&(0,n.jsx)("div",{style:{textAlign:"center",color:"#6b7280"},children:"Buscando..."}),!$&&Z.length>0&&(0,n.jsx)("div",{style:{display:"grid",gap:8},children:Z.map(e=>(0,n.jsxs)("button",{onClick:()=>ea(e),style:{width:"100%",textAlign:"left",padding:12,background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:8,cursor:"pointer"},children:[(0,n.jsxs)("div",{style:{fontWeight:600,marginBottom:4},children:[e.name,e.brand&&(0,n.jsxs)("span",{style:{color:"#6b7280",fontWeight:400},children:[" - ",e.brand]})]}),(0,n.jsxs)("div",{style:{fontSize:12,color:"#6b7280"},children:[e.serving_size&&(0,n.jsxs)("span",{children:["Por\xe7\xe3o: ",e.serving_size," | "]}),e.calories&&(0,n.jsxs)("span",{children:[e.calories," kcal"]})]})]},e.id))}),!$&&G.length>=2&&0===Z.length&&(0,n.jsxs)("div",{style:{textAlign:"center",color:"#dc2626",padding:16},children:["Nenhum alimento encontrado. ",(0,n.jsx)("a",{href:"/meus-alimentos",style:{color:"#2196F3",textDecoration:"underline"},children:"Cadastre aqui"})]})]})}),Y&&(0,n.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:50,padding:20},children:(0,n.jsxs)("div",{style:{background:"white",borderRadius:16,padding:24,maxWidth:400,width:"100%"},children:[(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[(0,n.jsx)("h2",{style:{fontSize:20,fontWeight:700},children:"Adicionar Novo Alimento"}),(0,n.jsx)("button",{onClick:()=>{V(!1),eo("")},style:{padding:8,background:"#f3f4f6",border:"none",borderRadius:8,cursor:"pointer",color:"#6b7280",display:"flex",alignItems:"center",justifyContent:"center"},title:"Fechar",children:(0,n.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:(0,n.jsx)("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),(0,n.jsx)("input",{type:"text",value:et,onChange:e=>eo(e.target.value),placeholder:"Ex: Bife de frango grelhado",style:{width:"100%",padding:12,fontSize:16,border:"2px solid #3b82f6",borderRadius:8,outline:"none",marginBottom:16,boxSizing:"border-box"},onKeyDown:e=>{"Enter"===e.key&&es()},autoFocus:!0}),(0,n.jsx)("button",{onClick:es,style:{width:"100%",padding:12,background:"#3b82f6",color:"white",border:"none",borderRadius:8,fontSize:16,fontWeight:600,cursor:"pointer"},children:"Adicionar"})]})})]})}},5682:function(e,t,o){"use strict";function n(e,t){return{canUseFeature:o=>"free"!==e&&("unlimited"===e||!!t&&("photo"===o?t.photo_analyses:t.ocr_analyses).remaining>0),getQuotaInfo:o=>{if("free"===e)return{used:0,limit:0,remaining:0,percentage:0,canUse:!1};if("unlimited"===e)return{used:t?"photo"===o?t.photo_analyses.used:t.ocr_analyses.used:0,limit:999999,remaining:999999,percentage:0,canUse:!0};if(!t)return{used:0,limit:0,remaining:0,percentage:0,canUse:!1};let n="photo"===o?t.photo_analyses:t.ocr_analyses;return{used:n.used,limit:n.limit,remaining:n.remaining,percentage:n.percentage,canUse:n.remaining>0}},hasQuota:"premium"===e&&null!==t}}o.d(t,{f:function(){return n}})},6463:function(e,t,o){"use strict";var n=o(1169);o.o(n,"usePathname")&&o.d(t,{usePathname:function(){return n.usePathname}}),o.o(n,"useRouter")&&o.d(t,{useRouter:function(){return n.useRouter}}),o.o(n,"useSearchParams")&&o.d(t,{useSearchParams:function(){return n.useSearchParams}})},357:function(e,t,o){"use strict";var n,i;e.exports=(null==(n=o.g.process)?void 0:n.env)&&"object"==typeof(null==(i=o.g.process)?void 0:i.env)?o.g.process:o(8081)},8081:function(e){!function(){var t={229:function(e){var t,o,n,i=e.exports={};function r(){throw Error("setTimeout has not been defined")}function a(){throw Error("clearTimeout has not been defined")}function s(e){if(t===setTimeout)return setTimeout(e,0);if((t===r||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(o){try{return t.call(null,e,0)}catch(o){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:r}catch(e){t=r}try{o="function"==typeof clearTimeout?clearTimeout:a}catch(e){o=a}}();var l=[],d=!1,c=-1;function u(){d&&n&&(d=!1,n.length?l=n.concat(l):c=-1,l.length&&g())}function g(){if(!d){var e=s(u);d=!0;for(var t=l.length;t;){for(n=l,l=[];++c<t;)n&&n[c].run();c=-1,t=l.length}n=null,d=!1,function(e){if(o===clearTimeout)return clearTimeout(e);if((o===a||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(e);try{o(e)}catch(t){try{return o.call(null,e)}catch(t){return o.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function h(){}i.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var o=1;o<arguments.length;o++)t[o-1]=arguments[o];l.push(new p(e,t)),1!==l.length||d||s(g)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=h,i.addListener=h,i.once=h,i.off=h,i.removeListener=h,i.removeAllListeners=h,i.emit=h,i.prependListener=h,i.prependOnceListener=h,i.listeners=function(e){return[]},i.binding=function(e){throw Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw Error("process.chdir is not supported")},i.umask=function(){return 0}}},o={};function n(e){var i=o[e];if(void 0!==i)return i.exports;var r=o[e]={exports:{}},a=!0;try{t[e](r,r.exports,n),a=!1}finally{a&&delete o[e]}return r.exports}n.ab="//";var i=n(229);e.exports=i}()}},function(e){e.O(0,[323,971,23,744],function(){return e(e.s=7372)}),_N_E=e.O()}]);