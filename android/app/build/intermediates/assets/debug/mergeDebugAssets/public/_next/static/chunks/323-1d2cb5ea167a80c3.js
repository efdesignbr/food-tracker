"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[323],{4799:function(e,t,o){o.d(t,{Z:function(){return a}});var n=o(7437);let r={free:{label:"FREE",emoji:"",bg:"linear-gradient(135deg, #f3f4f6 0%, #e5e7eb 100%)",text:"#6b7280",border:"#d1d5db"},premium:{label:"PRO",emoji:"",bg:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",text:"#ffffff",border:"#667eea"},unlimited:{label:"ADMIN",emoji:"â­",bg:"linear-gradient(135deg, #f093fb 0%, #f5576c 100%)",text:"#ffffff",border:"#f093fb"}},i={sm:{fontSize:10,padding:"2px 6px",gap:3},md:{fontSize:12,padding:"4px 8px",gap:4},lg:{fontSize:14,padding:"6px 12px",gap:6}};function a(e){let{plan:t,size:o="md"}=e,a=r[t],s=i[o];return(0,n.jsxs)("span",{style:{display:"inline-flex",alignItems:"center",gap:s.gap,padding:s.padding,borderRadius:6,background:a.bg,color:a.text,fontSize:s.fontSize,fontWeight:700,letterSpacing:"0.5px",border:"1px solid ".concat(a.border),textTransform:"uppercase",lineHeight:1,whiteSpace:"nowrap"},children:[a.emoji&&(0,n.jsx)("span",{children:a.emoji}),a.label]})}},9229:function(e,t,o){o.d(t,{x5:function(){return c},vE:function(){return n.Z},Lw:function(){return f},Yz:function(){return l}});var n=o(4799),r=o(7437),i=o(6463);let a={primary:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"#ffffff",border:"none",boxShadow:"0 2px 8px rgba(102, 126, 234, 0.3)"},secondary:{background:"#f3f4f6",color:"#667eea",border:"1px solid #e5e7eb",boxShadow:"none"},outline:{background:"transparent",color:"#667eea",border:"1px solid #667eea",boxShadow:"none"}},s={sm:{fontSize:12,padding:"6px 12px",borderRadius:6},md:{fontSize:14,padding:"8px 16px",borderRadius:8},lg:{fontSize:16,padding:"12px 24px",borderRadius:10}};function l(e){let{variant:t="primary",size:o="md",currentPlan:n}=e,l=(0,i.useRouter)();if("unlimited"===n)return null;let d=a[t],c=s[o],u="free"===n?"/upgrade":"/subscription";return(0,r.jsxs)("button",{onClick:()=>{l.push(u)},style:{...d,...c,fontWeight:600,cursor:"pointer",transition:"all 0.2s ease",whiteSpace:"nowrap"},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-1px)",e.currentTarget.style.boxShadow="0 4px 12px rgba(102, 126, 234, 0.4)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow=d.boxShadow},children:["free"===n&&" ","free"===n?"Fazer Upgrade":"Gerenciar Assinatura"]})}let d={photo_analysis:{title:"An\xe1lise de Foto",icon:"",description:"A an\xe1lise de fotos de refei\xe7\xf5es \xe9 exclusiva para usu\xe1rios PREMIUM",benefits:["90 an\xe1lises de foto por m\xeas","IA avan\xe7ada para reconhecer alimentos","C\xe1lculo autom\xe1tico de macros","Hist\xf3rico ilimitado"]},ocr_analysis:{title:"An\xe1lise de Tabelas Nutricionais",icon:"",description:"A leitura de tabelas nutricionais \xe9 exclusiva para usu\xe1rios PREMIUM",benefits:["30 an\xe1lises de tabelas por m\xeas","OCR preciso de r\xf3tulos","Importa\xe7\xe3o r\xe1pida de alimentos","Hist\xf3rico ilimitado"]},coach_analysis:{title:"Coach IA",icon:"",description:"O Coach IA com insights personalizados \xe9 exclusivo para usu\xe1rios PREMIUM",benefits:["An\xe1lises ilimitadas do seu progresso","Insights baseados em peso, medidas e alimenta\xe7\xe3o","Recomenda\xe7\xf5es personalizadas","Alertas importantes sobre sua sa\xfade"]}};function c(e){let{isOpen:t,onClose:o,feature:n,currentPlan:a}=e,s=(0,i.useRouter)(),l=d[n];return t?(0,r.jsx)("div",{onClick:e=>{e.target===e.currentTarget&&o()},style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:16},children:(0,r.jsxs)("div",{style:{backgroundColor:"#fff",borderRadius:16,padding:32,maxWidth:480,width:"100%",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.3)",position:"relative"},children:[(0,r.jsx)("button",{onClick:o,style:{position:"absolute",top:16,right:16,border:"none",background:"none",fontSize:24,cursor:"pointer",color:"#666",lineHeight:1,padding:4},"aria-label":"Fechar"}),(0,r.jsx)("div",{style:{fontSize:48,textAlign:"center",marginBottom:16},children:l.icon}),(0,r.jsx)("h2",{style:{fontSize:24,fontWeight:700,textAlign:"center",margin:"0 0 8px 0",color:"#1a1a1a"},children:"Recurso Premium"}),(0,r.jsx)("p",{style:{fontSize:16,color:"#666",textAlign:"center",margin:"0 0 24px 0",lineHeight:1.5},children:l.description}),(0,r.jsx)("div",{style:{height:1,backgroundColor:"#e5e7eb",margin:"24px 0"}}),(0,r.jsx)("h3",{style:{fontSize:18,fontWeight:600,margin:"0 0 16px 0",color:"#1a1a1a"},children:"Com PREMIUM voc\xea tem:"}),(0,r.jsx)("ul",{style:{listStyle:"none",padding:0,margin:"0 0 24px 0"},children:l.benefits.map((e,t)=>(0,r.jsxs)("li",{style:{display:"flex",alignItems:"center",gap:12,padding:"8px 0",fontSize:15,color:"#333"},children:[(0,r.jsx)("span",{style:{color:"#10b981",fontSize:20}}),e]},t))}),(0,r.jsxs)("div",{style:{display:"flex",gap:12,marginTop:24},children:[(0,r.jsx)("button",{onClick:o,style:{flex:1,padding:"12px 24px",borderRadius:8,border:"1px solid #e5e7eb",backgroundColor:"#fff",color:"#666",fontSize:16,fontWeight:600,cursor:"pointer",transition:"all 0.2s"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="#f9fafb"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="#fff"},children:"Fechar"}),(0,r.jsx)("button",{onClick:()=>{s.push("/upgrade")},style:{flex:1,padding:"12px 24px",borderRadius:8,border:"none",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"#fff",fontSize:16,fontWeight:600,cursor:"pointer",transition:"all 0.2s",boxShadow:"0 4px 12px rgba(102, 126, 234, 0.3)"},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 6px 16px rgba(102, 126, 234, 0.4)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 4px 12px rgba(102, 126, 234, 0.3)"},children:"Ver Planos"})]})]})}):null}let u={photo:{title:"An\xe1lise de Fotos",icon:"",unit:"an\xe1lises"},ocr:{title:"An\xe1lise de Tabelas",icon:"",unit:"an\xe1lises"}};function p(e){return new Intl.DateTimeFormat("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric"}).format(e)}function f(e){let{quotaType:t,used:o,limit:n,percentage:i,remaining:a,resetDate:s}=e,l=u[t],d=i<=50?"#10b981":i<=80?"#f59e0b":"#ef4444";return(0,r.jsxs)("div",{style:{background:"white",border:"2px solid #e5e7eb",borderRadius:12,padding:20,marginBottom:16},children:[(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:12},children:[(0,r.jsx)("span",{style:{fontSize:24},children:l.icon}),(0,r.jsx)("h3",{style:{fontSize:16,fontWeight:700,margin:0,color:"#1a1a1a"},children:l.title})]}),(0,r.jsxs)("div",{style:{fontSize:14,color:"#666",marginBottom:8},children:[(0,r.jsxs)("span",{style:{fontWeight:600,color:d},children:[o,"/",n]})," ","usadas (",i,"%)"]}),(0,r.jsx)("div",{style:{width:"100%",height:8,backgroundColor:"#f3f4f6",borderRadius:4,overflow:"hidden",marginBottom:12},children:(0,r.jsx)("div",{style:{width:"".concat(Math.min(i,100),"%"),height:"100%",backgroundColor:d,transition:"width 0.3s ease, background-color 0.3s ease"}})}),(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",fontSize:13,color:"#6b7280"},children:[(0,r.jsx)("div",{children:(0,r.jsx)("strong",{style:{color:a>0?d:"#dc2626"},children:a>0?"Restam: ".concat(a):"Limite atingido"})}),(0,r.jsxs)("div",{children:["Renova em: ",(0,r.jsx)("strong",{children:p(s)})]})]}),i>=80&&a>0&&(0,r.jsx)("div",{style:{marginTop:12,padding:8,background:i>=90?"#fee2e2":"#fef3c7",border:"1px solid ".concat(i>=90?"#fca5a5":"#fcd34d"),borderRadius:6,fontSize:12,color:i>=90?"#991b1b":"#92400e"},children:i>=90?" Voc\xea est\xe1 quase no limite! Restam apenas ".concat(a," ").concat(l.unit,"."):" Aten\xe7\xe3o: voc\xea j\xe1 usou ".concat(i,"% da sua quota este m\xeas.")}),0===a&&(0,r.jsxs)("div",{style:{marginTop:12,padding:10,background:"#fee2e2",border:"2px solid #ef4444",borderRadius:6,fontSize:13,color:"#991b1b",fontWeight:600},children:["Limite mensal atingido. Sua quota ser\xe1 renovada em ",p(s),"."]})]})}},6394:function(e,t,o){o.d(t,{R:function(){return s}});var n=o(2265),r=o(5591);async function i(){let e=await r.h.get("/api/user/profile");if(!e.ok)throw Error("Failed to fetch user plan: ".concat(e.status));let t=(await e.json()).user;return{plan:t.plan||"free",subscription_status:t.subscription_status||"active",subscription_started_at:t.subscription_started_at,subscription_expires_at:t.subscription_expires_at}}async function a(){let e=await r.h.get("/api/subscription/quota");if(!e.ok)throw Error("Failed to fetch quota usage: ".concat(e.status));return e.json()}function s(){let[e,t]=(0,n.useState)("free"),[o,r]=(0,n.useState)("active"),[s,l]=(0,n.useState)(null),[d,c]=(0,n.useState)(!0),[u,p]=(0,n.useState)(null),f=async()=>{try{c(!0),p(null);let e=await i();if(t(e.plan),r(e.subscription_status),"premium"===e.plan){let e=await a(),t=function(e){let t=e.photo_analyses/e.limits.photo_analyses_per_month*100,o=e.ocr_analyses/e.limits.ocr_analyses_per_month*100,n=new Date,r=new Date(n.getFullYear(),n.getMonth()+1,1);return{photo_analyses:{used:e.photo_analyses,limit:e.limits.photo_analyses_per_month,percentage:Math.round(t),remaining:e.limits.photo_analyses_per_month-e.photo_analyses},ocr_analyses:{used:e.ocr_analyses,limit:e.limits.ocr_analyses_per_month,percentage:Math.round(o),remaining:e.limits.ocr_analyses_per_month-e.ocr_analyses},resetDate:r}}(e);l(t)}else l(null)}catch(e){console.error("Error fetching user plan:",e),p(e instanceof Error?e:Error("Unknown error")),t("free"),l(null)}finally{c(!1)}};return(0,n.useEffect)(()=>{f()},[]),{plan:e,subscription_status:o,quota:s,isLoading:d,error:u,refetch:f}}},5591:function(e,t,o){o.d(t,{h:function(){return i},x:function(){return r}});let n=o(357).env.NEXT_PUBLIC_API_URL||"https://app.foodtracker.com.br";async function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{token:o,...r}=t,i={...r.headers};if(o)i.Authorization="Bearer ".concat(o);else{let e=localStorage.getItem("auth_token");console.log("[API Client] localStorage auth_token:",e?"exists":"null"),e&&(i.Authorization="Bearer ".concat(e))}r.body&&"string"==typeof r.body&&!i["Content-Type"]&&(i["Content-Type"]="application/json");let a=e.startsWith("http")?e:"".concat(n).concat(e);console.log("[API Client]",{isMobile:!0,baseUrl:n,endpoint:e,finalUrl:a,hasAuthToken:!!i.Authorization});try{let t=await fetch(a,{...r,headers:i,credentials:"include"});return console.log("[API Client] Response ".concat(e,":"),{status:t.status}),401!==t.status||window.location.pathname.includes("/login")||(console.warn("401 Unauthorized - Redirecting to login"),localStorage.removeItem("auth_token"),window.location.href="/login"),t}catch(e){throw console.error("[API Client Error]",e),e}}let i={get:(e,t)=>r(e,{method:"GET",token:t}),post:(e,t,o)=>r(e,{method:"POST",body:JSON.stringify(t),token:o}),put:(e,t,o)=>r(e,{method:"PUT",body:JSON.stringify(t),token:o}),patch:(e,t,o)=>r(e,{method:"PATCH",body:JSON.stringify(t),token:o}),delete:(e,t)=>r(e,{method:"DELETE",token:t})}}}]);