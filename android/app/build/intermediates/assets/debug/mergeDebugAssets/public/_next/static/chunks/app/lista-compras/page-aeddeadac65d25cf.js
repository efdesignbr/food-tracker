(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[205],{3790:function(e,t,i){Promise.resolve().then(i.bind(i,9270))},9270:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return s}});var n=i(7437),o=i(2265),r=i(6463),a=i(5591);function s(){let e=(0,r.useRouter)(),[t,i]=(0,o.useState)([]),[s,l]=(0,o.useState)(null),[d,c]=(0,o.useState)([]),[u,p]=(0,o.useState)(!0),[h,f]=(0,o.useState)(null),[g,x]=(0,o.useState)(!1),[b,m]=(0,o.useState)(!1),[y,j]=(0,o.useState)(""),[v,S]=(0,o.useState)(""),[k,w]=(0,o.useState)("1"),[z,C]=(0,o.useState)(""),[R,W]=(0,o.useState)([]),[B,_]=(0,o.useState)(!1),[I,E]=(0,o.useState)(!1),[T,N]=(0,o.useState)(!1),[A,F]=(0,o.useState)(null),[L,D]=(0,o.useState)(""),[P,q]=(0,o.useState)([]),[V,M]=(0,o.useState)(!1),[O,U]=(0,o.useState)(""),[H,G]=(0,o.useState)(!1),[J,Q]=(0,o.useState)(""),[$,X]=(0,o.useState)(!1),[Y,K]=(0,o.useState)(!1),[Z,ee]=(0,o.useState)(!1),[et,ei]=(0,o.useState)(""),[en,eo]=(0,o.useState)(1),[er,ea]=(0,o.useState)("");async function es(){try{let e=await a.h.get("/api/stores"),t=await e.json();e.ok&&q(t.stores||[])}catch(e){console.error("Erro ao buscar lojas:",e)}}async function el(){try{p(!0);let e=await a.h.get("/api/shopping-lists"),t=await e.json();e.ok&&i(t.lists||[])}catch(e){console.error("Erro ao buscar listas:",e)}finally{p(!1)}}async function ed(e){try{let t=await a.h.get("/api/shopping-lists/".concat(e)),i=await t.json();t.ok&&(l(i.list),c(i.items||[]))}catch(e){console.error("Erro ao buscar detalhes:",e)}}async function ec(e){if(e.preventDefault(),y.trim())try{let e=await a.h.post("/api/shopping-lists",{name:y}),t=await e.json();e.ok?(x(!1),j(""),await el(),t.list&&ed(t.list.id)):f(t.error||"Erro ao criar lista")}catch(e){f(e.message)}}async function eu(e){if(e.preventDefault(),s&&v.trim())try{(await a.h.post("/api/shopping-lists/items",{list_id:s.id,name:v,quantity:parseFloat(k)||1,unit:z||void 0})).ok&&(m(!1),S(""),w("1"),C(""),await ed(s.id))}catch(e){console.error("Erro ao adicionar item:",e)}}async function ep(e){try{let t=!e.is_purchased,i={is_purchased:t};t||(i.price=null,i.unitPrice=null),await a.h.patch("/api/shopping-lists/items?id=".concat(e.id),i),s&&await ed(s.id)}catch(e){console.error("Erro ao atualizar item:",e)}}async function eh(e,t){try{await a.h.patch("/api/shopping-lists/items?id=".concat(e),{price:t}),s&&await ed(s.id)}catch(e){console.error("Erro ao atualizar pre\xe7o:",e)}}async function ef(e,t){try{await a.h.patch("/api/shopping-lists/items?id=".concat(e),t),s&&await ed(s.id)}catch(e){console.error("Erro ao atualizar item:",e)}}async function eg(e,t,i){let n={};"quantity"===t?(n.quantity=i,e.unit_price?n.price=Number((i*e.unit_price).toFixed(2)):e.price&&i>0&&(n.unit_price=Number((e.price/i).toFixed(2)))):"unit_price"===t?(n.unit_price=i,e.quantity&&(n.price=Number((e.quantity*i).toFixed(2)))):"price"===t&&(n.price=i,e.quantity&&e.quantity>0&&(n.unit_price=Number((i/e.quantity).toFixed(2)))),c(t=>t.map(t=>t.id===e.id?{...t,...n}:t));try{let t={...n};void 0!==n.unit_price&&(t.unitPrice=n.unit_price,delete t.unit_price),await a.h.patch("/api/shopping-lists/items?id=".concat(e.id),t)}catch(e){console.error("Erro ao atualizar item:",e),await ed(s.id)}}async function ex(e){if(confirm("Remover este item?"))try{await a.h.delete("/api/shopping-lists/items?id=".concat(e)),s&&await ed(s.id)}catch(e){console.error("Erro ao remover item:",e)}}async function eb(e){if(confirm("Excluir esta lista?"))try{await a.h.delete("/api/shopping-lists/".concat(e)),l(null),c([]),X(!1),K(!1),await el()}catch(e){console.error("Erro ao excluir lista:",e)}}async function em(){if(!s)return;let e=eB.length>0;if(1===en&&e){let e=new Date().toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit"});ea("Pendentes ".concat(s.name," - ").concat(e)),eo(2);return}try{let t=O||null;if(H&&J.trim()){let e=await a.h.post("/api/stores",{name:J.trim()}),i=await e.json();e.ok&&i.store&&(t=i.store.id,await es())}let i=await a.h.post("/api/shopping-lists/complete",{list_id:s.id,store_id:t,new_list_name:e?er:void 0}),n=await i.json();if(!i.ok)throw Error(n.error||"Erro ao finalizar lista");M(!1),l(null),c([]),await el(),n.new_list&&ed(n.new_list.id)}catch(e){console.error("Erro ao finalizar lista:",e)}}function ey(e){X(!0),K(!1),ei(e.store_id||""),ed(e.id)}async function ej(){if(s)try{await a.h.patch("/api/shopping-lists/".concat(s.id),{store_id:et||null}),K(!1),await el(),await ed(s.id)}catch(e){console.error("Erro ao salvar edicoes:",e)}}async function ev(){try{E(!0);let e=await a.h.get("/api/shopping-lists/suggestions"),t=await e.json();e.ok&&(W(t.suggestions||[]),_(!0))}catch(e){console.error("Erro ao buscar sugest\xf5es:",e)}finally{E(!1)}}async function eS(e){if(s)try{await a.h.post("/api/shopping-lists/items",{list_id:s.id,name:e.food_name.charAt(0).toUpperCase()+e.food_name.slice(1),quantity:Math.round(e.avg_quantity)||1,unit:e.common_unit||void 0}),W(t=>t.filter(t=>t.food_name!==e.food_name)),await ed(s.id)}catch(e){console.error("Erro ao adicionar sugest\xe3o:",e)}}function ek(e){F(e),D("C\xf3pia de ".concat(e.name)),N(!0)}async function ew(e){if(e.preventDefault(),A&&L.trim())try{let e=await a.h.post("/api/shopping-lists/duplicate",{source_list_id:A.id,name:L}),t=await e.json();e.ok?(N(!1),F(null),D(""),await el(),t.list&&ed(t.list.id)):f(t.error||"Erro ao duplicar lista")}catch(e){f(e.message)}}function ez(e){return new Date(e).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit"})}(0,o.useEffect)(()=>{el(),es()},[]);let eC=t.filter(e=>"active"===e.status),eR=t.filter(e=>"completed"===e.status),eW=Z?eR:eR.slice(0,5),eB=d.filter(e=>!e.is_purchased),e_=d.filter(e=>e.is_purchased),eI=e_.reduce((e,t)=>e+(Number(t.price)||0),0);function eE(e){return e.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})}return s&&$?(0,n.jsxs)("div",{style:{maxWidth:800,margin:"0 auto",padding:24},children:[(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:24},children:[(0,n.jsx)("button",{onClick:function(){l(null),c([]),X(!1),K(!1)},style:{padding:"8px 16px",background:"#f3f4f6",border:"none",borderRadius:8,cursor:"pointer",fontSize:14,fontWeight:600},children:"Voltar"}),(0,n.jsx)("h1",{style:{fontSize:24,fontWeight:700,flex:1},children:s.name}),(0,n.jsx)("button",{onClick:()=>eb(s.id),style:{padding:"8px 10px",background:"#fee2e2",border:"1px solid #fca5a5",borderRadius:8,cursor:"pointer",color:"#dc2626",display:"flex",alignItems:"center",justifyContent:"center"},title:"Excluir lista",children:(0,n.jsx)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:(0,n.jsx)("path",{d:"M3 6h18M8 6V4a2 2 0 012-2h4a2 2 0 012 2v2m3 0v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6h14M10 11v6M14 11v6"})})})]}),(0,n.jsxs)("div",{style:{padding:16,background:"#f0fdf4",borderRadius:12,marginBottom:24},children:[(0,n.jsxs)("div",{style:{fontSize:14,color:"#166534",marginBottom:8},children:["Finalizada em ",ez(s.completed_at||s.updated_at)]}),Y?(0,n.jsxs)("div",{style:{marginTop:12},children:[(0,n.jsx)("label",{style:{display:"block",fontSize:14,fontWeight:600,marginBottom:8},children:"Loja"}),(0,n.jsxs)("select",{value:et,onChange:e=>ei(e.target.value),style:{width:"100%",padding:10,fontSize:14,border:"2px solid #e5e7eb",borderRadius:8,background:"white",boxSizing:"border-box"},children:[(0,n.jsx)("option",{value:"",children:"Sem loja"}),P.map(e=>(0,n.jsx)("option",{value:e.id,children:e.name},e.id))]})]}):s.store_name&&(0,n.jsxs)("div",{style:{fontSize:14,color:"#166534"},children:["Loja: ",(0,n.jsx)("strong",{children:s.store_name})]})]}),(0,n.jsx)("div",{style:{display:"flex",gap:12,marginBottom:24},children:Y?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("button",{onClick:ej,style:{padding:"12px 24px",background:"#10b981",color:"white",border:"none",borderRadius:8,cursor:"pointer",fontSize:14,fontWeight:600},children:"Salvar"}),(0,n.jsx)("button",{onClick:()=>K(!1),style:{padding:"12px 24px",background:"#f3f4f6",border:"none",borderRadius:8,cursor:"pointer",fontSize:14,fontWeight:600},children:"Cancelar"})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("button",{onClick:function(){K(!0)},style:{padding:"12px 24px",background:"#f59e0b",color:"white",border:"none",borderRadius:8,cursor:"pointer",fontSize:14,fontWeight:600},children:"Editar"}),(0,n.jsx)("button",{onClick:()=>ek(s),style:{padding:"12px 24px",background:"#2196F3",color:"white",border:"none",borderRadius:8,cursor:"pointer",fontSize:14,fontWeight:600},children:"Duplicar"})]})}),(0,n.jsxs)("div",{style:{marginBottom:24},children:[(0,n.jsxs)("h2",{style:{fontSize:16,fontWeight:600,color:"#6b7280",marginBottom:12},children:["ITENS (",d.length,")"]}),(0,n.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:8},children:d.map(e=>(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12,padding:12,background:"white",border:"2px solid #e5e7eb",borderRadius:12},children:[(0,n.jsxs)("div",{style:{flex:1},children:[(0,n.jsx)("div",{style:{fontWeight:600,fontSize:15},children:e.name}),(0,n.jsxs)("div",{style:{fontSize:13,color:"#6b7280"},children:[e.quantity," ",e.unit||"un"]})]}),Y?(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:4},children:[(0,n.jsx)("span",{style:{fontSize:13,color:"#6b7280"},children:"R$"}),(0,n.jsx)("input",{type:"number",step:"0.01",min:"0",placeholder:"0,00",defaultValue:e.price||"",onBlur:t=>{let i=t.target.value?parseFloat(t.target.value):null;i!==e.price&&eh(e.id,i)},style:{width:70,padding:"6px 8px",fontSize:14,border:"1px solid #e5e7eb",borderRadius:6,textAlign:"right"}})]}):e.price&&(0,n.jsx)("div",{style:{fontSize:14,fontWeight:600,color:"#166534"},children:eE(Number(e.price))})]},e.id))})]}),eI>0&&(0,n.jsxs)("div",{style:{padding:16,background:"#dcfce7",borderRadius:12,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,n.jsx)("span",{style:{fontWeight:600,color:"#166534",fontSize:18},children:"Total"}),(0,n.jsx)("span",{style:{fontWeight:700,fontSize:24,color:"#166534"},children:eE(eI)})]}),T&&A&&(0,n.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",padding:24,zIndex:1e3},children:(0,n.jsxs)("div",{style:{background:"white",borderRadius:16,padding:24,width:"100%",maxWidth:400},children:[(0,n.jsx)("h2",{style:{fontSize:20,fontWeight:700,marginBottom:16},children:"Duplicar Lista"}),(0,n.jsxs)("p",{style:{fontSize:14,color:"#6b7280",marginBottom:16},children:["Duplicando: ",(0,n.jsx)("strong",{children:A.name})]}),(0,n.jsxs)("form",{onSubmit:ew,children:[(0,n.jsxs)("div",{style:{marginBottom:16},children:[(0,n.jsx)("label",{style:{display:"block",marginBottom:8,fontWeight:600},children:"Nome da nova lista *"}),(0,n.jsx)("input",{type:"text",value:L,onChange:e=>D(e.target.value),placeholder:"Ex: Compras da semana",required:!0,style:{width:"100%",padding:12,fontSize:16,border:"2px solid #e5e7eb",borderRadius:8,boxSizing:"border-box"}})]}),(0,n.jsxs)("div",{style:{display:"flex",gap:12},children:[(0,n.jsx)("button",{type:"button",onClick:()=>{N(!1),F(null)},style:{flex:1,padding:12,background:"#f3f4f6",border:"none",borderRadius:8,cursor:"pointer",fontSize:16,fontWeight:600},children:"Cancelar"}),(0,n.jsx)("button",{type:"submit",style:{flex:1,padding:12,background:"#2196F3",color:"white",border:"none",borderRadius:8,cursor:"pointer",fontSize:16,fontWeight:600},children:"Duplicar"})]})]})]})})]}):s?(0,n.jsxs)("div",{style:{maxWidth:800,margin:"0 auto",padding:24},children:[(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:24},children:[(0,n.jsx)("button",{onClick:()=>{l(null),c([])},style:{padding:"8px 16px",background:"#f3f4f6",border:"none",borderRadius:8,cursor:"pointer",fontSize:14,fontWeight:600},children:"Voltar"}),(0,n.jsx)("h1",{style:{fontSize:24,fontWeight:700,flex:1},children:s.name}),(0,n.jsx)("button",{onClick:()=>eb(s.id),style:{padding:"8px 10px",background:"#fee2e2",border:"1px solid #fca5a5",borderRadius:8,cursor:"pointer",color:"#dc2626",display:"flex",alignItems:"center",justifyContent:"center"},title:"Excluir lista",children:(0,n.jsx)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:(0,n.jsx)("path",{d:"M3 6h18M8 6V4a2 2 0 012-2h4a2 2 0 012 2v2m3 0v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6h14M10 11v6M14 11v6"})})})]}),(0,n.jsxs)("div",{style:{display:"flex",gap:12,marginBottom:24},children:[(0,n.jsx)("button",{onClick:()=>m(!0),style:{padding:"12px 24px",background:"#2196F3",color:"white",border:"none",borderRadius:8,cursor:"pointer",fontSize:14,fontWeight:600},children:"+ Adicionar Item"}),(0,n.jsx)("button",{onClick:ev,disabled:I,style:{padding:"12px 24px",background:"#f59e0b",color:"white",border:"none",borderRadius:8,cursor:I?"not-allowed":"pointer",fontSize:14,fontWeight:600,opacity:I?.7:1},children:I?"Carregando...":"Sugestoes"})]}),(0,n.jsxs)("div",{style:{marginBottom:24},children:[(0,n.jsxs)("h2",{style:{fontSize:16,fontWeight:600,color:"#6b7280",marginBottom:12},children:["PENDENTES (",eB.length,")"]}),0===eB.length?(0,n.jsx)("div",{style:{padding:24,textAlign:"center",color:"#9ca3af",border:"2px dashed #e5e7eb",borderRadius:12},children:"Nenhum item pendente"}):(0,n.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:8},children:eB.map(e=>(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12,padding:16,background:"white",boxShadow:"0 1px 2px rgba(0,0,0,0.05)",borderRadius:12},children:[(0,n.jsx)("input",{type:"checkbox",checked:!1,onChange:()=>ep(e),style:{width:24,height:24,cursor:"pointer"}}),(0,n.jsxs)("div",{style:{flex:1},children:[(0,n.jsx)("div",{style:{fontWeight:600},children:e.name}),(0,n.jsxs)("div",{style:{fontSize:14,color:"#6b7280"},children:[e.quantity," ",e.unit||"un"]})]}),(0,n.jsx)("button",{onClick:()=>ex(e.id),style:{padding:"6px 10px",background:"#fee2e2",border:"1px solid #fca5a5",borderRadius:6,cursor:"pointer",color:"#dc2626",display:"flex",alignItems:"center",justifyContent:"center"},title:"Remover item",children:(0,n.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:(0,n.jsx)("path",{d:"M3 6h18M8 6V4a2 2 0 012-2h4a2 2 0 012 2v2m3 0v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6h14M10 11v6M14 11v6"})})})]},e.id))})]}),B&&R.length>0&&(0,n.jsxs)("div",{style:{marginBottom:24},children:[(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[(0,n.jsxs)("h2",{style:{fontSize:16,fontWeight:600,color:"#f59e0b"},children:["SUGESTOES (",R.length,")"]}),(0,n.jsx)("button",{onClick:()=>_(!1),style:{padding:"4px 8px",background:"transparent",border:"none",cursor:"pointer",fontSize:12,color:"#6b7280"},children:"Fechar"})]}),(0,n.jsx)("div",{style:{fontSize:12,color:"#6b7280",marginBottom:12},children:"Baseado no seu consumo dos ultimos 30 dias"}),(0,n.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:8},children:R.map(e=>(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12,padding:16,background:"#fffbeb",border:"2px solid #fcd34d",borderRadius:12},children:[(0,n.jsxs)("div",{style:{flex:1},children:[(0,n.jsx)("div",{style:{fontWeight:600,textTransform:"capitalize"},children:e.food_name}),(0,n.jsxs)("div",{style:{fontSize:12,color:"#6b7280"},children:["Consumido ",e.consumption_count,"x em ",e.days_consumed," dias"]})]}),(0,n.jsx)("button",{onClick:()=>eS(e),style:{padding:"8px 16px",background:"#10b981",color:"white",border:"none",borderRadius:6,cursor:"pointer",fontSize:12,fontWeight:600},children:"Adicionar"}),(0,n.jsx)("button",{onClick:()=>{W(t=>t.filter(t=>t.food_name!==e.food_name))},style:{padding:"8px 12px",background:"#f3f4f6",border:"1px solid #d1d5db",borderRadius:6,cursor:"pointer",fontSize:14,color:"#6b7280"},children:"X"})]},e.food_name))})]}),e_.length>0&&(0,n.jsxs)("div",{style:{marginBottom:24},children:[(0,n.jsxs)("h2",{style:{fontSize:16,fontWeight:600,color:"#6b7280",marginBottom:12},children:["COMPRADOS (",e_.length,")"]}),(0,n.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:8},children:e_.map(e=>(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12,padding:12,background:"#f0fdf4",borderRadius:12},children:[(0,n.jsx)("input",{type:"checkbox",checked:!0,onChange:()=>ep(e),style:{width:22,height:22,cursor:"pointer",flexShrink:0}}),(0,n.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,n.jsx)("div",{style:{fontWeight:600,fontSize:15,textDecoration:"line-through",color:"#6b7280"},children:e.name}),(0,n.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",alignItems:"center",gap:8,marginTop:6},children:[(0,n.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:2},children:[(0,n.jsx)("label",{style:{fontSize:10,color:"#9ca3af"},children:"Qtd"}),(0,n.jsx)("input",{type:"number",step:"0.001",min:"0.001",className:"no-spinner",defaultValue:e.quantity,onFocus:e=>e.target.select(),onBlur:t=>{let i=parseFloat(t.target.value);i&&i!==Number(e.quantity)&&eg(e,"quantity",i)},style:{width:60,padding:"6px",fontSize:13,border:"1px solid #d1d5db",borderRadius:6,textAlign:"center"}})]}),(0,n.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:2},children:[(0,n.jsx)("label",{style:{fontSize:10,color:"#9ca3af"},children:"Unid"}),(0,n.jsx)("input",{type:"text",defaultValue:e.unit||"un",onBlur:t=>{let i=t.target.value.trim();i&&i!==e.unit&&ef(e.id,{unit:i})},style:{width:50,padding:"6px",fontSize:13,border:"1px solid #d1d5db",borderRadius:6,textAlign:"center"}})]}),(0,n.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:2},children:[(0,n.jsx)("label",{style:{fontSize:10,color:"#9ca3af"},children:"R$ Unit."}),(0,n.jsx)("input",{type:"number",step:"0.01",min:"0",placeholder:"0,00",className:"no-spinner",defaultValue:e.unit_price?Number(e.unit_price).toFixed(2):"",onFocus:e=>e.target.select(),onBlur:t=>{let i=t.target.value?parseFloat(t.target.value):0;i!==Number(e.unit_price)&&eg(e,"unit_price",i)},style:{width:70,padding:"6px",fontSize:13,border:"1px solid #d1d5db",borderRadius:6,textAlign:"right",background:"#f9fafb"}},"unit-".concat(e.id,"-").concat(e.unit_price))]}),(0,n.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:2},children:[(0,n.jsx)("label",{style:{fontSize:10,color:"#166534",fontWeight:600},children:"R$ Total"}),(0,n.jsx)("input",{type:"number",step:"0.01",min:"0",placeholder:"0,00",className:"no-spinner",defaultValue:e.price?Number(e.price).toFixed(2):"",onFocus:e=>e.target.select(),onBlur:t=>{let i=t.target.value?parseFloat(t.target.value):0;i!==Number(e.price)&&eg(e,"price",i)},style:{width:80,padding:"6px",fontSize:13,border:"1px solid #10b981",borderRadius:6,textAlign:"right",fontWeight:600,color:"#166534"}},"total-".concat(e.id,"-").concat(e.price))]})]})]}),(0,n.jsx)("div",{style:{display:"none"}})]},e.id))}),eI>0&&(0,n.jsxs)("div",{style:{marginTop:12,padding:12,background:"#dcfce7",borderRadius:8,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,n.jsx)("span",{style:{fontWeight:600,color:"#166534"},children:"Total"}),(0,n.jsx)("span",{style:{fontWeight:700,fontSize:18,color:"#166534"},children:eE(eI)})]})]}),e_.length>0&&(0,n.jsxs)("button",{onClick:function(){U(""),G(!1),Q(""),eo(1),ea(""),M(!0)},style:{width:"100%",padding:16,background:"#10b981",color:"white",border:"none",borderRadius:12,fontSize:16,fontWeight:600,cursor:"pointer"},children:["Finalizar Lista",eB.length>0&&(0,n.jsxs)("span",{style:{fontSize:13,fontWeight:400,marginLeft:8},children:["(",eB.length," pendente",eB.length>1?"s":"",")"]})]}),V&&(0,n.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",padding:24,zIndex:1e3},children:(0,n.jsx)("div",{style:{background:"white",borderRadius:16,padding:24,width:"100%",maxWidth:400},children:1===en?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("h2",{style:{fontSize:20,fontWeight:700,marginBottom:16},children:"Finalizar Lista"}),eB.length>0&&(0,n.jsxs)("div",{style:{padding:12,background:"#fef3c7",borderRadius:8,marginBottom:16,fontSize:14,color:"#92400e"},children:[eB.length," item(ns) ainda nao comprado(s). Serao transferidos para uma nova lista."]}),(0,n.jsx)("p",{style:{fontSize:14,color:"#6b7280",marginBottom:16},children:"Onde voce fez as compras?"}),H?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("input",{type:"text",value:J,onChange:e=>Q(e.target.value),placeholder:"Nome da loja (ex: Carrefour Centro)",style:{width:"100%",padding:12,fontSize:16,border:"2px solid #e5e7eb",borderRadius:8,marginBottom:12,boxSizing:"border-box"}}),(0,n.jsx)("button",{type:"button",onClick:()=>{G(!1),Q("")},style:{width:"100%",padding:10,background:"#f3f4f6",border:"none",borderRadius:8,cursor:"pointer",fontSize:14,color:"#6b7280",marginBottom:16},children:"Voltar para lista de lojas"})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("select",{value:O,onChange:e=>U(e.target.value),style:{width:"100%",padding:12,fontSize:16,border:"2px solid #e5e7eb",borderRadius:8,marginBottom:12,boxSizing:"border-box",background:"white"},children:[(0,n.jsx)("option",{value:"",children:"Selecione uma loja (opcional)"}),P.map(e=>(0,n.jsx)("option",{value:e.id,children:e.name},e.id))]}),(0,n.jsx)("button",{type:"button",onClick:()=>G(!0),style:{width:"100%",padding:10,background:"#f3f4f6",border:"1px dashed #d1d5db",borderRadius:8,cursor:"pointer",fontSize:14,color:"#6b7280",marginBottom:16},children:"+ Adicionar nova loja"})]}),(0,n.jsxs)("div",{style:{display:"flex",gap:12},children:[(0,n.jsx)("button",{type:"button",onClick:()=>M(!1),style:{flex:1,padding:12,background:"#f3f4f6",border:"none",borderRadius:8,cursor:"pointer",fontSize:16,fontWeight:600},children:"Cancelar"}),(0,n.jsx)("button",{type:"button",onClick:em,style:{flex:1,padding:12,background:"#10b981",color:"white",border:"none",borderRadius:8,cursor:"pointer",fontSize:16,fontWeight:600},children:eB.length>0?"Proximo":"Finalizar"})]})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("h2",{style:{fontSize:20,fontWeight:700,marginBottom:16},children:"Itens Pendentes"}),(0,n.jsx)("p",{style:{fontSize:14,color:"#6b7280",marginBottom:8},children:"Os seguintes itens nao foram comprados:"}),(0,n.jsx)("div",{style:{maxHeight:150,overflowY:"auto",padding:12,background:"#f9fafb",borderRadius:8,marginBottom:16},children:eB.map(e=>(0,n.jsxs)("div",{style:{fontSize:14,color:"#374151",marginBottom:4},children:["â€¢ ",e.name," (",e.quantity," ",e.unit||"un",")"]},e.id))}),(0,n.jsx)("p",{style:{fontSize:14,color:"#6b7280",marginBottom:8},children:"Qual nome dar para a nova lista com esses itens?"}),(0,n.jsx)("input",{type:"text",value:er,onChange:e=>ea(e.target.value),placeholder:"Nome da nova lista",style:{width:"100%",padding:12,fontSize:16,border:"2px solid #e5e7eb",borderRadius:8,marginBottom:16,boxSizing:"border-box"}}),(0,n.jsxs)("div",{style:{display:"flex",gap:12},children:[(0,n.jsx)("button",{type:"button",onClick:()=>eo(1),style:{flex:1,padding:12,background:"#f3f4f6",border:"none",borderRadius:8,cursor:"pointer",fontSize:16,fontWeight:600},children:"Voltar"}),(0,n.jsx)("button",{type:"button",onClick:em,disabled:!er.trim(),style:{flex:1,padding:12,background:er.trim()?"#10b981":"#9ca3af",color:"white",border:"none",borderRadius:8,cursor:er.trim()?"pointer":"not-allowed",fontSize:16,fontWeight:600},children:"Finalizar"})]})]})})}),b&&(0,n.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",padding:24,zIndex:1e3},children:(0,n.jsxs)("div",{style:{background:"white",borderRadius:16,padding:24,width:"100%",maxWidth:400},children:[(0,n.jsx)("h2",{style:{fontSize:20,fontWeight:700,marginBottom:16},children:"Adicionar Item"}),(0,n.jsxs)("form",{onSubmit:eu,children:[(0,n.jsxs)("div",{style:{marginBottom:16},children:[(0,n.jsx)("label",{style:{display:"block",marginBottom:8,fontWeight:600},children:"Nome do item *"}),(0,n.jsx)("input",{type:"text",value:v,onChange:e=>S(e.target.value),placeholder:"Ex: Arroz integral",required:!0,style:{width:"100%",padding:12,fontSize:16,border:"2px solid #e5e7eb",borderRadius:8,boxSizing:"border-box"}})]}),(0,n.jsxs)("div",{style:{display:"flex",gap:12,marginBottom:16},children:[(0,n.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,n.jsx)("label",{style:{display:"block",marginBottom:8,fontWeight:600},children:"Quantidade"}),(0,n.jsx)("input",{type:"number",step:"0.1",value:k,onChange:e=>w(e.target.value),style:{width:"100%",padding:12,fontSize:16,border:"2px solid #e5e7eb",borderRadius:8,boxSizing:"border-box"}})]}),(0,n.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,n.jsx)("label",{style:{display:"block",marginBottom:8,fontWeight:600},children:"Unidade"}),(0,n.jsx)("input",{type:"text",value:z,onChange:e=>C(e.target.value),placeholder:"kg, un, L...",style:{width:"100%",padding:12,fontSize:16,border:"2px solid #e5e7eb",borderRadius:8,boxSizing:"border-box"}})]})]}),(0,n.jsxs)("div",{style:{display:"flex",gap:12},children:[(0,n.jsx)("button",{type:"button",onClick:()=>m(!1),style:{flex:1,padding:12,background:"#f3f4f6",border:"none",borderRadius:8,cursor:"pointer",fontSize:16,fontWeight:600},children:"Cancelar"}),(0,n.jsx)("button",{type:"submit",style:{flex:1,padding:12,background:"#2196F3",color:"white",border:"none",borderRadius:8,cursor:"pointer",fontSize:16,fontWeight:600},children:"Adicionar"})]})]})]})})]}):(0,n.jsxs)("div",{style:{maxWidth:800,margin:"0 auto",padding:24},children:[(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:24},children:[(0,n.jsx)("h1",{style:{fontSize:28,fontWeight:700},children:"Lista de Compras"}),(0,n.jsxs)("div",{style:{display:"flex",gap:12},children:[(0,n.jsxs)("button",{onClick:()=>e.push("/lista-compras/dashboard"),style:{padding:"0 16px",height:44,background:"white",color:"#374151",border:"2px solid #e5e7eb",borderRadius:8,cursor:"pointer",fontSize:14,fontWeight:600,display:"flex",alignItems:"center",gap:8},title:"Painel de Gastos",children:[(0,n.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,n.jsx)("path",{d:"M18 20V10M12 20V4M6 20v-6"})}),"Painel"]}),(0,n.jsx)("button",{onClick:()=>x(!0),style:{width:44,height:44,background:"#2196F3",color:"white",border:"none",borderRadius:8,cursor:"pointer",fontSize:28,fontWeight:400,display:"flex",alignItems:"center",justifyContent:"center",lineHeight:1},title:"Nova lista",children:"+"})]})]}),u?(0,n.jsx)("div",{style:{padding:32,textAlign:"center",color:"#9ca3af"},children:"Carregando..."}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{style:{marginBottom:32},children:[(0,n.jsx)("h2",{style:{fontSize:16,fontWeight:600,color:"#6b7280",marginBottom:12},children:"LISTAS ATIVAS"}),0===eC.length?(0,n.jsx)("div",{style:{padding:32,textAlign:"center",color:"#9ca3af",border:"2px dashed #e5e7eb",borderRadius:12},children:"Nenhuma lista ativa"}):(0,n.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:12},children:eC.map(e=>(0,n.jsxs)("div",{style:{padding:16,background:"white",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",borderRadius:12,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,n.jsxs)("div",{onClick:()=>ed(e.id),style:{flex:1,cursor:"pointer"},children:[(0,n.jsx)("div",{style:{fontWeight:600,fontSize:16},children:e.name}),(0,n.jsxs)("div",{style:{fontSize:14,color:"#6b7280"},children:["Criada em ",ez(e.created_at)]})]}),(0,n.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[(0,n.jsx)("button",{onClick:t=>{t.stopPropagation(),ek(e)},style:{padding:"8px 12px",background:"#f3f4f6",border:"1px solid #d1d5db",borderRadius:8,cursor:"pointer",fontSize:14,fontWeight:500,color:"#374151"},title:"Duplicar lista",children:"Duplicar"}),(0,n.jsx)("div",{onClick:()=>ed(e.id),style:{padding:"8px 16px",background:"#dbeafe",color:"#1e40af",borderRadius:8,fontSize:14,fontWeight:600,cursor:"pointer"},children:"Abrir"})]})]},e.id))})]}),eR.length>0&&(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[(0,n.jsxs)("h2",{style:{fontSize:16,fontWeight:600,color:"#6b7280"},children:["LISTAS CONCLUIDAS ",!Z&&eR.length>5&&"(ultimas 5 de ".concat(eR.length,")")]}),eR.length>5&&(0,n.jsx)("button",{onClick:()=>ee(!Z),style:{padding:"6px 12px",background:"#f3f4f6",border:"none",borderRadius:6,cursor:"pointer",fontSize:13,fontWeight:500,color:"#6b7280"},children:Z?"Mostrar menos":"Ver todas"})]}),(0,n.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:8},children:eW.map(e=>(0,n.jsxs)("div",{style:{padding:12,background:"#f0fdf4",borderRadius:12,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,n.jsxs)("div",{onClick:()=>ey(e),style:{flex:1,cursor:"pointer"},children:[(0,n.jsxs)("div",{style:{fontWeight:600,color:"#166534",fontSize:15,marginBottom:2},children:[e.name,(0,n.jsxs)("span",{style:{fontWeight:400,color:"#6b7280",fontSize:13},children:[" - ",ez(e.completed_at||e.updated_at),e.store_name&&" - ".concat(e.store_name)]})]}),e.total_price&&Number(e.total_price)>0&&(0,n.jsx)("div",{style:{fontSize:15,fontWeight:700,color:"#166534"},children:eE(Number(e.total_price))})]}),(0,n.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,n.jsx)("button",{onClick:()=>ey(e),style:{padding:"6px 12px",background:"#dbeafe",border:"1px solid #93c5fd",borderRadius:6,cursor:"pointer",fontSize:13,fontWeight:500,color:"#1e40af"},children:"Ver"}),(0,n.jsx)("button",{onClick:()=>ek(e),style:{padding:"6px 12px",background:"#dcfce7",border:"1px solid #86efac",borderRadius:6,cursor:"pointer",fontSize:13,fontWeight:500,color:"#166534"},children:"Duplicar"})]})]},e.id))})]})]}),g&&(0,n.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",padding:24,zIndex:1e3},children:(0,n.jsxs)("div",{style:{background:"white",borderRadius:16,padding:24,width:"100%",maxWidth:400},children:[(0,n.jsx)("h2",{style:{fontSize:20,fontWeight:700,marginBottom:16},children:"Nova Lista de Compras"}),(0,n.jsxs)("form",{onSubmit:ec,children:[(0,n.jsxs)("div",{style:{marginBottom:16},children:[(0,n.jsx)("label",{style:{display:"block",marginBottom:8,fontWeight:600},children:"Nome da lista *"}),(0,n.jsx)("input",{type:"text",value:y,onChange:e=>j(e.target.value),placeholder:"Ex: Compras da semana",required:!0,style:{width:"100%",padding:12,fontSize:16,border:"2px solid #e5e7eb",borderRadius:8,boxSizing:"border-box"}})]}),h&&(0,n.jsx)("div",{style:{padding:12,background:"#fee2e2",border:"2px solid #ef4444",borderRadius:8,color:"#991b1b",marginBottom:16},children:h}),(0,n.jsxs)("div",{style:{display:"flex",gap:12},children:[(0,n.jsx)("button",{type:"button",onClick:()=>{x(!1),f(null)},style:{flex:1,padding:12,background:"#f3f4f6",border:"none",borderRadius:8,cursor:"pointer",fontSize:16,fontWeight:600},children:"Cancelar"}),(0,n.jsx)("button",{type:"submit",style:{flex:1,padding:12,background:"#2196F3",color:"white",border:"none",borderRadius:8,cursor:"pointer",fontSize:16,fontWeight:600},children:"Criar Lista"})]})]})]})}),T&&A&&(0,n.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",padding:24,zIndex:1e3},children:(0,n.jsxs)("div",{style:{background:"white",borderRadius:16,padding:24,width:"100%",maxWidth:400},children:[(0,n.jsx)("h2",{style:{fontSize:20,fontWeight:700,marginBottom:16},children:"Duplicar Lista"}),(0,n.jsxs)("p",{style:{fontSize:14,color:"#6b7280",marginBottom:16},children:["Duplicando: ",(0,n.jsx)("strong",{children:A.name})]}),(0,n.jsxs)("form",{onSubmit:ew,children:[(0,n.jsxs)("div",{style:{marginBottom:16},children:[(0,n.jsx)("label",{style:{display:"block",marginBottom:8,fontWeight:600},children:"Nome da nova lista *"}),(0,n.jsx)("input",{type:"text",value:L,onChange:e=>D(e.target.value),placeholder:"Ex: Compras da semana",required:!0,style:{width:"100%",padding:12,fontSize:16,border:"2px solid #e5e7eb",borderRadius:8,boxSizing:"border-box"}})]}),(0,n.jsxs)("div",{style:{display:"flex",gap:12},children:[(0,n.jsx)("button",{type:"button",onClick:()=>{N(!1),F(null)},style:{flex:1,padding:12,background:"#f3f4f6",border:"none",borderRadius:8,cursor:"pointer",fontSize:16,fontWeight:600},children:"Cancelar"}),(0,n.jsx)("button",{type:"submit",style:{flex:1,padding:12,background:"#2196F3",color:"white",border:"none",borderRadius:8,cursor:"pointer",fontSize:16,fontWeight:600},children:"Duplicar"})]})]})]})})]})}},5591:function(e,t,i){"use strict";i.d(t,{h:function(){return r},x:function(){return o}});let n=i(357).env.NEXT_PUBLIC_API_URL||"https://app.foodtracker.com.br";async function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{token:i,...o}=t,r={...o.headers};if(i)r.Authorization="Bearer ".concat(i);else{let e=localStorage.getItem("auth_token");console.log("[API Client] localStorage auth_token:",e?"exists":"null"),e&&(r.Authorization="Bearer ".concat(e))}o.body&&"string"==typeof o.body&&!r["Content-Type"]&&(r["Content-Type"]="application/json");let a=e.startsWith("http")?e:"".concat(n).concat(e);console.log("[API Client]",{isMobile:!0,baseUrl:n,endpoint:e,finalUrl:a,hasAuthToken:!!r.Authorization});try{let t=await fetch(a,{...o,headers:r,credentials:"include"});return console.log("[API Client] Response ".concat(e,":"),{status:t.status}),401!==t.status||window.location.pathname.includes("/login")||(console.warn("401 Unauthorized - Redirecting to login"),localStorage.removeItem("auth_token"),window.location.href="/login"),t}catch(e){throw console.error("[API Client Error]",e),e}}let r={get:(e,t)=>o(e,{method:"GET",token:t}),post:(e,t,i)=>o(e,{method:"POST",body:JSON.stringify(t),token:i}),put:(e,t,i)=>o(e,{method:"PUT",body:JSON.stringify(t),token:i}),patch:(e,t,i)=>o(e,{method:"PATCH",body:JSON.stringify(t),token:i}),delete:(e,t)=>o(e,{method:"DELETE",token:t})}},6463:function(e,t,i){"use strict";var n=i(1169);i.o(n,"usePathname")&&i.d(t,{usePathname:function(){return n.usePathname}}),i.o(n,"useRouter")&&i.d(t,{useRouter:function(){return n.useRouter}}),i.o(n,"useSearchParams")&&i.d(t,{useSearchParams:function(){return n.useSearchParams}})},357:function(e,t,i){"use strict";var n,o;e.exports=(null==(n=i.g.process)?void 0:n.env)&&"object"==typeof(null==(o=i.g.process)?void 0:o.env)?i.g.process:i(8081)},8081:function(e){!function(){var t={229:function(e){var t,i,n,o=e.exports={};function r(){throw Error("setTimeout has not been defined")}function a(){throw Error("clearTimeout has not been defined")}function s(e){if(t===setTimeout)return setTimeout(e,0);if((t===r||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(i){try{return t.call(null,e,0)}catch(i){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:r}catch(e){t=r}try{i="function"==typeof clearTimeout?clearTimeout:a}catch(e){i=a}}();var l=[],d=!1,c=-1;function u(){d&&n&&(d=!1,n.length?l=n.concat(l):c=-1,l.length&&p())}function p(){if(!d){var e=s(u);d=!0;for(var t=l.length;t;){for(n=l,l=[];++c<t;)n&&n[c].run();c=-1,t=l.length}n=null,d=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===a||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function f(){}o.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)t[i-1]=arguments[i];l.push(new h(e,t)),1!==l.length||d||s(p)},h.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=f,o.addListener=f,o.once=f,o.off=f,o.removeListener=f,o.removeAllListeners=f,o.emit=f,o.prependListener=f,o.prependOnceListener=f,o.listeners=function(e){return[]},o.binding=function(e){throw Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw Error("process.chdir is not supported")},o.umask=function(){return 0}}},i={};function n(e){var o=i[e];if(void 0!==o)return o.exports;var r=i[e]={exports:{}},a=!0;try{t[e](r,r.exports,n),a=!1}finally{a&&delete i[e]}return r.exports}n.ab="//";var o=n(229);e.exports=o}()}},function(e){e.O(0,[971,23,744],function(){return e(e.s=3790)}),_N_E=e.O()}]);